import{_ as Eu}from"./PersonalBar.7f5990e0.js";import{N as _u}from"./Notification.8eb99c27.js";import{_ as wu}from"./CompanyBarTop.39b86ad6.js";import{_ as Cu}from"./TopNav.2f71b089.js";import{d as oe,o as d,b as y,a as u,t as W,k as _,F as ve,f as ke,h as i,p as r,u as o,aH as N,aD as H,z as C,m as b,g as Be,j as Q,aC as z,aS as Qe,aT as xu,J as pe,ah as Du,aU as Vu,c as P,ap as bu,ao as Ke,aK as Au,aV as Ge,ay as $u,aW as J,e as $e,i as Bu,aX as Ou,ar as Ye,ab as ye,aY as Ue,av as he,aZ as Me,R as Ee,aR as ze,aw as He,w as I,T as Lu,a_ as T,al as qe,l as Xe,an as Fu,aB as ae,s as Iu,aG as Ru}from"./index.855f7bb2.js";import{_ as Su}from"./ModalInputFull.ede352c4.js";import{_ as re}from"./BaseInput.ce873359.js";const Tu={class:"base-select-wrap"},Pu=["value"],Qu=["value"],Uu=["value"],Ne=oe({__name:"SimpleSelect",props:{modelValue:{type:[String,Number]},selectInputData:{type:Array,require:!0},firstElement:{type:Object}},setup(E){return(f,$)=>(d(),y("div",Tu,[u("select",{class:"base-select",value:E.modelValue,onChange:$[0]||($[0]=c=>f.$emit("update:modelValue",c.target.value))},[E.firstElement?(d(),y("option",{key:0,value:E.firstElement.id},W(E.firstElement.name),9,Qu)):_("",!0),(d(!0),y(ve,null,ke(E.selectInputData,c=>(d(),y("option",{key:c.id,value:c.id},W(c.name),9,Uu))),128))],40,Pu)]))}}),Mu=u("div",{class:"kp-step-title"},"\u0421\u043E\u0431\u0440\u0430\u0442\u044C \u041A\u041F \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0438",-1),zu={class:"kp-step-body step1"},Hu={class:"kp-step-body-elem"},Nu=u("div",{class:"kp-step-body-elem-text"},[b(" \u0417\u0430\u043A\u0430\u0437\u0430 "),u("div",{class:"kp-step-body-elem-text-sub"}," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0435 \u0443\u0436\u0435 \u0438\u043C\u0435\u044E\u0449\u0435\u0433\u043E\u0441\u044F \u0437\u0430\u043A\u0430\u0437\u0430. ")],-1),Ku=["flow"],Gu=b(" \u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0430 "),Yu=u("div",{class:"kp-step-body-elem-text-sub"}," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043D\u043E\u0433\u043E \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0430. ",-1),qu=[Gu,Yu],Xu={class:"kp-step-body-elem"},Zu=u("div",{class:"kp-step-body-elem-text"},[b(" \u041F\u043E\u0437\u0438\u0446\u0438\u0439 \u0438\u0437 \u043A\u0430\u0442\u043E\u043B\u043E\u0433\u0430 "),u("div",{class:"kp-step-body-elem-text-sub"}," \u041A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0438\u0437 \u043F\u043E\u0437\u0438\u0446\u0438\u0439 \u043A\u0430\u0442\u0430\u043B\u043E\u0433\u0430 ")],-1),ju={class:"kp-step-actions"},Wu=oe({__name:"KpStep1",props:{modelValue:{type:String,required:!0},active:{type:Boolean,default:!1},isDraft:{type:Boolean,default:!1}},emits:["update:modelValue","next"],setup(E,{emit:f}){const $=E,c=i(!0),v=i(!1),p=i(!1),O=R=>{R==N.ORDER?(c.value=!0,v.value=!1,p.value=!1):R==N.DRAFT&&$.isDraft?(c.value=!1,v.value=!0,p.value=!1):(c.value=!1,v.value=!1,p.value=!0),f("update:modelValue",R)};return(R,n)=>(d(),y("div",{class:C(["kp-step",{active:E.active}])},[Mu,u("div",zu,[u("div",Hu,[r(H,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=l=>c.value=l),onOnClick:n[1]||(n[1]=l=>O(o(N).ORDER))},null,8,["modelValue"]),Nu]),u("div",{class:"kp-step-body-elem",tooltip:"\u041E\u0442\u0441\u0443\u0442\u0432\u0443\u044E\u0442 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043D\u044B\u0435 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0438",flow:E.isDraft?"":"left"},[r(H,{modelValue:v.value,"onUpdate:modelValue":n[2]||(n[2]=l=>v.value=l),onOnClick:n[3]||(n[3]=l=>O(o(N).DRAFT)),disabled:!E.isDraft},null,8,["modelValue","disabled"]),u("div",{class:C(["kp-step-body-elem-text",{disablsed:!E.isDraft}])},qu,2)],8,Ku),u("div",Xu,[r(H,{modelValue:p.value,"onUpdate:modelValue":n[4]||(n[4]=l=>p.value=l),onOnClick:n[5]||(n[5]=l=>O(o(N).CATALOG_POS))},null,8,["modelValue"]),Zu])]),u("div",ju,[u("div",{class:"kp-step-actions-link right",onClick:n[6]||(n[6]=l=>R.$emit("next"))},"\u0414\u0430\u043B\u0435\u0435")])],2))}}),Ju={key:0,class:"kp-step-title"},e0={key:1,class:"kp-step-title"},u0={class:"kp-step-body"},t0={key:2,class:"kp-step-body-input"},l0={class:"kp-step-body-row"},a0={class:"kp-step-body-row"},o0={class:"kp-step-body-row"},s0=["flow"],n0=u("svg",{width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("rect",{width:"2.17029",height:"21.7029",rx:"1.08514",transform:"matrix(0.999975 -0.00708126 -0.00708126 0.999975 11.097 1.26186)",fill:"#A5A7A9"}),u("rect",{width:"2.17029",height:"21.7029",rx:"1.08514",transform:"matrix(0.00708126 -0.999975 -0.999975 0.00708126 22.7798 12.9446)",fill:"#A5A7A9"})],-1),i0={key:3},d0={class:"kp-step-actions"},v0=oe({__name:"KpStep2",props:{active:{type:Boolean,default:!1},type:{type:String,required:!0},kp:{type:Object,required:!0}},emits:["next","prev","update:kp"],setup(E,{emit:f}){const $=E,c=Be(),v=i($.kp),p=i(-1),O=Q(()=>c.getters.getOrdersInputData),R={id:-1,name:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u0430\u043A\u0430\u0437"},n=i(-1),l=Q(()=>c.getters.getOrderDraftsInputData),M={id:-1,name:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A"},S=Q(()=>N),B=i(!1),V=i(!1),g=i(!1),m=i(""),K=i(!1),q=i(new Date().toLocaleString("ru").substring(0,10)),k=i(z.cloneDeep(Qe));k.value.position=z.cloneDeep($.kp.offer.position),k.value=xu(k.value);const D=Q(()=>c.getters.getCompanysListInput().filter(ue=>ue.id!==""));pe(p,()=>{p.value!=-1&&(B.value=!0,c.dispatch(Du.GET_ORDER_DETAIL,p.value).finally(()=>{k.value=z.cloneDeep(c.getters.getOrderDetail),B.value=!1}))}),pe(n,()=>{n.value!=-1&&(k.value=z.cloneDeep(c.getters.getOrderDrafts.find(ue=>ue.id==n.value)))}),Vu(()=>{$.active&&(v.value.offer.position=z.cloneDeep(k.value.position),f("update:kp",v.value))});const ee=()=>{p.value=-1,n.value=-1,v.value=z.cloneDeep(Ge),k.value=z.cloneDeep(Qe),f("update:kp",v.value),f("prev")},_e=()=>{v.value.offer.date=new Date($u(q.value)).getTime(),v.value.offer.position=z.cloneDeep(k.value.position),f("next"),f("update:kp",v.value)},L=()=>{m.value.length>=2&&(v.value.offer.customer="",g.value=!0,V.value=!1,K.value=!1,c.dispatch(J.GET_ORG_BY_INN,m.value).then(()=>{g.value=!1,v.value.offer.customer=c.getters.getKPOrgName,m.value=""}).catch(()=>{V.value=!0,setTimeout(()=>{V.value=!1},1e4),g.value=!1,m.value=""}))};return(ue,h)=>(d(),y("div",{class:C(["kp-step",{active:E.active}])},[E.type===o(S).ORDER?(d(),y("div",Ju,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u0430\u043A\u0430\u0437")):_("",!0),E.type===o(S).DRAFT?(d(),y("div",e0,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A")):_("",!0),u("div",u0,[E.type===o(S).ORDER?(d(),P(Ne,{key:0,modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=w=>p.value=w),"select-input-data":o(O),"first-element":p.value===-1?o(R):null},null,8,["modelValue","select-input-data","first-element"])):_("",!0),E.type===o(S).DRAFT?(d(),P(Ne,{key:1,modelValue:n.value,"onUpdate:modelValue":h[1]||(h[1]=w=>n.value=w),"select-input-data":o(l),"first-element":n.value===-1?o(M):null},null,8,["modelValue","select-input-data","first-element"])):_("",!0),p.value!==-1||n.value!==-1||E.type===o(N).CATALOG_POS?(d(),y("div",t0,[u("div",l0,[r(re,{modelValue:v.value.offer.n,"onUpdate:modelValue":h[2]||(h[2]=w=>v.value.offer.n=w),label:"\u041D\u043E\u043C\u0435\u0440 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430",style:{width:"100%"}},null,8,["modelValue"]),r(bu,{modelValue:q.value,"onUpdate:modelValue":h[3]||(h[3]=w=>q.value=w)},null,8,["modelValue"])]),u("div",a0,[r(re,{modelValue:v.value.offer.executor,"onUpdate:modelValue":h[4]||(h[4]=w=>v.value.offer.executor=w),label:"\u041F\u043E\u0441\u0442\u0430\u0432\u0449\u0438\u043A",onInput:h[5]||(h[5]=w=>v.value.offer.executorUID=""),style:{width:"100%"}},null,8,["modelValue"]),r(Ke,{data:o(D),modelValue:v.value.offer.executorUID,"onUpdate:modelValue":h[6]||(h[6]=w=>v.value.offer.executorUID=w),onOnInput:h[7]||(h[7]=w=>{var ce;return v.value.offer.executor=((ce=o(D).find(me=>me.id===v.value.offer.executorUID))==null?void 0:ce.name)||""})},null,8,["data","modelValue"])]),u("div",o0,[r(re,{modelValue:v.value.offer.customer,"onUpdate:modelValue":h[8]||(h[8]=w=>v.value.offer.customer=w),label:"\u041F\u043E\u043A\u0443\u043F\u0430\u0442\u0435\u043B\u044C",error:V.value,loading:g.value,style:{width:"100%"}},null,8,["modelValue","error","loading"]),u("div",{class:"kp-step-body-button",tooltip:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u0418\u041D\u041D",flow:K.value?"":"up",onClickCapture:h[12]||(h[12]=w=>K.value=!0)},[r(Su,{modelValue:m.value,"onUpdate:modelValue":h[9]||(h[9]=w=>m.value=w),show:K.value,"onUpdate:show":h[10]||(h[10]=w=>K.value=w),"show-ok":"",onOnOk:h[11]||(h[11]=w=>L()),label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u041D\u041D",style:{left:"-125px"}},null,8,["modelValue","show"]),n0],40,s0)])])):_("",!0),p.value!==-1||n.value!==-1||E.type===o(N).CATALOG_POS?(d(),y("div",i0,[B.value?(d(),P($e,{key:0,center:""})):E.active?(d(),P(Au,{key:1,order:k.value,"onUpdate:order":h[13]||(h[13]=w=>k.value=w),"is-kp":""},null,8,["order"])):_("",!0)])):_("",!0)]),u("div",d0,[u("div",{class:"kp-step-actions-link",onClick:h[14]||(h[14]=w=>ee())},"\u041D\u0430\u0437\u0430\u0434"),u("div",{class:"kp-step-actions-link right",onClick:h[15]||(h[15]=w=>_e())},"\u0414\u0430\u043B\u0435\u0435")])],2))}}),r0={xmlns:"http://www.w3.org/2000/svg",width:"34",height:"42",fill:"none"},p0=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M28.007.81 5.98.8C3.137.799.8 3.137.8 5.98v30.541c0 2.843 2.337 5.18 5.18 5.18h22.035c2.843 0 5.18-2.337 5.18-5.18l.01-30.572c0-2.817-2.3-5.139-5.198-5.14Zm3.114 35.667c0 1.744-1.368 3.15-3.105 3.15H5.98a3.1 3.1 0 0 1-3.105-3.106V5.936A3.102 3.102 0 0 1 5.98 2.83L28 2.808c1.786-.001 3.103 1.377 3.104 3.128z"},null,-1),c0=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M6.94 11.337h2.71c.544 0 1.037-.436 1.037-1.038A1.01 1.01 0 0 0 9.65 9.262H6.94a1.037 1.037 0 1 0 0 2.075zM6.93 16.878h2.713c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.037-1.037H6.93a1.037 1.037 0 1 0 0 2.075zM23.871 11.36h2.71c.545 0 1.038-.436 1.038-1.038a1.01 1.01 0 0 0-1.037-1.037h-2.71a1.037 1.037 0 1 0 0 2.074zM23.894 16.899h2.71c.544 0 1.038-.436 1.038-1.038a1.01 1.01 0 0 0-1.038-1.037h-2.71a1.037 1.037 0 1 0 0 2.075zM5.903 20.957c0 .544.435 1.037 1.037 1.037h19.655a1.037 1.037 0 1 0 0-2.075H6.94c-.544 0-1.037.436-1.037 1.038zM5.884 25.873c0 .544.435 1.038 1.037 1.038h19.656a1.037 1.037 0 1 0 0-2.075H6.92c-.544 0-1.037.435-1.037 1.037zM5.875 30.978c0 .544.435 1.037 1.037 1.037h19.656a1.037 1.037 0 1 0 0-2.075H6.912c-.544 0-1.037.436-1.037 1.038z"},null,-1),m0=u("path",{fill:"#a5a7a9",d:"M12.646 17.067q-.48 0-.814-.343-.336-.343-.336-.806v-8.43q0-.462.336-.806.335-.343.814-.343h8.429q.479 0 .814.343.335.344.335.807v8.429q0 .463-.335.806t-.814.343zm0-1.15h8.429V7.49h-8.43zm.766-1.149h6.897l-2.3-3.065-1.724 2.3-1.149-1.533zm-.766 1.15v-8.43Z"},null,-1),g0=[p0,c0,m0];function f0(E,f){return d(),y("svg",r0,g0)}var y0={render:f0};const h0={xmlns:"http://www.w3.org/2000/svg",width:"34",height:"42",fill:"none"},k0=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M28.007.81 5.98.8C3.137.799.8 3.137.8 5.98v30.541c0 2.843 2.337 5.18 5.18 5.18h22.035c2.843 0 5.18-2.337 5.18-5.18l.01-30.572c0-2.817-2.3-5.139-5.198-5.14Zm3.114 35.667c0 1.744-1.368 3.15-3.105 3.15H5.98a3.1 3.1 0 0 1-3.105-3.106V5.936A3.102 3.102 0 0 1 5.98 2.83L28 2.808c1.786-.001 3.103 1.377 3.104 3.128z"},null,-1),E0=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M19.232 11.337h7.36c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.037-1.037h-7.36a1.037 1.037 0 1 0 0 2.075zM19.223 16.878h7.36c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.037-1.037h-7.36a1.037 1.037 0 1 0 0 2.075zM5.903 20.957c0 .544.435 1.037 1.037 1.037h19.655a1.037 1.037 0 1 0 0-2.075H6.94c-.544 0-1.037.436-1.037 1.038zM5.884 25.873c0 .544.435 1.038 1.037 1.038h19.656a1.037 1.037 0 1 0 0-2.075H6.92c-.544 0-1.037.435-1.037 1.037zM5.875 30.978c0 .544.435 1.037 1.037 1.037h19.656a1.037 1.037 0 1 0 0-2.075H6.912c-.544 0-1.037.436-1.037 1.038z"},null,-1),_0=u("path",{fill:"#a5a7a9",d:"M6.86 17.067q-.48 0-.814-.343-.336-.343-.336-.806v-8.43q0-.462.336-.806.334-.343.813-.343h8.43q.479 0 .813.343.336.344.336.807v8.429q0 .463-.336.806-.334.343-.813.343zm0-1.15h8.429V7.49h-8.43Zm.766-1.149h6.896l-2.299-3.065-1.724 2.3-1.15-1.533zm-.767 1.15v-8.43Z"},null,-1),w0=[k0,E0,_0];function C0(E,f){return d(),y("svg",h0,w0)}var x0={render:C0};const D0={xmlns:"http://www.w3.org/2000/svg",width:"34",height:"42",fill:"none"},V0=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M28.007.81 5.98.8C3.137.799.8 3.137.8 5.98v30.541c0 2.843 2.337 5.18 5.18 5.18h22.035c2.843 0 5.18-2.337 5.18-5.18l.01-30.572c0-2.817-2.3-5.139-5.198-5.14Zm3.114 35.667c0 1.744-1.368 3.15-3.105 3.15H5.98a3.1 3.1 0 0 1-3.105-3.106V5.936A3.102 3.102 0 0 1 5.98 2.83L28 2.808c1.786-.001 3.103 1.377 3.104 3.128z"},null,-1),b0=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M6.94 11.337h7.36c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.038-1.037H6.94a1.037 1.037 0 1 0 0 2.075zM6.93 16.878h7.36c.545 0 1.038-.436 1.038-1.038a1.01 1.01 0 0 0-1.037-1.037H6.93a1.037 1.037 0 1 0 0 2.075zM5.903 20.957c0 .544.435 1.037 1.037 1.037h19.655a1.037 1.037 0 1 0 0-2.075H6.94c-.544 0-1.037.436-1.037 1.038zM5.884 25.873c0 .544.435 1.038 1.037 1.038h19.656a1.037 1.037 0 1 0 0-2.075H6.92c-.544 0-1.037.435-1.037 1.037zM5.875 30.978c0 .544.435 1.037 1.037 1.037h19.656a1.037 1.037 0 1 0 0-2.075H6.912c-.544 0-1.037.436-1.037 1.038z"},null,-1),A0=u("path",{fill:"#a5a7a9",d:"M18.27 17.067q-.48 0-.814-.343-.336-.343-.336-.806v-8.43q0-.462.336-.806.335-.343.813-.343h8.43q.479 0 .814.343.335.344.335.807v8.429q0 .463-.335.806t-.814.343zm0-1.15h8.429V7.49h-8.43zm.766-1.149h6.896l-2.298-3.065-1.725 2.3-1.149-1.533zm-.767 1.15v-8.43Z"},null,-1),$0=[V0,b0,A0];function B0(E,f){return d(),y("svg",D0,$0)}var O0={render:B0};const L0=u("div",{class:"kp-step-title"},"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u044F",-1),F0={class:"kp-step-body"},I0={class:"kp-step-body-input"},R0=u("div",{class:"orders-list-elem"},[u("div",{class:"table-arrow"})],-1),S0=u("div",{class:"orders-list-elem"}," \u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u0443\u0441\u043B\u043E\u0432\u0438\u044F",-1),T0=[R0,S0],P0={class:"kp-step-body-row"},Q0=u("span",{class:"kp-step-body-row-elem"},"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438",-1),U0=u("div",null,"\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437",-1),M0=u("div",null,"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430",-1),z0={key:1},H0=b("\u20BD "),N0=u("span",{class:"kp-step-body-elem-text-sub"},"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",-1),K0=[H0,N0],G0={class:"kp-step-body-row"},Y0=u("span",{class:"kp-step-body-row-elem"},"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",-1),q0={key:1,style:"margin-left: 10px"},X0={key:2,class:"kp-step-body-elem-text-sub",style:"margin-left: 10px"},Z0={class:"kp-step-body-row"},j0=u("span",{class:"kp-step-body-row-elem"},"\u041E\u0442\u0441\u0440\u043E\u0447\u043A\u0430",-1),W0=b("\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E "),J0=u("br",null,null,-1),et=b("\u043A\u0430\u043B\u0435\u043D\u0434\u0430\u0440\u043D\u044B\u0445 \u0434\u043D\u0435\u0439"),ut=[W0,J0,et],tt={style:"margin-left: 30px"},lt=b("\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E"),at=u("br",null,null,-1),ot=b("\u0440\u0430\u0431\u043E\u0447\u0438\u0445 \u0434\u043D\u0435\u0439"),st=[lt,at,ot],nt=u("div",{class:"orders-list-elem"},[u("div",{class:"table-arrow"})],-1),it=u("div",{class:"orders-list-elem"},"\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A",-1),dt=[nt,it],vt={class:"kp-step-body-row"},rt=u("span",{class:"kp-step-body-row-elem"},"\u0422\u0435\u043A\u0441\u0442",-1),pt={class:"kp-step-body-row"},ct=u("span",{class:"kp-step-body-row-elem"},"\u041B\u043E\u0433\u043E",-1),mt={key:0,class:"kp-step-body-add-file-label",for:"file-upload"},gt={key:1,class:"kp-step-body-elem-header-align-wrap"},ft=u("div",{class:"kp-step-body-elem-text-sub"},"\u0412\u044B\u0440\u0430\u0432\u043D\u0438\u0432\u0430\u043D\u0438\u0435:",-1),yt={style:"text-align: center;"},ht={key:1,class:"kp-step-body-column",style:"justify-content: center"},kt={class:"product-slider-wrap"},Et={class:"product-slider-main"},_t=["src"],wt={style:"text-align: center; margin-top: -50px;"},Ct=b("\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),xt=u("span",null,"\u041B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u0432 \u043D\u0435\u0442. \u0414\u043E\u0431\u0430\u0432\u044C\u0442\u0435 \u043B\u043E\u0433\u043E\u0442\u0438\u043F.",-1),Dt=[xt],Vt={class:"order-comment-form show"},bt=u("div",{class:"order-comment-title"},[u("span",null,"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439")],-1),At={class:"kp-step-body-row",style:"justify-content: flex-end"},$t=b(" \u0421\u043A\u0430\u0447\u0430\u0442\u044C \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435: "),Bt=u("div",{style:"margin-left: 10px"},"PDF",-1),Ot={class:"content-heading-wrap kp",style:{display:"block"}},Lt={key:0,style:"display: flex; align-items: center; max-width: 580px; padding: 10px 5px;"},Ft={class:"select-input-container"},It=["onClick"],Rt={class:C("kp-canvas-controller")},St=b("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043B\u043E\u0433\u043E\u0442\u0438\u043F"),Tt={style:"display: grid;"},Pt=b("\u{1F815}"),Qt=b("\u{1F814}"),Ut=b("\u{1F817}"),Mt=b("\u279D"),zt=u("span",{style:"margin-bottom: 10px;"},"\u041C\u0430\u0441\u0448\u0442\u0430\u0431 \u043D\u0430\u043D\u0435\u0441\u0435\u043D\u0438\u044F",-1),Ht={style:"display: flex;"},Nt=b("-"),Kt=b("+"),Gt={style:{display:"flex","align-items":"center"}},Yt=b("?"),qt=u("span",{style:"margin-bottom: 10px;"},"\u0423\u0433\u043E\u043B \u043F\u043E\u0432\u043E\u0440\u043E\u0442\u0430",-1),Xt={style:"display: flex;"},Zt=b("L"),jt=b("R"),Wt=b("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"),Jt=b("\u0421\u043A\u0430\u0447\u0430\u0442\u044C"),el={key:1,class:"kp-product-image-container"},ul=["onClick","src"],tl=Xe('<div style="display:table;margin:auto;"><span><div style="position:relative;" width="720" height="1080"><canvas width="720" height="1080" style="z-index:-1;"></canvas><canvas id="canvas-back" width="720" height="1080" style="position:absolute;left:0;top:0;z-index:0;"></canvas><canvas id="canvas-front" width="720" height="1080" style="position:absolute;left:0;top:0;z-index:1;"></canvas></div></span><span style="display:none;"><canvas id="c1" width="720" height="1080"></canvas></span></div>',1),ll={class:"kp-step-actions"},al=oe({__name:"KpStep3",props:{active:{type:Boolean,default:!1},kp:{type:Object,require:!0}},emits:["next","prev","update:kp"],setup(E,{emit:f}){const $=E,c=Be(),v=i(!1),p=i(!1),O=i(!1),R=i(),n=i(),l=i(),M=i(),S=i(),B=i(),V=i(),g=i(),m=i(),K=100,q=100,k=i(K),D=i(q),ee=i(!1),_e=a=>a.replace(/&quot;/gi,'"'),L=i("10%"),ue=a=>{console.log("click",a)},h=a=>{console.log("out",a.target.value);let e=a.target.value;(e>=360||e<=-360)&&(e=0),F.value=e,ge.value=F.value.toString();let t=g.value+k.value/2,x=m.value+D.value/2;l.value.getContext("2d").translate(t,x),l.value.getContext("2d").rotate(F.value*Math.PI/180),l.value.getContext("2d").translate(-t,-x),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),l.value.getContext("2d").resetTransform()},w=a=>{console.log(a),L.value=L.value.replace("%","")},ce=a=>{console.log("scaleFocusOutHandler",a);let e=Number(L.value.replace("%",""))*10;if(console.log(e),L.value+="%",console.log(e),e==0){l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value=K,D.value=q);return}k.value=K,D.value=q,e>0?(L.value="0",we(e)):(L.value="0",Ce(e*-1))},me=a=>{console.log("scaleInputChange");let e=L.value.replace("%",""),t=Number(e)*10;console.log(t),t+=a,console.log(t),L.value=(t/10).toString()+"%"};pe(L,()=>{console.log(L.value)});const se=i(),ne=i([]),Ze=a=>{a!="null"&&(v.value=!0,ne.value=[],console.log(a),Fu.get("/product/search?QUERY="+a+"&OPTION=8").then(e=>{console.log(e.data.IMAGES),e.data.IMAGES.forEach(t=>{ne.value.push(t)})}).finally(()=>{v.value=!1,console.log(ne.value)}))},je=a=>{console.log(a),We(a)},We=a=>{let e=new Image(B.value.width,B.value.height);e.onload=function(){B.value.getContext("2d").drawImage(e,0,0,B.value.width,B.value.height),B.value.getContext("2d").save()},e.crossOrigin="Anonymous",e.src=a+"?no-cache-please"},Je=a=>new Promise((e,t)=>{const x=new FileReader;x.readAsDataURL(a),x.onload=()=>e(x.result),x.onerror=Y=>t(Y)}),eu=()=>{console.log("Image download"),V.value.getContext("2d").clearRect(0,0,V.value.width,V.value.height),V.value.getContext("2d").drawImage(B.value,0,0),V.value.getContext("2d").drawImage(l.value,0,0),V.value.toBlob(a=>{console.log(a);const e=window.URL.createObjectURL(a),t=document.createElement("a");t.href=e,t.setAttribute("download","image.png"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e)})},uu=async()=>{if(se.value&&se.value.files){let a=await Je(se.value.files[0]);n.value=new Image,n.value.src=a,n.value.onload=()=>{console.log("Logo load",n.value),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),l.value.getContext("2d").save(),Ie()}}},tu=()=>{se.value.click()},X=()=>{let a=g.value+k.value/2,e=m.value+D.value/2;l.value.getContext("2d").translate(a,e),l.value.getContext("2d").rotate(F.value*Math.PI/180),l.value.getContext("2d").translate(-a,-e),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),l.value.getContext("2d").resetTransform()},F=i(0),ge=i(F.value.toString());pe(F,()=>{console.log("watch",F.value),(F.value>359||F.value<-359)&&(F.value=0),ge.value=F.value.toString()});const Oe=a=>{a>0&&(a*=-1),Fe(a)},Le=a=>{Fe(a)},Fe=a=>{if(a==0)return;F.value=Number(F.value)+Number(a);let e=g.value+k.value/2,t=m.value+D.value/2;l.value.getContext("2d").translate(e,t),l.value.getContext("2d").rotate(F.value*Math.PI/180),l.value.getContext("2d").translate(-e,-t),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),l.value.getContext("2d").resetTransform()},we=a=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value+=a,D.value+=a),X(),me(a)},Ce=a=>{console.log("zoomDown"),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value-=a,D.value-=a),X(),me(a*-1)},Ie=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),g.value++,l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),X()},lu=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),g.value--,l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),X()},au=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),m.value--,l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),X()},ou=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),m.value++,l.value.getContext("2d").drawImage(n.value,g.value,m.value,k.value,D.value),X()},su=()=>{let a=l.value.getBoundingClientRect();M.value=a.x,S.value=a.y,console.log("getFrontCanvasOffset X: ",M.value," Y: ",S.value)},xe=a=>{a.preventDefault()};Bu(async()=>{$.active&&f("update:kp",s.value),l.value=window.document.getElementById("canvas-front"),B.value=window.document.getElementById("canvas-back"),V.value=window.document.getElementById("c1");let a=window.document.getElementById("canvas-back"),e=window.document.getElementById("canvas-front");R.value=a.getContext("2d");const t=new Image(720,1080);t.onload=function(){var A,U;(A=a.getContext("2d"))==null||A.drawImage(t,0,0,720,1080),(U=a.getContext("2d"))==null||U.save()},t.crossOrigin="Anonymous",t.src="https://psk.expert/upload/iblock/77d/w8huebomv7df5plmaq7ok88rcpemw03m/kos610_aaa.jpg";let x=!1,Y=e.width/2,Ae=e.height/2,Te=k.value,Pe=D.value;g.value=Y-Te/2,m.value=Ae-Pe/2,n.value=new Image,n.value.src="https://psk.expert/upload/lk-kp-logo-NOT-REMOVE.png",n.value.crossOrigin="Anonymous",n.value.onload=()=>{var A,U;(A=e.getContext("2d"))==null||A.drawImage(n.value,g.value,m.value,Te,Pe),(U=e.getContext("2d"))==null||U.save()},e.onmousedown=A=>{su(),console.log("startLogoPosX",g.value,"startLogoPosY",m.value),console.log("mouseDownCanvas",A);let U=A.clientX-M.value,de=A.clientY-S.value,fu=g.value,yu=g.value+k.value,hu=m.value,ku=m.value+D.value;U>fu&&U<yu&&de>hu&&de<ku?(x=!0,console.log("click Image"),window.addEventListener("wheel",xe,{passive:!1})):console.log("didnt click Image"),console.log("isDraggable",x)},e.onmouseup=()=>{x=!1,window.removeEventListener("wheel",xe,!1)},e.onmouseout=()=>{!x||(x=!1,window.removeEventListener("wheel",xe,!1))},e.onmousemove=A=>{if(!x)return;let U=A.clientX-M.value-g.value-k.value/2,de=A.clientY-S.value-m.value-D.value/2;console.log("move x:",U," y: ",de),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(n.value,g.value+=U,m.value+=de,k.value,D.value),X()},e.onwheel=A=>{if(!!x)if(A.deltaY>0){if(console.log("wheel down",A.deltaY),ee.value){Oe(-5);return}if(k.value<=10||D.value<=10)return;Ce(10)}else{if(console.log("wheel up",A.deltaY),ee.value){Le(5);return}if(k.value>=700||D.value>=800)return;we(10)}}});const nu=()=>{console.log(123),console.log("Image add to attachments"),V.value.getContext("2d").clearRect(0,0,V.value.width,V.value.height),V.value.getContext("2d").drawImage(B.value,0,0),V.value.getContext("2d").drawImage(l.value,0,0)},s=i($.kp),De=Q(()=>{let a=0;return s.value.offer.position.forEach(e=>{a=a+e.total}),a}),fe=i(!1),Z=i(!1),Ve=i(!0),te=i(!1),Re=i(""),ie=i(!1),G=Q(()=>c.getters.getKPLogoList),Se=Q(()=>c.getters.getKPLogoListOrigin),be=i(!0),iu=i(!1),du=a=>{if(!ie.value){let e=a.target.files[0],t=e.name,x=new FileReader;x.onloadend=()=>{Re.value=x.result,ie.value=!0,c.dispatch(J.ADD_KP_LOGO,{name:t,file:Re.value}).then(()=>{s.value.headerLogo=c.getters.getKPLogoId,ie.value=!1})},x.readAsDataURL(e)}},vu=()=>{c.commit(ae.SET_KP_LOGO_LIST_NEXT),++j.value,j.value>=G.value.length&&(j.value=0)},ru=()=>{c.commit(ae.SET_KP_LOGO_LIST_PREV),--j.value,j.value<0&&(j.value=G.value.length-1)},le=Q(()=>Ou),pu=Q(()=>c.getters.getShipmentsAddressInputData),j=i(0);c.dispatch(J.GET_KP_LOGO),c.dispatch(Ye.GET_SHIPMENTS_ADDRESS);const cu=Q(()=>c.getters.getCompanysListInput().filter(a=>a.id!=="")),mu=()=>{const a=cu.value.find(e=>e.id==s.value.offer.executor);if(a&&(s.value.offer.executor=a.name),s.value.additionally.pickup){const e=c.getters.getShipmentsAddress.find(t=>t.index==parseInt(s.value.additionally.pickupValue)).address;e&&(s.value.additionally.pickupValue=e)}G.value.length>0&&(s.value.headerLogo=Number(G.value[0].id)),f("next"),f("update:kp",s.value)},gu=a=>{a=a-1,G.value.length==1&&(a=0),v.value=!0;let e=0,t=G.value[a].id;Se.value.forEach((Y,Ae)=>{Y.id==t&&(e=Ae)});let x={index:a,id:Number(Se.value[e].id)};c.dispatch(J.DELETE_KP_LOGO,x).then(()=>{v.value=!1})};return(a,e)=>(d(),y(ve,null,[u("div",{class:C(["kp-step",{active:E.active}])},[L0,u("div",F0,[u("div",I0,[u("div",{class:C(["orders-list-item",{active:fe.value}])},[u("div",{class:"orders-list-row",onClick:e[0]||(e[0]=t=>fe.value=!fe.value)},T0),u("div",{class:C(["kp-step-body-row-group",{active:fe.value}])},[u("div",P0,[Q0,r(o(H),{modelValue:s.value.additionally.pickup,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.additionally.pickup=t),onOnClick:e[2]||(e[2]=t=>{s.value.additionally.delivery=!1,s.value.additionally.deliveryValue=0}),style:{"margin-left":"30px"}},null,8,["modelValue"]),U0,r(o(H),{modelValue:s.value.additionally.delivery,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.additionally.delivery=t),onOnClick:e[4]||(e[4]=t=>s.value.additionally.pickup=!1),style:{"margin-left":"30px"}},null,8,["modelValue"]),M0,s.value.additionally.delivery?(d(),P(o(ye),{key:0,min:0,step:10,modelValue:s.value.additionally.deliveryValue,"onUpdate:modelValue":e[5]||(e[5]=t=>s.value.additionally.deliveryValue=t),style:{"margin-left":"30px"}},null,8,["modelValue"])):_("",!0),s.value.additionally.delivery?(d(),y("div",z0,K0)):_("",!0),s.value.additionally.pickup?(d(),P(o(Ke),{key:2,data:o(pu),modelValue:s.value.additionally.pickupValue,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.additionally.pickupValue=t),style:"max-width: 300px"},null,8,["data","modelValue"])):_("",!0)]),u("div",G0,[Y0,r(o(H),{modelValue:s.value.additionally.prepayment,"onUpdate:modelValue":e[7]||(e[7]=t=>s.value.additionally.prepayment=t),onOnClick:e[8]||(e[8]=t=>s.value.additionally.prepaymentValue=0),style:"margin-left: 30px"},null,8,["modelValue"]),s.value.additionally.prepayment?(d(),P(o(ye),{key:0,min:0,max:100,step:.1,modelValue:s.value.additionally.prepaymentValue,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.additionally.prepaymentValue=t),style:"margin-left: 30px"},null,8,["step","modelValue"])):_("",!0),s.value.additionally.prepayment?(d(),y("div",q0,"%")):_("",!0),s.value.additionally.prepayment&&o(De)?(d(),y("div",X0,W(o(Ue)(Number(o(De)/100*s.value.additionally.prepaymentValue),!0))+" \u043E\u0442 "+W(o(Ue)(o(De),!0)),1)):_("",!0)]),he(u("div",Z0,[j0,r(o(H),{modelValue:s.value.additionally.delay,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.additionally.delay=t),onOnClick:e[11]||(e[11]=t=>{s.value.additionally.delayWorkValue=0,s.value.additionally.delayCalendarValue=0}),style:"margin-left: 30px"},null,8,["modelValue"]),s.value.additionally.delay?(d(),y("div",{key:0,style:Ee([te.value?"color: #292C32":"color: #FFFFFF","margin-left: 30px"])},ut,4)):_("",!0),s.value.additionally.delay?(d(),P(o(ye),{key:1,min:0,modelValue:s.value.additionally.delayCalendarValue,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.additionally.delayCalendarValue=t),disabled:te.value},null,8,["modelValue","disabled"])):_("",!0),he(u("div",tt,[r(o(ze),{modelValue:te.value,"onUpdate:modelValue":e[13]||(e[13]=t=>te.value=t)},null,8,["modelValue"])],512),[[Me,s.value.additionally.delay]]),s.value.additionally.delay?(d(),y("div",{key:2,style:Ee([te.value?"color: #FFFFFF":"color: #292C32","margin-left: 30px"])},st,4)):_("",!0),s.value.additionally.delay?(d(),P(o(ye),{key:3,min:0,modelValue:s.value.additionally.delayWorkValue,"onUpdate:modelValue":e[14]||(e[14]=t=>s.value.additionally.delayWorkValue=t),disabled:!te.value},null,8,["modelValue","disabled"])):_("",!0)],512),[[Me,s.value.additionally.prepaymentValue!==100]])],2)],2),u("div",{class:C(["orders-list-item",{active:s.value.header}])},[u("div",{class:"orders-list-row",onClick:e[15]||(e[15]=t=>s.value.header=!s.value.header)},dt),u("div",{class:C(["kp-step-body-row-group",{active:s.value.header}])},[u("div",vt,[rt,r(o(H),{modelValue:Ve.value,"onUpdate:modelValue":e[16]||(e[16]=t=>Ve.value=t),style:"margin-left: 30px"},null,8,["modelValue"]),u("div",{class:C(["kp-step-body-row-group",{active:Ve.value}])},[he(u("textarea",{class:"order-comment-textarea",style:{"min-width":"500px"},"onUpdate:modelValue":e[17]||(e[17]=t=>s.value.headerText=t),placeholder:"\u0422\u0435\u043A\u0441\u0442 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0430 \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u044F..."},null,512),[[He,s.value.headerText]])],2)]),u("div",pt,[ct,r(o(H),{modelValue:Z.value,"onUpdate:modelValue":e[18]||(e[18]=t=>Z.value=t),style:{"margin-left":"30px"}},null,8,["modelValue"]),Z.value?(d(),y("label",mt,[u("input",{onChange:e[19]||(e[19]=t=>du(t)),class:"kp-step-body-add-file-input",id:"file-upload",type:"file",accept:"image/*"},null,32)])):_("",!0),Z.value?(d(),y("div",gt,[ft,u("div",{class:C(["header-button left",{active:s.value.headerLogoAlign===o(le).LEFT}]),onClick:e[20]||(e[20]=t=>s.value.headerLogoAlign=o(le).LEFT),tooltip:"\u0421\u043B\u0435\u0432\u0430",flow:"up"},[r(o(x0),{class:"sidebar-btn"})],2),u("div",{class:C(["header-button center",{active:s.value.headerLogoAlign===o(le).CENTER}]),onClick:e[21]||(e[21]=t=>s.value.headerLogoAlign=o(le).CENTER),tooltip:"\u041F\u043E \u0446\u0435\u043D\u0442\u0440\u0443",flow:"up"},[r(o(y0),{class:"sidebar-btn"})],2),u("div",{class:C(["header-button right",{active:s.value.headerLogoAlign===o(le).RIGHT}]),tooltip:"\u0421\u043F\u0440\u0430\u0432\u0430",flow:"up",onClick:e[22]||(e[22]=t=>s.value.headerLogoAlign=o(le).RIGHT)},[r(o(O0),{class:"sidebar-btn"})],2)])):_("",!0)]),o(G).length>0?(d(),y("div",{key:0,class:C(["kp-step-body-row-group",{active:Z.value}])},[u("div",yt," \u041B\u043E\u0433\u043E #"+W(o(G)[0].id),1),ie.value?(d(),P(o($e),{key:0,style:{margin:"auto"}})):_("",!0),Z.value&&!ie.value?(d(),y("div",ht,[u("div",kt,[u("div",Et,[u("button",{class:"product-slider-arrow prev",onClick:ru}),r(Lu,{name:"product-slider-trans",class:"product-slider",style:"align-items: center; height: 500px;",tag:"div"},{default:I(()=>[(d(!0),y(ve,null,ke(o(G),t=>(d(),y("div",{class:"product-slider-slide",key:t.id},[t.image?(d(),y("img",{key:0,src:t.image},null,8,_t)):_("",!0)]))),128))]),_:1}),u("div",{class:"product-slider-arrow next",onClick:vu})])])])):_("",!0),u("div",wt,[r(o(T),{onClick:e[23]||(e[23]=t=>gu(j.value))},{default:I(()=>[Ct]),_:1})])],2)):(d(),y("div",{key:1,class:C(["kp-step-title kp-step-body-row-group",{active:Z.value}])},Dt,2))],2)],2),u("div",Vt,[bt,he(u("textarea",{class:"order-comment-textarea","onUpdate:modelValue":e[24]||(e[24]=t=>s.value.offer.comment=t)},null,512),[[He,s.value.offer.comment]])]),u("div",At,[$t,r(o(H),{modelValue:be.value,"onUpdate:modelValue":e[25]||(e[25]=t=>be.value=t),onOnClick:e[26]||(e[26]=t=>{be.value=!0,iu.value=!1,s.value.as="PDF"}),style:"margin-left: 30px"},null,8,["modelValue"]),Bt])])]),u("div",{class:"order-list content-elem",style:Ee([p.value?"display: flex;":"display: none;"])},[u("div",Ot,[s.value.offer.position?(d(),y("div",Lt,[u("div",Ft,[u("button",{onClick:e[27]||(e[27]=t=>O.value=!O.value),class:C(["select-input-btn",O.value?"active":""])},"\u0412\u042B\u0411\u0415\u0420\u0418\u0422\u0415 \u0422\u041E\u0412\u0410\u0420 \u0418\u0417 \u0412\u042B\u041F\u0410\u0414\u0410\u042E\u0429\u0415\u0413\u041E \u0421\u041F\u0418\u0421\u041A\u0410. ",2),u("div",{class:C(["select-input-options",O.value?"active":""])},[(d(!0),y(ve,null,ke(s.value.offer.position,(t,x)=>(d(),y("p",{key:x,class:C("select-input-item"),onClick:Y=>{Ze(t.guid),O.value=!1}}," ["+W(t.article)+"] "+W(_e(t.product.NAME)),9,It))),128))],2)]),v.value?(d(),P(o($e),{key:0,center:""})):_("",!0)])):_("",!0),u("div",Rt,[u("div",null,[u("input",{ref_key:"file",ref:se,id:"myfile",type:"file",onChange:e[28]||(e[28]=t=>uu()),style:{display:"none"}},null,544),r(o(T),{tooltip:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u0430\u0439\u043B \u0441 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C \u043D\u0430 \u0445\u043E\u043B\u0441\u0442",tooltipFlow:"up",onOnClick:e[29]||(e[29]=t=>tu())},{default:I(()=>[St]),_:1})]),u("div",Tt,[u("span",null,[r(o(T),{onMousedown:e[30]||(e[30]=t=>au())},{default:I(()=>[Pt]),_:1})]),u("div",null,[r(o(T),{onOnClick:e[31]||(e[31]=t=>lu())},{default:I(()=>[Qt]),_:1}),r(o(T),{onOnClick:e[32]||(e[32]=t=>ou())},{default:I(()=>[Ut]),_:1}),r(o(T),{onOnClick:e[33]||(e[33]=t=>Ie())},{default:I(()=>[Mt]),_:1})])]),u("div",null,[zt,u("div",Ht,[u("div",null,[r(o(T),{onOnClick:e[34]||(e[34]=t=>Ce(1))},{default:I(()=>[Nt]),_:1})]),u("div",null,[r(o(re),{onClick:e[35]||(e[35]=t=>w(t)),onFocusout:e[36]||(e[36]=t=>ce(t)),modelValue:L.value,"onUpdate:modelValue":e[37]||(e[37]=t=>L.value=t),class:C("input-text-field-modify")},null,8,["modelValue"])]),u("div",null,[r(o(T),{onOnClick:e[38]||(e[38]=t=>we(1))},{default:I(()=>[Kt]),_:1})])])]),u("div",Gt,[r(o(T),{style:{margin:"0","border-radius":"100px",width:"30px","min-width":"30px","min-height":"30px",height:"30px",cursor:"help"},active:!1,tooltip:"\u041F\u0435\u0440\u0435\u043A\u043B\u044E\u0447\u0430\u0442\u0435\u043B\u044C \u0434\u043B\u044F \u0432\u044B\u0431\u043E\u0440\u0430 \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u043A\u043E\u043B\u0435\u0441\u043E\u043C \u043C\u044B\u0448\u0438",tooltipFlow:"up"},{default:I(()=>[Yt]),_:1}),r(o(ze),{modelValue:ee.value,"onUpdate:modelValue":e[39]||(e[39]=t=>ee.value=t)},null,8,["modelValue"])]),u("div",null,[qt,u("div",Xt,[u("div",null,[r(o(T),{onOnClick:e[40]||(e[40]=t=>Oe(-1))},{default:I(()=>[Zt]),_:1})]),u("div",null,[r(o(re),{onClick:e[41]||(e[41]=t=>ue(t)),onFocusout:e[42]||(e[42]=t=>h(t)),modelValue:ge.value,"onUpdate:modelValue":e[43]||(e[43]=t=>ge.value=t),class:C("input-text-field-modify")},null,8,["modelValue"])]),u("div",null,[r(o(T),{onOnClick:e[44]||(e[44]=t=>Le(1))},{default:I(()=>[jt]),_:1})])])]),u("div",null,[r(o(T),{onOnClick:e[45]||(e[45]=t=>nu()),tooltip:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u043E\u043E\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0432 \u0444\u0430\u0439\u043B \u041A\u041F","tooltip-flow":"up"},{default:I(()=>[Wt]),_:1}),r(o(T),{onOnClick:e[46]||(e[46]=t=>eu()),tooltip:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u043D\u0430 \u0443\u0441\u0442\u0440\u043E\u0439\u0441\u0442\u0432\u043E","tooltip-flow":"up",style:"background-color: oldlace;"},{default:I(()=>[Jt]),_:1})])]),ne.value.length>0?(d(),y("div",el,[(d(!0),y(ve,null,ke(ne.value,(t,x)=>(d(),y("img",{style:{cursor:"pointer"},onClick:Y=>je(Y.target.src),key:x,src:t,height:"200"},null,8,ul))),128))])):_("",!0),tl])],4),u("div",ll,[u("div",{class:"kp-step-actions-link",onClick:e[47]||(e[47]=t=>a.$emit("prev"))},"\u041D\u0430\u0437\u0430\u0434"),u("div",{class:"kp-step-actions-link right",onClick:e[48]||(e[48]=t=>mu())},"\u0414\u0430\u043B\u0435\u0435")])],2),v.value?(d(),P(o(qe),{key:0})):_("",!0)],64))}}),ol=u("div",{class:"kp-step-title"},"\u0424\u0430\u0439\u043B \u0441\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u043E\u0432\u0430\u043D",-1),sl={class:"kp-step-body"},nl={class:"kp-step-actions"},il=oe({__name:"KpStep4",props:{active:{type:Boolean,default:!1}},emits:["save","prev"],setup(E,{emit:f}){const $=()=>{f("save")};return(c,v)=>(d(),y("div",{class:C(["kp-step",{active:E.active}])},[ol,u("div",sl,[u("div",{onClick:v[0]||(v[0]=p=>$()),class:"kp-step-actions-link",style:"text-align: center"},"\u0421\u043A\u0430\u0447\u0430\u0442\u044C")]),u("div",nl,[u("div",{class:"kp-step-actions-link",onClick:v[1]||(v[1]=p=>c.$emit("prev"))},"\u041D\u0430\u0437\u0430\u0434")])],2))}}),dl={class:"kp"},vl={class:"top-line product-page"},rl=Xe('<div class="kp-head-card"><div class="kp-head-card-title">\u041A\u043E\u043D\u0441\u0442\u0440\u0443\u043A\u0442\u043E\u0440 \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u0438\u0445 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0439</div><div class="kp-head-card-subtitle"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path fill="#A5A7A9" d="M11.875 18Q12.5 18 12.95 17.55Q13.4 17.1 13.4 16.475Q13.4 15.85 12.95 15.412Q12.5 14.975 11.875 14.975Q11.25 14.975 10.8 15.412Q10.35 15.85 10.35 16.475Q10.35 17.1 10.8 17.55Q11.25 18 11.875 18ZM10.7 14.15H13.05Q13.05 13.425 13.25 12.925Q13.45 12.425 14.2 11.7Q14.775 11.15 15.137 10.525Q15.5 9.9 15.5 9.025Q15.5 7.525 14.525 6.737Q13.55 5.95 12.15 5.95Q10.625 5.95 9.613 6.825Q8.6 7.7 8.2 8.9L10.4 9.725Q10.575 9.225 10.95 8.725Q11.325 8.225 12.025 8.225Q12.525 8.225 12.8 8.537Q13.075 8.85 13.075 9.225Q13.075 9.6 12.812 10Q12.55 10.4 12.275 10.625Q11.275 11.55 10.988 12.137Q10.7 12.725 10.7 14.15ZM12 22.85Q9.75 22.85 7.763 22Q5.775 21.15 4.312 19.688Q2.85 18.225 2 16.25Q1.15 14.275 1.15 12Q1.15 9.725 2 7.75Q2.85 5.775 4.312 4.312Q5.775 2.85 7.763 2Q9.75 1.15 12 1.15Q14.275 1.15 16.25 2Q18.225 2.85 19.688 4.312Q21.15 5.775 22 7.75Q22.85 9.725 22.85 12Q22.85 14.275 22 16.25Q21.15 18.225 19.688 19.688Q18.225 21.15 16.25 22Q14.275 22.85 12 22.85ZM12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12ZM12 19.7Q15.2 19.7 17.45 17.462Q19.7 15.225 19.7 12Q19.7 8.775 17.45 6.537Q15.2 4.3 12 4.3Q8.8 4.3 6.55 6.537Q4.3 8.775 4.3 12Q4.3 15.225 6.55 17.462Q8.8 19.7 12 19.7Z"></path></svg><div>\u041D\u0430 \u044D\u0442\u043E\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0435 \u0412\u044B \u0441\u043C\u043E\u0436\u0435\u0442\u0435 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0438 \u0441\u043E\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u043E\u0433\u043E \u0437\u0430\u043A\u0430\u0437\u0430, \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0430 \u0438\u043B\u0438 \u0442\u043E\u0432\u0430\u0440\u0430 \u0441\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0441\u043E \u0441\u0432\u043E\u0438\u043C \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C \u0438 \u0446\u0435\u043D\u0430\u043C\u0438.</div></div></div>',1),pl={class:"kp-form"},cl={class:"kp-form-stepper-wrap"},ml={class:"kp-form-stepper"},gl={class:"kp-form-stepper-list"},fl={class:"kp-form-stepper-content"},yl={class:"kp-form-stepper-content-tabs-box"},Dl=oe({__name:"KpPage",setup(E){const f=Be(),$=Q(()=>f.getters.getCompanysList),c=i(""),v=i(z.cloneDeep(Ge)),p=i(1),O=i(!1),R=i(!1),n=i(N.ORDER);f.getters.isCompanysLoad||f.dispatch(Iu.GET_COMPANYS),f.getters.isOrders||(O.value=!0,f.dispatch(Ru.GET_ORDERS).then(()=>{O.value=!1})),f.dispatch(J.GET_KP_LOGO),f.dispatch(Ye.GET_SHIPMENTS_ADDRESS),v.value=f.getters.getKP,p.value=f.getters.getKPStep,p.value!=1&&(n.value=N.CATALOG_POS);const l=Q(()=>f.getters.getOrderDraftCount>0),M=()=>{if(p.value<4&&(p.value=p.value+1),p.value==4){let V=z.cloneDeep(v.value);V.additionally.prepayment&&(V.additionally.prepaymentValue=V.additionally.prepaymentValue/100),R.value=!0,f.dispatch(J.SEND_KP,V).finally(()=>{R.value=!1}),f.commit(ae.SET_KP_STEP,1)}f.commit(ae.SET_KP_STEP,p.value)},S=()=>{p.value>1&&(p.value=p.value-1),f.commit(ae.SET_KP_STEP,p.value)},B=()=>{f.dispatch(J.SAVE_KP)};return pe(v,()=>{f.commit(ae.SET_KP,v.value)}),(V,g)=>(d(),y("div",dl,[u("div",vl,[r(wu,{data:o($),modelValue:c.value,"onUpdate:modelValue":g[0]||(g[0]=m=>c.value=m)},null,8,["data","modelValue"]),r(_u),r(Eu)]),r(Cu),rl,u("div",pl,[u("div",cl,[u("div",ml,[u("div",{class:"kp-form-stepper-bar",style:Ee("width:"+33.33*(p.value-1)+"%")},null,4),u("ul",gl,[u("li",{class:C(["kp-form-stepper-item",{active:p.value>=1}]),tooltip:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0435",flow:"up"},"1",2),u("li",{class:C(["kp-form-stepper-item",{active:p.value>=2}]),tooltip:"\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 \u043F\u043E\u043B\u044F",flow:"up"},"2",2),u("li",{class:C(["kp-form-stepper-item",{active:p.value>=3}]),tooltip:"\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",flow:"up"},"3",2),u("li",{class:C(["kp-form-stepper-item with-image",{active:p.value>=4}]),tooltip:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u0435 \u0444\u0430\u0439\u043B",flow:"up"},null,2)])])]),u("div",fl,[u("div",yl,[u("div",{class:C(`kp-form-stepper-content-tabs step${p.value}`)},[r(Wu,{onNext:M,modelValue:n.value,"onUpdate:modelValue":g[1]||(g[1]=m=>n.value=m),active:p.value===1,isDraft:o(l)},null,8,["modelValue","active","isDraft"]),r(v0,{type:n.value,onNext:M,onPrev:S,kp:v.value,"onUpdate:kp":g[2]||(g[2]=m=>v.value=m),active:p.value===2},null,8,["type","kp","active"]),r(al,{onNext:M,onPrev:S,kp:v.value,"onUpdate:kp":g[3]||(g[3]=m=>v.value=m),active:p.value===3},null,8,["kp","active"]),r(il,{onPrev:S,onSave:B,active:p.value===4},null,8,["active"])],2)])])]),R.value?(d(),P(qe,{key:0})):_("",!0)]))}});export{Dl as default};
