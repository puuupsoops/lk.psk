import{f as B,u as M,B as b,h as l,g as i,i as G,aa as C,p as H,D as x,o as m,c as g,b as f,m as u,x as o,q as F,L as Y,ab as j,d as q,j as I,ac as K,ad as Q,Q as X,ae as z,af as J}from"./index.09a56ea9.js";import{N as W}from"./Notification.b98f3bf7.js";import{_ as Z,a as tt,P as et,b as at,c as ot,d as ut}from"./ProductSliderSmallCard.45465e8a.js";import"./CompanyCalendar.ddcfc559.js";import"./CompanyAboutSmallCard.cbad0acf.js";import{_ as st}from"./CompanyBarTop.a3a46566.js";/* empty css                                                          */import{c as rt}from"./calcProductDiscount.1954a33d.js";import"./vee-validate.esm.80362e72.js";import"./object.43a30ddf.js";import"./doc.66697d7d.js";const lt={class:"top-line product-page"},nt={key:0},dt={key:1,class:"content-wrap content-product-wrap"},ct={class:"content-wrap-elem"},it={class:"content-elem-desc"},mt={class:"content-wrap-elem"},pt={key:1},vt={key:0},At=B({__name:"ProductPage",props:{article:{type:String}},setup(V){const P=V,t=M(),_=b(),r=l({get:()=>t.getters.getLoader,set:s=>t.commit(X.SET_LOADER,s)}),p=i(""),v=i(""),n=i(!1),D=i(!1),d=i(""),S=i([]),E=()=>{_.push({name:"Order"})};G(async()=>{var s;if(P.article&&(r.value=!0,t.dispatch(C.SEARCH_PRODUCT,P.article).then(()=>{n.value=!0,t.getters.getProduct.ID?d.value=t.getters.getProduct.ID:_.push({name:"Product"})}).finally(()=>{r.value=!1})),t.getters.getActiveCompanyId!==""){p.value=t.getters.getActiveCompanyId;return}(!t.getters.isCompanysLoad||!t.getters.isManagerLoad)&&await t.dispatch(H.GET_COMPANYS),p.value=t.getters.getCompanys===[]?"":(s=t.getters.getCompanys[0])==null?void 0:s.uid}),x(()=>P.article,s=>{s&&(r.value=!0,t.dispatch(C.SEARCH_PRODUCT,P.article).then(()=>{n.value=!0,t.getters.getProduct.ID?d.value=t.getters.getProduct.ID:_.push({name:"Product"})}).finally(()=>{r.value=!1}))});const h=()=>{r.value=!0,t.dispatch(C.GET_PRODUCT_BY_ID,d.value).then(()=>{d.value=t.getters.getProduct.ID}).finally(()=>{r.value=!1})},O=()=>{n.value=!1,t.commit(J.SET_SEARCH_PRODUCT_CLEAR)},R=()=>{v.value.trim()!==""&&(O(),r.value=!0,t.dispatch(C.SEARCH_PRODUCT,v.value).then(()=>{n.value=!0,d.value=t.getters.getProduct.ID}).finally(()=>{r.value=!1}))},U=()=>{O(),v.value="",_.push("/product")},k=()=>{const s={article:t.getters.getProduct.ARTICLE,guid:t.getters.getProduct.UID,product:t.getters.getProduct,characteristics:S.value};t.dispatch(z.ADD_POSITION,s),D.value=!0},N=l(()=>t.getters.getCompanysList),$=l(()=>t.getters.getProductOffers),c=l(()=>t.getters.getProduct),T=l(()=>t.getters.getProductFound),w=l(()=>t.getters.getProductImages),L=l(()=>t.getters.getProductProtect),y=l(()=>{var A;const s=String(t.getters.getProduct.STATUS),e=Number((A=t.getters.getProduct)==null?void 0:A.MAX_DISCOUNT),a=Number(t.getters.getCompanyDiscount(p.value,t.getters.getProductOffersORGGUID));return rt(s,e,a)});return(s,e)=>(m(),g("div",null,[f("div",lt,[u(o(st),{data:N.value,modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a)},null,8,["data","modelValue"]),u(o(W)),u(o(F))]),u(o(Y),{catalog:""}),u(o(j),{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=a=>v.value=a),to:"product",onSearch:e[2]||(e[2]=a=>R())},null,8,["modelValue"]),T.value.length>0?(m(),g("div",nt,[n.value?(m(),q(o(Z),{key:0,title:String(c.value.NAME),price:String(c.value.PRICE_OPT),status:String(c.value.STATUS),discount:y.value,onShowSearch:e[3]||(e[3]=a=>U())},null,8,["title","price","status","discount"])):I("",!0),e[9]||(e[9]=f("br",null,null,-1)),n.value?(m(),g("div",dt,[f("div",ct,[u(o(K),{data:T.value,cardType:"search",modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=a=>d.value=a),onOnClick:e[5]||(e[5]=a=>h())},null,8,["data","modelValue"]),f("div",it,[u(o(tt),{modelValue:S.value,"onUpdate:modelValue":e[6]||(e[6]=a=>S.value=a),data:$.value,discount:y.value,onOnClick:e[7]||(e[7]=a=>k())},null,8,["modelValue","data","discount"])]),u(o(et),{data:c.value},null,8,["data"])]),f("div",mt,[u(o(at),{data:w.value,onToOrder:E},null,8,["data"]),u(o(ot),{data:c.value,discount:y.value},null,8,["data","discount"]),u(o(ut),{data:c.value,protect:L.value},null,8,["data","protect"])])])):I("",!0)])):(m(),g("div",pt,[n.value?(m(),g("div",vt,"\u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E")):I("",!0)])),u(o(Q),{modelValue:D.value,"onUpdate:modelValue":e[8]||(e[8]=a=>D.value=a),message:"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E \u0432 \u0437\u0430\u043A\u0430\u0437",timeout:5e3,notification:""},null,8,["modelValue"])]))}});export{At as default};
