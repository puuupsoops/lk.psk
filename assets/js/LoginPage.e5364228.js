import{f as _,u as V,B as y,b9 as S,g as E,h as i,i as k,o as f,c as h,b as a,m as r,w as T,x as l,aG as B,aM as F,j as R,ad as x,Q as z,ba as d,p as M,aR as D,bb as U,b8 as N}from"./index.09a56ea9.js";import{d as v,a as b,E as O,F as P}from"./vee-validate.esm.80362e72.js";var q="/assets/img/logo.a8cca4dc.png";const G={key:0,class:"authorization"},H={class:"authorization-body"},I={class:"authorization-check"},W=["disabled"],Q=_({__name:"LoginPage",setup($){const t=V(),A=y(),c=S(),o=E({login:"",password:""}),m=E(!1),n=i({get:()=>t.getters.getLoader,set:u=>t.commit(z.SET_LOADER,u)}),w=i(()=>t.getters.isAuthenticated),C=i(()=>t.getters.getLoginErrorMsg);v("required",u=>!u||!u.length?"\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435":!0),v("minLength",(u,[e])=>!u||!u.length?!0:u.length<e?`\u041C\u0438\u043D\u0438\u043C\u0443\u043C ${e} \u0441\u0438\u043C\u0432\u043E\u043B\u0430`:!0);const p=i({get:()=>t.getters.getLoginError,set:()=>t.commit(d.CLEAR_LOGIN_ERROR)}),g=async u=>{u?(n.value=!0,t.commit(d.SET_SAVE_AUTH),t.commit(d.SET_AUTH,u)):m.value&&t.commit(d.SET_SAVE_AUTH),await Promise.all([t.dispatch(M.GET_COMPANYS),t.dispatch(D.GET_PROFILE)]),n.value=!1,await t.dispatch(U.AUTH_WS),await A.push("/")},L=()=>{n.value=!0,t.dispatch(N.LOGIN,o.value).finally(async()=>{await g()}).catch(()=>{o.value.password="",setTimeout(()=>{n.value=!1},3e3)})};return k(async()=>{!c.query.token||await g(String(c.query.token))}),(u,e)=>(f(),h("div",null,[w.value?R("",!0):(f(),h("div",G,[a("div",H,[e[6]||(e[6]=a("div",{class:"authorization-logo"},[a("img",{src:q,alt:"\u043B\u043E\u0433\u043E\u0442\u0438\u043F"})],-1)),r(l(P),{onSubmit:L,class:"authorization-form"},{default:T(()=>[r(l(b),{as:"input",modelValue:o.value.login,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.login=s),class:"authorization-input",name:"Login",placeholder:"\u041B\u043E\u0433\u0438\u043D",autocomplete:"off",rules:"required|minLength:3"},null,8,["modelValue"]),r(l(O),{name:"Login"}),r(l(b),{as:"input",type:"password",modelValue:o.value.password,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.password=s),class:"authorization-input",name:"password",placeholder:"\u041F\u0430\u0440\u043E\u043B\u044C",autocomplete:"off",rules:"required|minLength:3"},null,8,["modelValue"]),a("label",I,[B(a("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>m.value=s),class:"check-input",type:"checkbox",name:"remember"},null,512),[[F,m.value]]),e[4]||(e[4]=a("span",{class:"checkbox-custom"},null,-1)),e[5]||(e[5]=a("span",{class:"check-txt"},"\u0417\u0430\u043F\u043E\u043C\u043D\u0438\u0442\u044C \u043C\u0435\u043D\u044F",-1))]),a("button",{class:"authorization-btn",type:"submit",disabled:n.value},"\u0412\u043E\u0439\u0442\u0438",8,W)]),_:1})]),e[7]||(e[7]=a("div",{class:"authorization-bottom"}," Produced by Expert Workwear ",-1))])),r(x,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value=s),message:C.value},null,8,["modelValue","message"])]))}});export{Q as default};
