import{f as O,V as F,g as $,h as C,_ as S,r as f,o,c as i,b as t,t as c,j as h,F as b,e as I,y as E,m as V,aw as N,a as w,u as L,D as M,ae as U,d as D,aG as k,aN as B,aH as R,L as T,ak as P,B as j,i as G,p as H,av as q,aD as A,aJ as y}from"./index.09a56ea9.js";const W=O({props:{data:{type:Object},modelValue:{type:Array,required:!0}},emits:["update:modelValue"],components:{AmountInput:F},setup(e,{emit:s}){const r=$([]),u=$({}),v=C(()=>{let m=Object.assign({},e.data);if(m.position)m.position.forEach(d=>{d.characteristics.forEach(n=>n.select=0)});else return null;return m});return{open:r,open_presail:u,val:v,upd:()=>{let m=[];v.value&&v.value.position.forEach(d=>{d.characteristics.forEach(n=>{n.select>0&&m.push({productUID:d.product.UID,characteristicGUID:n.CHARACTERISTIC,count:n.select})})}),s("update:modelValue",m)}}}}),J={class:"order-list content-elem"},z={key:0,class:"order-list-bottom scroll-elem"},Y={class:"order-list-bottom-wrap"},K={key:0,class:"order-list-row order-list-heading"},Q={class:"order-list-elem"},X=["onClick"],Z={class:"order-list-elem"},x={class:"order-list-elem"},ee={class:"order-list-elem"},se=["innerHTML"],te={class:"order-list-elem"},le={key:0,class:"order-list-elem"},ae={key:1,class:"order-list-elem"},ue={class:"order-list-elem"},oe={class:"order-list-elem"},de={key:0,class:"order-list-elem"},ne={key:1,class:"order-list-elem"},ie={class:"order-list-elem"},re={key:2,class:"order-list-elem"},me={key:3,class:"order-list-elem"},pe={class:"order-list-elem"};function ce(e,s,r,u,v,g){const m=f("amount-input");return o(),i("div",J,[e.val?(o(),i("div",z,[t("div",Y,[e.val.position.length>0?(o(),i("div",K,[s[0]||(s[0]=t("div",{class:"order-list-elem"},"\u2116",-1)),s[1]||(s[1]=t("div",{class:"order-list-elem"},"\u0410\u0440\u0442\u0438\u043A\u0443\u043B",-1)),s[2]||(s[2]=t("div",{class:"order-list-elem"},"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",-1)),t("div",Q,c(e.open.length!=0?"\u0426\u0435\u043D\u0430":""),1),s[3]||(s[3]=t("div",{class:"order-list-elem"},"\u041A\u043E\u043B-\u0432\u043E",-1)),s[4]||(s[4]=t("div",{class:"order-list-elem"},"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",-1)),s[5]||(s[5]=t("div",{class:"order-list-elem"},"\u0412\u044B\u0431\u0440\u0430\u043D\u043E",-1))])):h("",!0),(o(!0),i(b,null,I(e.val.position,(d,n)=>(o(),i("div",{class:E(e.open.indexOf(n)!==-1?"order-list-item active":"order-list-item"),key:n},[t("div",{class:"order-list-row order-list-main-row",onClick:l=>e.open.indexOf(n)===-1?e.open.push(n):e.open.splice(e.open.indexOf(n),1)},[t("div",Z,c(n+1),1),t("div",x,c(d.article),1),t("div",ee,[t("span",{innerHTML:d.product.NAME},null,8,se)]),s[6]||(s[6]=t("div",{class:"order-list-elem"},null,-1)),t("div",te,c(d.count),1),d.total?(o(),i("div",le,c(Number(d.total).toLocaleString("ru"))+" \u20BD",1)):(o(),i("div",ae," -- ")),t("div",ue,c(d.characteristics.filter(l=>l.select>0).length),1)],8,X),t("div",{class:E(e.open.indexOf(n)!==-1?"order-list-sublist active":"order-list-sublist")},[(o(!0),i(b,null,I(d.characteristics,(l,p)=>(o(),i("div",{key:p,class:"order-list-row"},[s[7]||(s[7]=t("div",{class:"order-list-elem"},null,-1)),s[8]||(s[8]=t("div",{class:"order-list-elem"},null,-1)),t("div",oe,c(l.CHARACTERISTIC),1),l.PRICE?(o(),i("div",de,c(Number(l.PRICE).toLocaleString("ru"))+" \u20BD",1)):(o(),i("div",ne," -- ")),t("div",ie,[t("span",null,c(l.count),1)]),l.PRICE?(o(),i("div",re,c(Number(l.PRICE*l.count).toLocaleString("ru"))+" \u20BD",1)):(o(),i("div",me," -- ")),t("div",pe,[V(m,{max:l.count,modelValue:l.select,"onUpdate:modelValue":a=>l.select=a,onOnInput:e.upd},null,8,["max","modelValue","onUpdate:modelValue","onOnInput"])])]))),128))],2)],2))),128))])])):h("",!0)])}var ve=S(W,[["render",ce]]);const ge=O({components:{SelectInput:N,ClaimOrder:ve,PreloaderLocal:w},props:{modelValue:{type:Object,required:!0},cardId:{type:Number,required:!0}},emits:["update:modelValue","update:files","close"],setup(e,{emit:s}){const r=L(),u=$({date_create:"",status:0,title:"\u041F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044F \u043F\u043E \u0417\u0430\u043A\u0430\u0437\u0443 \u2116",partner_name:"",partner_guid:"",id:e.modelValue.id,case:1,products:[],message:"",files:[]}),v=$(!1),g=C({get:()=>u.value.partner_guid==""&&m.value!==null?r.getters.getOrders.find(l=>l.n==m.value).partner_guid:u.value.partner_guid,set:l=>{u.value.partner_guid=l;const p=r.getters.getOrders.filter(a=>a.partner_guid==l);p.length&&(u.value.id=Math.max(...p.map(a=>a.n))),s("update:modelValue",u.value)}}),m=C({get:()=>e.modelValue.id?e.modelValue.id:u.value.id,set:l=>{u.value.id=l,s("update:modelValue",u.value),u.value.partner_guid=r.getters.getOrders.find(p=>p.n==l).partner_guid,v.value=!0,r.dispatch(U.GET_ORDER_DETAIL,l).finally(()=>{u.value.order_detail=r.getters.getOrderDetail,v.value=!1})}});M(u.value,()=>{var l;u.value.partner_guid=g.value,u.value.partner_name=r.getters.getCompanyData(u.value.partner_guid).name,u.value.title="\u041F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044F \u043F\u043E \u0417\u0430\u043A\u0430\u0437\u0443 \u2116"+m.value+" \u043E\u0442 "+((l=r.getters.getOrders.find(p=>p.n==m.value))==null?void 0:l.date.substring(0,10)),u.value.order_detail=e.modelValue.order_detail,s("update:modelValue",u.value)});const d=l=>{u.value.files.push(l.target.files[0]),s("update:modelValue",u.value)},n=l=>{u.value.files.splice(l,1),s("update:modelValue",u.value)};return{data:u,loading:v,order:m,companyUID:g,orders:C(()=>r.getters.getOrders.filter(l=>l.partner_guid==g.value)),companys:C(()=>r.getters.getCompanysList),handleFileUpload:d,delFile:n}}}),fe={key:0,class:"claim-header"},_e={class:"shipment-heading claim-heading"},Ce={class:"shipment-heading-elem"},Ee={class:"shipment-heading-info"},$e={key:0,class:"shipment-title"},De={key:1,class:"shipment-title"},he={class:"shipment-heading-select"},be={class:"base-select-wrap"},Ie=["value"],Ve={class:"shipment-heading-elem"},Ae={class:"orders-heading-item"},ye={class:"nav-tab claim-tab"},Oe={class:"nav-tab-wrap"},Se={class:"claim-info"},ke={class:"claim-info-elem"},we={class:"content-elem"},Le={class:"order-list-bottom scroll-elem"},Fe={key:0,style:{display:"flex","justify-content":"center"}},Ne={class:"claim-info-elem"},Me={class:"claim-info-textarea-wrap"},Ue={class:"claim-info-add-file"},Be=["id"],Re=["for"],Te={class:"claim-info-add-file-val"},Pe={class:"claim-doc"},je=["onClick"],Ge={class:"claim-doc-elem-name"};function He(e,s,r,u,v,g){var p;const m=f("router-link"),d=f("SelectInput"),n=f("PreloaderLocal"),l=f("ClaimOrder");return o(),i("div",null,[e.cardId!=0?(o(),i("div",fe,[t("div",{class:"claim-header-close",onClick:s[0]||(s[0]=a=>e.$emit("close"))})])):h("",!0),t("div",_e,[t("div",Ce,[e.cardId==0?(o(),D(m,{key:0,tag:"a",to:"/claims",class:"shipment-heading-back-btn"})):h("",!0),t("div",Ee,[e.order?(o(),i("div",$e,[t("span",null,"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044E \u043F\u043E \u0417\u0430\u043A\u0430\u0437\u0443 \u2116 "+c(e.modelValue.id)+" \u043E\u0442 "+c((p=e.orders.find(a=>a.n==e.order))==null?void 0:p.date.substring(0,10)),1)])):(o(),i("div",De,[...s[10]||(s[10]=[t("span",null,"\u041E\u0442\u0441\u0443\u0442\u0432\u0443\u044E\u0442 \u0437\u0430\u043A\u0430\u0437\u044B",-1)])])),t("div",he,[s[11]||(s[11]=t("span",null,"\u041E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0435: \xA0",-1)),t("div",be,[k(t("select",{class:"base-select",style:{width:"100%"},"onUpdate:modelValue":s[1]||(s[1]=a=>e.order=a)},[(o(!0),i(b,null,I(e.orders,(a,_)=>(o(),i("option",{key:_,value:a.n},c(a.name),9,Ie))),128))],512),[[B,e.order]])])])])]),t("div",Ve,[t("div",Ae,[s[12]||(s[12]=t("div",{class:"orders-heading-text"},"\u041A\u043E\u043D\u0442\u0440\u0430\u0433\u0435\u043D\u0442:",-1)),V(d,{data:e.companys,modelValue:e.companyUID,"onUpdate:modelValue":s[2]||(s[2]=a=>e.companyUID=a)},null,8,["data","modelValue"])])])]),t("div",ye,[s[17]||(s[17]=t("span",null,"\u041F\u0440\u0438\u0447\u0438\u043D\u0430 \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u0438:",-1)),t("div",Oe,[t("a",{class:E("nav-tab-elem gradient-btn"+(e.data.case==1?" active":"")),onClick:s[3]||(s[3]=a=>e.data.case=1)},[...s[13]||(s[13]=[t("div",{class:"gradient-btn-text"},"\u041D\u0435\u0434\u043E\u0441\u0434\u0430\u0447\u0430",-1)])],2),t("a",{class:E("nav-tab-elem gradient-btn"+(e.data.case==2?" active":"")),onClick:s[4]||(s[4]=a=>e.data.case=2)},[...s[14]||(s[14]=[t("div",{class:"gradient-btn-text"},"\u041F\u0435\u0440\u0435\u0441\u043E\u0440\u0442",-1)])],2),t("a",{class:E("nav-tab-elem gradient-btn"+(e.data.case==3?" active":"")),onClick:s[5]||(s[5]=a=>e.data.case=3)},[...s[15]||(s[15]=[t("div",{class:"gradient-btn-text"},"\u041A\u0430\u0447\u0435\u0441\u0442\u0432\u043E",-1)])],2),t("a",{class:E("nav-tab-elem gradient-btn"+(e.data.case==0?" active":"")),onClick:s[6]||(s[6]=a=>e.data.case=0)},[...s[16]||(s[16]=[t("div",{class:"gradient-btn-text"},"\u0414\u0440\u0443\u0433\u043E\u0435",-1)])],2)])]),t("div",Se,[t("div",ke,[t("div",we,[t("div",Le,[e.loading?(o(),i("div",Fe,[V(n)])):(o(),D(l,{key:1,data:e.modelValue.order_detail,modelValue:e.data.products,"onUpdate:modelValue":s[7]||(s[7]=a=>e.data.products=a)},null,8,["data","modelValue"]))])])]),t("div",Ne,[s[18]||(s[18]=t("div",{class:"claim-info-title"},"\u0421\u043E\u043F\u0440\u043E\u0432\u043E\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u0442\u0435\u043A\u0441\u0442 \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u0438",-1)),t("div",Me,[k(t("textarea",{class:"claim-info-textarea",name:"","onUpdate:modelValue":s[8]||(s[8]=a=>e.data.message=a)},null,512),[[R,e.data.message]]),t("div",Ue,[t("input",{class:"claim-info-add-file-input",onChange:s[9]||(s[9]=a=>e.handleFileUpload(a)),type:"file",id:"claim-add-file"+e.cardId},null,40,Be),t("label",{class:"claim-info-add-file-label",for:"claim-add-file"+e.cardId},[t("span",Te,c(e.data.files.length),1)],8,Re)])])]),t("div",Pe,[(o(!0),i(b,null,I(e.data.files,(a,_)=>(o(),i("div",{class:"claim-doc-elem",key:_},[t("div",{class:"claim-doc-elem-file",onClick:Ye=>e.delFile(_)},null,8,je),t("div",Ge,c(a.name),1)]))),128))])])])}var qe=S(ge,[["render",He]]);const We=O({components:{TopNav:T,Preloader:P,PreloaderLocal:w,ClaimCard:qe},setup(){const e=L(),s=j(),r=$(!1),u=$(!1);G(()=>{e.getters.isCompanysLoad||e.dispatch(H.GET_COMPANYS),e.getters.isOrders?e.getters.getClaimNew.length==0&&(r.value=!0,e.dispatch(A.ADD_CLAIMS_NEW,e.getters.getOrdersMaxId).then(()=>{r.value=!1})):(r.value=!0,e.dispatch(q.GET_ORDERS).then(()=>{e.getters.getClaimNew.length==0?e.dispatch(A.ADD_CLAIMS_NEW,e.getters.getOrdersMaxId).then(()=>{r.value=!1}):r.value=!1})),e.commit(y.CLEAR_CLAIMS_SUCCESS)});const v=()=>{u.value=!0,e.dispatch(y.ADD_CLAIMS_NEW,e.getters.getOrdersMaxId).then(()=>{u.value=!1})},g=d=>{e.commit(y.DEL_CLAIMS_NEW,d)},m=async()=>{r.value=!0,await e.getters.getClaimNew.forEach(d=>{let n=new FormData;d.files.forEach((l,p)=>{n.append("files["+p+"]",l)}),n.append("title",d.title),n.append("partner_name",d.partner_name),n.append("partner_guid",d.partner_guid),n.append("id",d.id.toString()),n.append("case",d.case.toString()),n.append("products",JSON.stringify(d.products)),n.append("message",d.message),e.dispatch(A.ADD_CLAIMS,n),s.push({name:"ClaimsSuccess"})}),r.value=!1};return{loading:r,loading_claim:u,calim_new:C(()=>e.getters.getClaimNew),add:v,del:g,send:m}}}),Je={class:"claim-bottom"};function ze(e,s,r,u,v,g){const m=f("top-nav"),d=f("ClaimCard"),n=f("preloader-local"),l=f("preloader");return o(),i("div",null,[V(m),t("div",null,[(o(!0),i(b,null,I(e.calim_new,(p,a)=>(o(),D(d,{key:a,modelValue:e.calim_new[a],"onUpdate:modelValue":_=>e.calim_new[a]=_,cardId:a,onClose:_=>e.del(a)},null,8,["modelValue","onUpdate:modelValue","cardId","onClose"]))),128))]),t("div",Je,[e.loading_claim?(o(),D(n,{key:0})):(o(),i("div",{key:1,class:"claim-add-basis",onClick:s[0]||(s[0]=(...p)=>e.add&&e.add(...p))},"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C")),t("div",{class:"gradient-btn claim-submit",onClick:s[1]||(s[1]=p=>e.send())},[...s[2]||(s[2]=[t("div",{class:"gradient-btn-text"},"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044E",-1)])])]),e.loading?(o(),D(l,{key:0})):h("",!0)])}var Qe=S(We,[["render",ze]]);export{Qe as default};
