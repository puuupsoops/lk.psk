import{f as H,a as R,u as U,g as r,ao as q,D as G,h as P,_ as O,aK as S,aL as K,a4 as L,r as w,o as u,c as o,b as s,t as $,aG as Z,aH as Y,d as z,j as v,k as M,y as b,F as j,e as F,m as D,w as J,L as Q,q as W,B as X,i as x,p as ee}from"./index.09a56ea9.js";import{N as te}from"./Notification.b98f3bf7.js";import{_ as se}from"./CompanyBarTop.a3a46566.js";const ae=H({name:"ShipmentAddressInput",props:{modelValue:{type:String,required:!0},label:{type:String,required:!0},edit:{type:Number,default:-1},show:{type:Boolean,default:!1}},emits:["update:modelValue","update:label","update:show","update:edit","save"],components:{PreloaderLocal:R},setup(e,{emit:t}){const i=U(),p=r(""),c=r(!1),k=r(),m=r(null),h=r(null),l=r(null),n=r(-1),d=r(null),y=r(!0),a=r(1),g=f=>{[13,16,17,18,27,37,38,39,40].includes(f.keyCode)?(f.keyCode==40&&n.value<i.getters.getAddressPrompt.length-1&&(n.value=n.value+1,d.value=Object.assign({},i.getters.getAddressPrompt[n.value]),p.value=i.getters.getAddressPrompt[n.value].value+" "),f.keyCode==38&&n.value!=-1&&(n.value=n.value-1,d.value=Object.assign({},i.getters.getAddressPrompt[n.value]),p.value=i.getters.getAddressPrompt[n.value].value+" "),f.keyCode==27&&close()):(n.value=-1,clearTimeout(k.value),c.value=!0,k.value=setTimeout(()=>{i.dispatch(S.ADDRESS_PROMPT,p.value).then(()=>{setTimeout(()=>{c.value=!1},100)})},500))},A=()=>{p.value="",t("update:edit",-1),t("update:modelValue",""),t("update:label",""),t("update:show",!1)};q(m,()=>{y.value==!1,t("update:show",!1)}),G(()=>e.show,()=>{p.value=e.modelValue,a.value=1,i.commit(K.CLEAR_ADDRESS_PROMPT),c.value=!0,i.dispatch(S.ADDRESS_PROMPT,p.value).then(()=>{setTimeout(()=>{c.value=!1},100)}),L(()=>{h.value.focus()})});const C=()=>{a.value=2,L(()=>{l.value.focus()})},E=()=>{var f,V,B,T,N,I;if(e.edit==-1){const _=[{label:e.label,address:d.value!=-1?(f=d.value)==null?void 0:f.value:"",latitude:d.value!=-1?(V=d.value)==null?void 0:V.data.geo_lat:"",longitude:d.value!=-1?(B=d.value)==null?void 0:B.data.geo_lon:""}];i.dispatch(S.ADD_SHIPMENTS_ADDRESS,_)}else{const _=[{index:e.edit,label:e.label,address:d.value!=-1?(T=d.value)==null?void 0:T.value:"",latitude:d.value!=-1?(N=d.value)==null?void 0:N.data.geo_lat:"",longitude:d.value!=-1?(I=d.value)==null?void 0:I.data.geo_lon:""}];i.dispatch(S.UPDATE_SHIPMENTS_ADDRESS,_)}t("update:modelValue",""),A()};return{search_str:p,loading:c,target:m,searchInput:h,labelInput:l,active_item:n,active_elem:d,options:y,step:a,addressPrompt:P(()=>i.getters.getAddressPrompt),doSearch:g,clear:A,save:E,nextStep:C}}}),ue={class:"product-search-input-container"},de={class:"product-search-input-notice"},oe={key:0},le={class:"product-search-input options"},re=["placeholder"],ne={key:0},ie={key:1},pe={class:"name"},he={key:0},ve={key:1},ce={class:"product-search-input options"},me=["value"];function Ae(e,t,i,p,c,k){const m=w("PreloaderLocal"),h=w("router-link");return u(),o("div",{class:b("product-search fullwidth"+(e.show?" show":"")),ref:"target"},[s("div",ue,[s("div",de,$(e.step==1?"1 \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441":"2 \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),1),e.step==1?(u(),o("div",oe,[s("div",le,[Z(s("input",{type:"text",placeholder:e.step==1?"\u041F\u043E\u0438\u0441\u043A":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",autocomplete:"off",onKeyup:t[0]||(t[0]=l=>e.doSearch(l)),"onUpdate:modelValue":t[1]||(t[1]=l=>e.search_str=l),ref:"searchInput"},null,40,re),[[Y,e.search_str]]),e.loading?(u(),z(m,{key:0,small:""})):v("",!0),e.search_str.length>10?(u(),o("div",{key:1,class:"product-search-save",title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:t[2]||(t[2]=l=>e.nextStep())},[...t[7]||(t[7]=[M('<svg width="16" height="16" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 3.5C1 2.39543 1.89543 1.5 3 1.5H16C19.866 1.5 23 4.63401 23 8.5V21.5C23 22.6046 22.1046 23.5 21 23.5H3C1.89543 23.5 1 22.6046 1 21.5V3.5Z" stroke="#A5A7A9" stroke-width="2"></path><rect x="4" y="13.5" width="2" height="10" rx="1" fill="#A5A7A9"></rect><rect x="18" y="13.5" width="2" height="10" rx="1" fill="#A5A7A9"></rect><rect x="4" y="15.5" width="2" height="16" rx="1" transform="rotate(-90 4 15.5)" fill="#A5A7A9"></rect><rect x="6" y="9.5" width="2" height="12" rx="1" transform="rotate(-90 6 9.5)" fill="#A5A7A9"></rect><rect x="8" y="9.5" width="2" height="8" rx="1" transform="rotate(180 8 9.5)" fill="#A5A7A9"></rect><rect x="18" y="9.5" width="2" height="8" rx="1" transform="rotate(180 18 9.5)" fill="#A5A7A9"></rect><rect x="15" y="6.5" width="2" height="3" rx="1" transform="rotate(-180 15 6.5)" fill="#A5A7A9"></rect></svg>',1)])])):v("",!0),s("div",{class:"product-search-clear",title:"\u041E\u0442\u043C\u0435\u043D\u0430",onClick:t[3]||(t[3]=l=>e.search_str!=""?e.search_str="":e.clear())})]),s("div",{class:b("product-search-input-options"+(e.search_str==""||e.addressPrompt.length==0?" default":""))},[e.search_str==""?(u(),o("span",ne,$(e.edit==-1?"\u0427\u0442\u043E\u0431\u044B \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u0430\u0434\u0440\u0435\u0441 - \u043D\u0430\u0447\u043D\u0438\u0442\u0435 \u0432\u0432\u043E\u0434":"\u0427\u0442\u043E\u0431\u044B \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0430\u0434\u0440\u0435\u0441 - \u043D\u0430\u0447\u043D\u0438\u0442\u0435 \u0432\u0432\u043E\u0434"),1)):(u(),o("div",ie,[(u(!0),o(j,null,F(e.addressPrompt,(l,n)=>(u(),o("p",{key:n,class:b("product-search-input-options-item"+(e.loading?" loading":"")+(n==e.active_item?" active":""))},[D(h,{tag:"a",onClick:d=>{e.search_str=l.value+" ",e.active_elem=Object.assign({},l),e.searchInput.focus()},to:"#"},{default:J(()=>[s("div",pe,$(l.value),1)]),_:2},1032,["onClick"])],2))),128)),e.addressPrompt.length==0?(u(),o("span",he,"\u041D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E")):v("",!0)]))],2)])):(u(),o("div",ve,[s("div",ce,[s("input",{type:"text",placeholder:"\u041F\u043E\u0438\u0441\u043A",autocomplete:"off",onInput:t[4]||(t[4]=l=>e.$emit("update:label",l.target.value)),ref:"labelInput",value:e.label},null,40,me),e.label.length>3?(u(),o("div",{key:0,class:"product-search-save",title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:t[5]||(t[5]=l=>{e.save()})},[...t[8]||(t[8]=[M('<svg width="16" height="16" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 3.5C1 2.39543 1.89543 1.5 3 1.5H16C19.866 1.5 23 4.63401 23 8.5V21.5C23 22.6046 22.1046 23.5 21 23.5H3C1.89543 23.5 1 22.6046 1 21.5V3.5Z" stroke="#A5A7A9" stroke-width="2"></path><rect x="4" y="13.5" width="2" height="10" rx="1" fill="#A5A7A9"></rect><rect x="18" y="13.5" width="2" height="10" rx="1" fill="#A5A7A9"></rect><rect x="4" y="15.5" width="2" height="16" rx="1" transform="rotate(-90 4 15.5)" fill="#A5A7A9"></rect><rect x="6" y="9.5" width="2" height="12" rx="1" transform="rotate(-90 6 9.5)" fill="#A5A7A9"></rect><rect x="8" y="9.5" width="2" height="8" rx="1" transform="rotate(180 8 9.5)" fill="#A5A7A9"></rect><rect x="18" y="9.5" width="2" height="8" rx="1" transform="rotate(180 18 9.5)" fill="#A5A7A9"></rect><rect x="15" y="6.5" width="2" height="3" rx="1" transform="rotate(-180 15 6.5)" fill="#A5A7A9"></rect></svg>',1)])])):v("",!0),s("div",{class:"product-search-clear",title:"\u041E\u0442\u043C\u0435\u043D\u0430",onClick:t[6]||(t[6]=l=>e.search_str!=""?e.search_str="":e.clear())})])]))])],2)}var fe=O(ae,[["render",Ae]]);const ge=H({name:"ShipmentAdresss",components:{TopNav:Q,PersonalBar:W,Notification:te,CompanyBarTop:se,ShipmentAddressInputAdd:fe,PreloaderLocal:R},setup(){const e=U(),t=r(""),i=X(),p=r(0),c=r(""),k=r(""),m=r(!1),h=r(!1),l=r(-1),n=r(!1),d=r(!1),y=P(()=>{let C={lat:"55.760077",lon:"37.617677"};const E=e.getters.getShipmentsAddress.find(f=>f.index==p.value);return E&&(C.lat=E.latitude,C.lon=E.longitude),C}),a=r([54,39]),g=C=>{h.value=!0,e.dispatch(S.DEL_SHIPMENTS_ADDRESS,C).then(()=>{h.value=!1,m.value=!1})};x(()=>{d.value=!0,e.dispatch(S.GET_SHIPMENTS_ADDRESS).then(()=>{setTimeout(()=>{d.value=!1},1e3)}),e.getters.isCompanysLoad||e.dispatch(ee.GET_COMPANYS)});const A=()=>{i.go(-1)};return{activeCompanyUid:t,currentAddr:p,addrName:c,addrLabel:k,delAddr:m,delPreloader:h,editAddrId:l,showAddr:n,loading:d,coords:a,companyBarTopData:P(()=>e.getters.getCompanysList),address:P(()=>e.getters.getShipmentsAddress),latlon:y,back:A,del:g}}}),we={class:"maxhigth"},ye={class:"top-line product-page"},Ce={class:"shipment-heading"},De={class:"shipment-heading-elem"},ke={class:"shipment-address"},Se={class:"shipment-address-list-wrap"},$e={class:"shipment-address-list"},Ee={class:"shipment-address-list-row"},be={key:0,class:"shipment-address-list-row"},Pe=["onClick"],_e={class:"shipment-address-list-elem"},Ve={class:"shipment-address-list-elem"},Be={class:"shipment-address-list-elem"},Te={key:0,class:"shipment-address-list-elem actions",style:{"margin-left":"auto"}},Ne=["onClick"],Ie={key:0,class:"shipment-address-list-row-info"},Le={key:0},Me={key:1},He={key:2,class:"shipment-address-list-row"},Re=["src"];function Ue(e,t,i,p,c,k){const m=w("CompanyBarTop"),h=w("Notification"),l=w("PersonalBar"),n=w("top-nav"),d=w("ShipmentAddressInputAdd"),y=w("preloader-local");return u(),o("div",we,[s("div",ye,[D(m,{data:e.companyBarTopData,modelValue:e.activeCompanyUid,"onUpdate:modelValue":t[0]||(t[0]=a=>e.activeCompanyUid=a)},null,8,["data","modelValue"]),D(h),D(l)]),D(n,{address:"",onOnClick:t[1]||(t[1]=a=>{e.editAddrName=-1,e.addrName="",e.addrLabel="",e.showAddr=!0})}),s("div",Ce,[s("div",De,[s("div",{onClick:t[2]||(t[2]=(...a)=>e.back&&e.back(...a)),class:"shipment-heading-back-btn"}),t[10]||(t[10]=s("div",{class:"shipment-heading-info"},[s("div",{class:"shipment-title"},[s("span",null,"\u0410\u0434\u0440\u0435\u0441\u0430 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438")])],-1))])]),s("div",ke,[s("div",Se,[s("div",$e,[t[14]||(t[14]=s("div",{class:"shipment-address-list-row heading"},[s("div",{class:"shipment-address-list-elem"},"\u2116"),s("div",{class:"shipment-address-list-elem"},"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),s("div",{class:"shipment-address-list-elem"},"\u0410\u0434\u0440\u0435\u0441")],-1)),s("div",Ee,[D(d,{modelValue:e.addrName,"onUpdate:modelValue":t[3]||(t[3]=a=>e.addrName=a),label:e.addrLabel,"onUpdate:label":t[4]||(t[4]=a=>e.addrLabel=a),show:e.showAddr,"onUpdate:show":t[5]||(t[5]=a=>e.showAddr=a),edit:e.editAddrId,"onUpdate:edit":t[6]||(t[6]=a=>e.editAddrId=a)},null,8,["modelValue","label","show","edit"])]),e.loading?(u(),o("div",be,[D(y,{class:"shipment-address-list-row-info"})])):(u(!0),o(j,{key:1},F(e.address,(a,g)=>(u(),o("div",{key:g},[s("div",{class:b("shipment-address-list-row "+(a.index==e.currentAddr?" active":"")),onClick:A=>{e.currentAddr=a.index}},[s("div",_e,$(g+1),1),s("div",Ve,$(a.label),1),s("div",Be,$(a.address),1),g==e.currentAddr?(u(),o("div",Te,[s("div",{onClick:A=>{e.editAddrId=a.index,e.addrName=a.address,e.addrLabel=a.label,e.showAddr=!0}},[...t[11]||(t[11]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",height:"30px",viewBox:"0 0 24 24",width:"30px",fill:"#8D8D8D"},[s("path",{d:"M0 0h24v24H0V0z",fill:"none"}),s("path",{d:"M14.06 9.02l.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"})],-1)])],8,Ne)])):v("",!0),g==e.currentAddr?(u(),o("div",{key:1,class:b("shipment-address-list-elem actions"+(e.delAddr?" active":""))},[s("div",{onClick:t[7]||(t[7]=A=>e.delAddr=!e.delAddr)},[...t[12]||(t[12]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",height:"30px",viewBox:"0 0 24 24",width:"30px",fill:"#8D8D8D"},[s("path",{d:"M0 0h24v24H0V0z",fill:"none"}),s("path",{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"})],-1)])])],2)):v("",!0)],10,Pe),e.delAddr&&a.index==e.currentAddr?(u(),o("div",Ie,[e.delPreloader?v("",!0):(u(),o("div",Le,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0434\u0440\u0435\u0441?")),e.delPreloader?(u(),z(y,{key:2})):(u(),o("div",Me,[s("a",{href:"#",onClick:t[8]||(t[8]=A=>e.del(e.currentAddr))},"\u0414\u0430"),s("a",{href:"#",onClick:t[9]||(t[9]=A=>e.delAddr=0)},"\u041D\u0435\u0442")]))])):v("",!0)]))),128)),e.address.length==0?(u(),o("div",He,[...t[13]||(t[13]=[s("div",{class:"shipment-address-list-nores"},"\u0410\u0434\u0440\u0435\u0441\u0430 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u043E\u0442\u0441\u0443\u0442\u0441\u0432\u0443\u044E\u0442",-1)])])):v("",!0)])]),e.address.length!=0?(u(),o("iframe",{key:0,class:"shipment-address-map",src:"https://yandex.ru/map-widget/v1/?mode=whatshere&whatshere%5Bpoint%5D="+e.latlon.lon+"%2C"+e.latlon.lat+"&z=15",width:"800",height:"600",frameborder:"0"},null,8,Re)):v("",!0)])])}var Fe=O(ge,[["render",Ue],["__scopeId","data-v-5686c91e"]]);export{Fe as default};
