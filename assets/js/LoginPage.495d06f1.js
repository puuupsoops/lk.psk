import{d as L,h,j as l,i as V,b as _,u as s,a,p as r,w as y,k,a0 as S,ai as R,g as T,R as z,b3 as F,a1 as B,b4 as c,s as x,P as D,b5 as M,I as U,o as E,az as P,aQ as N}from"./index.cd7313a8.js";import{d as f,F as O,a as v,E as q}from"./vee-validate.esm.1bb9f776.js";var G="/assets/img/logo.a8cca4dc.png";const H={key:0,class:"authorization"},I={class:"authorization-body"},W=a("div",{class:"authorization-logo"},[a("img",{src:G,alt:"\u043B\u043E\u0433\u043E\u0442\u0438\u043F"})],-1),$={class:"authorization-check"},j=a("span",{class:"checkbox-custom"},null,-1),K=a("span",{class:"check-txt"},"\u0417\u0430\u043F\u043E\u043C\u043D\u0438\u0442\u044C \u043C\u0435\u043D\u044F",-1),Q=["disabled"],Y=a("div",{class:"authorization-bottom"}," Produced by Expert Workwear ",-1),ee=L({__name:"LoginPage",setup(J){const e=T(),b=z(),p=F(),n=h({login:"",password:""}),d=h(!1),i=l({get:()=>e.getters.getLoader,set:t=>e.commit(B.SET_LOADER,t)}),A=l(()=>e.getters.isAuthenticated),w=l(()=>e.getters.getLoginErrorMsg);f("required",t=>!t||!t.length?"\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435":!0),f("minLength",(t,[u])=>!t||!t.length?!0:t.length<u?`\u041C\u0438\u043D\u0438\u043C\u0443\u043C ${u} \u0441\u0438\u043C\u0432\u043E\u043B\u0430`:!0);const m=l({get:()=>e.getters.getLoginError,set:()=>e.commit(c.CLEAR_LOGIN_ERROR)}),g=async t=>{t?(i.value=!0,e.commit(c.SET_SAVE_AUTH),e.commit(c.SET_AUTH,t)):d.value&&e.commit(c.SET_SAVE_AUTH),await Promise.all([e.dispatch(x.GET_COMPANYS),e.dispatch(D.GET_PROFILE)]),i.value=!1,await e.dispatch(M.AUTH_WS),await b.push("/")},C=()=>{i.value=!0,e.dispatch(U.LOGIN,n.value).finally(async()=>{await g()}).catch(()=>{n.value.password="",setTimeout(()=>{i.value=!1},3e3)})};return V(async()=>{!p.query.token||await g(String(p.query.token))}),(t,u)=>(E(),_("div",null,[s(A)?k("",!0):(E(),_("div",H,[a("div",I,[W,r(s(O),{onSubmit:C,class:"authorization-form"},{default:y(()=>[r(s(v),{as:"input",modelValue:n.value.login,"onUpdate:modelValue":u[0]||(u[0]=o=>n.value.login=o),class:"authorization-input",name:"Login",placeholder:"\u041B\u043E\u0433\u0438\u043D",autocomplete:"off",rules:"required|minLength:3"},null,8,["modelValue"]),r(s(q),{name:"Login"}),r(s(v),{as:"input",type:"password",modelValue:n.value.password,"onUpdate:modelValue":u[1]||(u[1]=o=>n.value.password=o),class:"authorization-input",name:"password",placeholder:"\u041F\u0430\u0440\u043E\u043B\u044C",autocomplete:"off",rules:"required|minLength:3"},null,8,["modelValue"]),a("label",$,[P(a("input",{"onUpdate:modelValue":u[2]||(u[2]=o=>d.value=o),class:"check-input",type:"checkbox",name:"remember"},null,512),[[N,d.value]]),j,K]),a("button",{class:"authorization-btn",type:"submit",disabled:s(i)},"\u0412\u043E\u0439\u0442\u0438",8,Q)]),_:1})]),Y])),r(R,{modelValue:s(m),"onUpdate:modelValue":u[3]||(u[3]=o=>S(m)?m.value=o:null),message:s(w)},null,8,["modelValue","message"])]))}});export{ee as default};
