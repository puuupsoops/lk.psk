import{d as $e,g as Ae,R as Ne,h as f,B as we,D as ye,j as ee,L as F,aF as qe,i as ke,S as ze,r as je,o as a,b as r,a as u,p as b,u as n,U as y,t as g,z as c,F as le,f as ae,aq as Ke,m as k,k as o,aG as Ge,aH as Je,n as We,ay as R,w as Ce,c as Q,e as X,aI as N,aJ as Ze,aj as be,a0 as Ye,aK as He,ar as Ee,aB as Qe,aL as Xe,aM as et,an as tt,l as st,s as ut,as as oe}from"./index.b711e212.js";import{N as lt}from"./Notification.19c27409.js";import{_ as at}from"./PersonalBar.cf198963.js";import{O as ne,a as x,_ as it}from"./types.f3216ccc.js";import{_ as rt}from"./CatalogPagination.04d08e51.js";import{_ as ot}from"./TopNav.05647a91.js";import"./CompanyCalendar.vue_vue_type_style_index_0_lang.7cd40dd9.js";import{_ as nt}from"./CompanyBarTop.e983104e.js";/* empty css                                                          */import"./vee-validate.esm.565f1977.js";import"./object.53a79eeb.js";const dt={class:"orders-heading-info"},vt={class:"orders-heading-pagination"},ct=u("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"},[u("path",{fill:"#A5A7A9",d:"m9.8 21.3-.375-3q-.175-.025-.625-.275T7.775 17.4l-2.75 1.15-2.2-3.825 2.4-1.825q-.05-.2-.062-.413-.013-.212-.013-.487 0-.175.025-.413.025-.237.05-.537l-2.4-1.8 2.2-3.8L7.8 6.625q.35-.275.762-.525.413-.25.863-.4L9.8 2.675h4.4l.375 3q.475.175.838.4.362.225.737.55l2.825-1.175 2.2 3.8-2.5 1.875q.05.25.063.437.012.188.012.438 0 .225-.012.438-.013.212-.063.462l2.475 1.825-2.225 3.825-2.775-1.175q-.325.275-.7.5-.375.225-.875.425l-.375 3Zm2.175-6.4q1.2 0 2.038-.85.837-.85.837-2.05 0-1.2-.837-2.05-.838-.85-2.038-.85-1.225 0-2.062.85-.838.85-.838 2.05 0 1.2.838 2.05.837.85 2.062.85Zm0-1.4q-.625 0-1.062-.438-.438-.437-.438-1.062t.438-1.062q.437-.438 1.062-.438.6 0 1.05.438.45.437.45 1.062t-.45 1.062q-.45.438-1.05.438ZM12 11.975ZM11 19.9h1.95l.375-2.7q.75-.2 1.35-.55.6-.35 1.175-.925l2.5 1.075.975-1.7-2.2-1.625q.125-.4.163-.75.037-.35.037-.725t-.037-.713q-.038-.337-.163-.737l2.2-1.675-.95-1.675-2.55 1.075q-.45-.5-1.15-.913-.7-.412-1.375-.587l-.3-2.7h-1.975l-.325 2.7q-.8.2-1.4.525-.6.325-1.2.95L5.625 7.2 4.65 8.875l2.15 1.6q-.125.375-.175.75-.05.375-.05.775 0 .375.038.738.037.362.162.762L4.65 15.1l.975 1.7 2.45-1.05q.6.575 1.225.938.625.362 1.375.537Z"})],-1),mt=[ct],ft=["onClick"],ht=u("svg",{width:"18",height:"19",viewBox:"0 0 18 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("rect",{x:"0.250031",y:"2.07935",width:"2.25351",height:"22.5351",rx:"1.12676",transform:"rotate(-45 0.250031 2.07935)",fill:"#A5A7A9"}),u("rect",{width:"2.25351",height:"22.5351",rx:"1.12676",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 17.5282 2.07935)",fill:"#A5A7A9"})],-1),_t=u("span",null,"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",-1),pt=[ht,_t],gt={class:"orders-list"},wt=u("svg",{width:"13",height:"9",viewBox:"0 0 13 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("path",{class:"fill",d:"M7.00726 8.11117L12.7923 2.32601C12.9262 2.1922 13 2.01359 13 1.82313C13 1.63268 12.9262 1.45406 12.7923 1.32026L12.3664 0.894224C12.0888 0.616998 11.6378 0.616998 11.3606 0.894224L6.5027 5.75217L1.63936 0.888833C1.50545 0.755029 1.32694 0.681152 1.13659 0.681152C0.946033 0.681152 0.767522 0.755029 0.633507 0.888833L0.207681 1.31487C0.0737714 1.44878 -4.1357e-08 1.62729 -4.9682e-08 1.81774C-5.8007e-08 2.0082 0.0737714 2.18681 0.207681 2.32062L5.99802 8.11117C6.13236 8.24529 6.31171 8.31896 6.50238 8.31854C6.69378 8.31896 6.87303 8.24529 7.00726 8.11117Z",fill:"#A5A7A9"})],-1),yt=[wt],Ct=u("svg",{width:"12",height:"12",viewBox:"0 0 18 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("rect",{class:"fill",x:"0.250031",y:"2.07935",width:"2.25351",height:"22.5351",rx:"1.12676",transform:"rotate(-45 0.250031 2.07935)",fill:"#A5A7A9"}),u("rect",{class:"fill",width:"2.25351",height:"22.5351",rx:"1.12676",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 17.5282 2.07935)",fill:"#A5A7A9"})],-1),bt=[Ct],Et=u("svg",{width:"13",height:"9",viewBox:"0 0 13 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("path",{class:"fill",d:"M7.00726 8.11117L12.7923 2.32601C12.9262 2.1922 13 2.01359 13 1.82313C13 1.63268 12.9262 1.45406 12.7923 1.32026L12.3664 0.894224C12.0888 0.616998 11.6378 0.616998 11.3606 0.894224L6.5027 5.75217L1.63936 0.888833C1.50545 0.755029 1.32694 0.681152 1.13659 0.681152C0.946033 0.681152 0.767522 0.755029 0.633507 0.888833L0.207681 1.31487C0.0737714 1.44878 -4.1357e-08 1.62729 -4.9682e-08 1.81774C-5.8007e-08 2.0082 0.0737714 2.18681 0.207681 2.32062L5.99802 8.11117C6.13236 8.24529 6.31171 8.31896 6.50238 8.31854C6.69378 8.31896 6.87303 8.24529 7.00726 8.11117Z",fill:"#A5A7A9"})],-1),$t=[Et],At=u("svg",{width:"12",height:"12",viewBox:"0 0 18 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("rect",{class:"fill",x:"0.250031",y:"2.07935",width:"2.25351",height:"22.5351",rx:"1.12676",transform:"rotate(-45 0.250031 2.07935)",fill:"#A5A7A9"}),u("rect",{class:"fill",width:"2.25351",height:"22.5351",rx:"1.12676",transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 17.5282 2.07935)",fill:"#A5A7A9"})],-1),kt=[At],Ot={class:"orders-list-elem-center"},Dt=["onClick"],St=u("div",{class:"table-arrow"},null,-1),xt=["tooltip"],Pt=["onClick"],It=["onClick"],Lt=["onClick"],Tt=["onClick"],Bt=["onClick"],Rt=["onClick"],Ut=k("\u0417\u0430\u044F\u0432\u043A\u0430 \u043D\u0430 \u0442\u0440\u0430\u043D\u0441\u043F\u043E\u0440\u0442"),Mt=["onClick"],Vt={key:0},Ft={class:"orders-list-info-elem"},Nt={class:"orders-list-info-elem",style:{"margin-right":"18%",width:"17%"}},qt={key:0,class:"orders-list-info-about tooltip"},zt=["onClick"],jt=u("span",{class:"tooltiptext"},"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0441\u0447\u0435\u0442",-1),Kt={key:0,class:"orders-list-info-elem orders-list-info-doc-wrap"},Gt={key:1,class:"orders-list-info-elem orders-list-info-doc-wrap",style:{width:"13%"}},Jt=["href"],Wt=["href"],Zt=["href"],Yt=["href"],Ht={class:"orders-list-info-elem",style:{"justify-content":"flex-start","padding-left":"36px"}},Qt=u("div",{class:"orders-list-info-elem"},null,-1),Xt=u("div",{class:"orders-list-info-elem"},null,-1),es=u("div",{class:"orders-list-info-elem"},null,-1),ts=u("div",{class:"orders-list-info-elem"},null,-1),ss={class:"orders-list-info-elem",style:{display:"flex",width:"15%","justify-content":"flex-end"}},us={class:"orders-list-info-elem",style:{display:"flex","flex-direction":"column","justify-content":"flex-end",width:"10%"}},ls={key:0,class:"orders-list-elem-request-bill"},as=["onClick"],is={class:"orders-list-elem-request-bill"},rs=["onClick"],os={key:1,class:"orders-list-info-row"},ns=st('<div class="orders-list-info-elem"></div><div class="orders-list-info-elem"> \u0421\u0447\u0435\u0442 \u043E\u0442\u0441\u0443\u0442\u0432\u0443\u0435\u0442 </div><div class="orders-list-info-elem"></div><div class="orders-list-info-elem"></div><div class="orders-list-info-elem"></div><div class="orders-list-info-elem"></div>',6),ds=[ns],vs={key:0,class:"orders-list-row orders-list-main-row"},cs={class:"order-info"},ms=k(" \u0417\u0430\u043A\u0430\u0437\u043E\u0432 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E. \u0421\u043E\u0437\u0434\u0430\u0439\u0442\u0435 "),fs=k("\u043D\u043E\u0432\u044B\u0439 \u0437\u0430\u043A\u0430\u0437"),hs=k(" \u0438 \u043E\u043D \u043F\u043E\u044F\u0432\u0438\u0442\u0441\u044F \u0432 \u0441\u043F\u0438\u0441\u043A\u0435. "),_s=$e({__name:"OrdersListCard",props:{contrAgent:{type:String},period:{type:String},status:{type:String},loading:{type:Boolean,default:!1},search:{type:Object,required:!0},refresh:{type:Boolean,default:!1}},setup(O){var pe;const _=O,w=Ae(),te=Ne(),E=f(!1),p=f(-1),U=f(-1),D=f(null),P=f(!1),S=f([]),A=f(-1),m=f([{name:"id",value:"",show:!1},{name:"n",value:"",show:!1},{name:"date",value:"",show:!1}]),q=f(!1),C=f(!1),T="http://91.232.12.198:82",v=f({maxItemOnPage:10,currentPage:1}),z=f(-1),Oe=f(we("tempOrderId")),De=f((pe=we("tempKPType"))!=null?pe:"");ye(D,()=>{U.value=-1});let se=ee(()=>w.getters.getOrders);const de=()=>{var l;if(p.value!=-1&&$.value&&Array.isArray($.value[p.value].checks)){let e=(l=$.value[p.value].checks)==null?void 0:l.map(d=>d.doc_status?null:w.dispatch(N.GET_ORDERS_DOCSTATUS,d.guid));if(e){let d="";Promise.all(e).finally(()=>{var t;console.log($.value[p.value].checks),(t=$.value[p.value].checks)==null||t.forEach((h,L)=>{var i,V,j,K,G,J,W,Z,Y,H;console.log(h,L),console.log(),h.n=(j=(V=(i=h.doc_status)==null?void 0:i.NumberSchet)==null?void 0:V.replace(";",""))!=null?j:"",d=d+((J=(G=(K=h.doc_status)==null?void 0:K.NumberUPD)==null?void 0:G.replace(";",""))!=null?J:""),(H=(Y=(Z=(W=$.value[p.value].checks)==null?void 0:W[L+1])==null?void 0:Z.doc_status)==null?void 0:Y.NumberUPD)!=null&&H.length&&(d+="/"),w.commit(Ze.SET_ORDERS_UPD,{order:$.value[p.value],upd:d})})})}}};F(p,()=>{de()}),F(()=>_.status,()=>{v.value.currentPage=1,p.value=-1}),F(()=>_.contrAgent,()=>{v.value.currentPage=1,p.value=-1}),F(()=>_.search,()=>{v.value.currentPage=1,p.value=-1}),F(()=>_.period,()=>{v.value.currentPage=1,p.value=-1}),F(()=>_.refresh,(l,e)=>{e==!0&&l==!1&&de()});const $=ee(()=>{let l=se.value.filter(e=>_.contrAgent==""||e.partner_guid==_.contrAgent);return l=l.filter(e=>Se(e.date)),l=l.filter(e=>xe(e)),l=l.filter(e=>B(e)),m.value[1].value!=""&&(l=l.filter(e=>String(e.n).indexOf(m.value[1].value)!=-1)),m.value[2].value!=""&&(l=l.filter(e=>e.date.indexOf(m.value[2].value)!=-1)),l}),ve=l=>v.value.maxItemOnPage!=-1?l>=(v.value.currentPage-1)*v.value.maxItemOnPage&&l<v.value.currentPage*v.value.maxItemOnPage:!0,B=l=>{if(_.search.search=="")return!0;switch(_.search.id){case 1:return l.name.toUpperCase().indexOf(_.search.search.toUpperCase())!=-1;case 2:return String(l.n).toUpperCase().indexOf(_.search.search.toUpperCase())!=-1;case 3:return l.date.toUpperCase().indexOf(_.search.search.toUpperCase())!=-1;default:return!0}},Se=l=>{var e;if(_.period=="\u0412\u0441\u0435")return!0;{const d=(e=_.period)==null?void 0:e.split(" - ")[0],t=d==null?void 0:d.substring(6,10),h=d==null?void 0:d.substring(3,5);return t==l.substring(6,10)&&h==l.substring(3,5)}},xe=l=>_.status=="\u0412\u0441\u0435"?!0:Array.isArray(l.checks)?l.checks.findIndex(e=>{var t;const d=(t=ne.find(h=>h.name==_.status))==null?void 0:t.id;return d&&d-1==e.status})!=-1:!1,Pe=l=>{S.value.push(l),w.dispatch(be.GET_BILL_FILE_SAVE,l).finally(()=>{S.value=S.value.filter(e=>e!==l)})},Ie=(l,e)=>{const t=w.getters.getCompanyStoragesData(l).find(h=>h.guid==e);return t?t.name.replace(/(^|\s)\S/g,h=>h.toUpperCase()).replace(/(ООО)|(")|(\s)|([а-я])/g,""):"\u0421\u043A\u043B\u0430\u0434"},Le=l=>{w.commit(Ye.SET_CURRENT_ORDER,l),Oe.value=l,De.value=He.ORDER},Te=async l=>{E.value=!0,await w.dispatch(be.GET_ORDER_DETAIL,l),w.commit(Ee.SET_KP_OFFER_POSITION,w.getters.getOrderDetail.position),w.commit(Ee.SET_KP_STEP,2),E.value=!1,await te.push("/kp")},Be=l=>{E.value=!0,w.commit(Qe.CLEAN_ORDER_DETAIL),w.commit(Xe.CLEAR_CLAIMS_NEW),w.dispatch(et.ADD_CLAIMS_NEW,l).then(()=>{E.value=!1,te.push("/claims/request")})},Re=(l,e)=>{if(z.value==-1){z.value=e.id;const d=Object.assign({},{guid:e.guid,id:e.id,n:e.n,organization_id:e.organization_id,status:e.status});w.dispatch(N.GET_ORDERS_BILL_REQUEST,{id:l,check:d}).then(()=>{z.value=-1}).catch(()=>{z.value=-1})}},Ue=l=>{E.value=!0;let e=l.guid;w.dispatch(N.GET_ORDERS_DOWNLOAD_CERTIFICATED,e).then(()=>{E.value=!1})},Me=l=>{var d;E.value=!0;let e=[];(d=l.checks)==null||d.forEach(t=>{e.push(t.guid)}),w.dispatch(N.GET_ORDERS_DOWNLOAD_CERTIFICATED_ALL,e).then(()=>{E.value=!1})},ce=f(),me=f(0),M=f(""),ue=f(!1),fe=f();ye(fe,()=>{ue.value=!1});const ie={id:{name:"\u2116",width:3,unit:"%",min:10,visible:!0,disabled:!0},name:{name:"\u0417\u0430\u043A\u0430\u0437",width:9,unit:"%",min:10,visible:!0,disabled:!1},date:{name:"\u0414\u0430\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F",width:14,unit:"%",min:10,visible:!0,disabled:!1},partner_name:{name:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F",width:12,unit:"%",min:10,visible:!0,disabled:!1},n:{name:"\u0423\u041F\u0414",width:6,unit:"%",min:5,visible:!0,disabled:!1},status:{name:"\u0421\u0442\u0430\u0442\u0443\u0441",width:9,unit:"%",min:10,visible:!0,disabled:!1},delivery_tersm:{name:"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0430",width:9,unit:"%",min:10,visible:!0,disabled:!1},comment:{name:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0438",width:26,unit:"%",min:10,visible:!0,disabled:!1},info:{name:"\u0418\u043D\u0444\u043E",width:8,unit:"%",min:10,visible:!0,disabled:!0}},s=f(qe.cloneDeep(ie)),he=l=>{const e=l.movementX/me.value*100;Object.keys(s.value).reduce((d,t)=>s.value[t].visible?d+s.value[t].width:d,0)+e<100&&s.value[M.value].width+e>s.value[M.value].min&&(s.value[M.value].width=s.value[M.value].width+e)},I=(l,e)=>{M.value=e,document.addEventListener("mousemove",he)},Ve=()=>{document.removeEventListener("mousemove",he),M.value="",re()},Fe=()=>{const l=Object.keys(s.value).reduce((e,d)=>s.value[d].visible?e+s.value[d].width:e,0);l>100&&Object.keys(s.value).forEach(e=>{e!="id"&&(s.value[e].width=s.value[e].width-(l-100)/6)})},_e=()=>{s.value=JSON.parse(JSON.stringify(ie)),re()},re=()=>{Fe(),localStorage.setItem("orders_list_table",JSON.stringify(s.value))};return ke(()=>{ze(()=>{const l=localStorage.getItem("orders_list_table_timestamp");(l==null||parseInt(l)<168373126e4)&&(localStorage.setItem("orders_list_table_timestamp","1683731260000"),_e()),me.value=ce.value.getBoundingClientRect().width;const e=localStorage.getItem("orders_list_table");e&&(s.value=JSON.parse(e)),s.value.comment||(s.value=JSON.parse(JSON.stringify(ie)),localStorage.setItem("orders_list_table",JSON.stringify(s.value)))})}),(l,e)=>{const d=je("router-link");return a(),r("div",{class:"orders-list-wrap",onMouseup:e[24]||(e[24]=t=>Ve())},[u("div",dt,[u("div",vt,[b(rt,{maxPage:v.value.maxItemOnPage!==-1?Math.ceil(n($).length/v.value.maxItemOnPage):1,currentPage:v.value.currentPage,"onUpdate:currentPage":e[0]||(e[0]=t=>v.value.currentPage=t),maxItemOnPage:v.value.maxItemOnPage,"onUpdate:maxItemOnPage":e[1]||(e[1]=t=>v.value.maxItemOnPage=t)},null,8,["maxPage","currentPage","maxItemOnPage"])]),u("div",{class:"orders-heading-info-text",style:y(n($).length!==n(se).length?"visibility: visible":"visibility: hidden")}," \u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E "+g(n($).length)+" \u0438\u0437 "+g(n(se).length),5),u("div",{class:c(["orders-heading-info-settings",{active:ue.value}]),onClick:e[2]||(e[2]=t=>ue.value=!0)},mt,2),u("div",{class:c(["orders-heading-info-settings-dropdown",{active:ue.value}]),ref_key:"tableMenu",ref:fe},[(a(!0),r(le,null,ae(s.value,(t,h)=>(a(),r("a",{class:"orders-list-more-dropdown-link",key:h,onClick:re},[b(Ke,{modelValue:t.visible,"onUpdate:modelValue":L=>t.visible=L,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"]),u("span",{onClick:L=>t.disabled?null:t.visible=!t.visible},g(t.name),9,ft)]))),128)),u("a",{class:"orders-list-more-dropdown-link clear",onClick:e[3]||(e[3]=t=>_e())},pt)],2)]),u("div",gt,[u("div",{class:"orders-list-row orders-list-heading",ref_key:"table",ref:ce},[s.value.id.visible?(a(),r("div",{key:0,class:c(["orders-list-elem",{id:!0}]),style:y(`width: ${s.value.id.width}${s.value.id.unit}`)},[k(g(s.value.id.name)+" ",1),u("div",{class:"orders-list-elem-resize",onMousedown:e[4]||(e[4]=t=>I(t,"id"))},null,32)],4)):o("",!0),s.value.name.visible?(a(),r("div",{key:1,class:c(["orders-list-elem",{name:!0,active:B.search!==""&&B.id===1||m.value[1].value!==""}]),style:y(`width: ${s.value.name.width}${s.value.name.unit}`)},[b(Ge,{modelValue:m.value[1].value,"onUpdate:modelValue":e[5]||(e[5]=t=>m.value[1].value=t),show:m.value[1].show,"onUpdate:show":e[6]||(e[6]=t=>m.value[1].show=t)},null,8,["modelValue","show"]),u("div",null,g(s.value.name.name),1),u("div",{class:c(["orders-list-elem-filter",{active:m.value[1].show||m.value[1].value!==""}]),title:"\u0424\u0438\u043B\u044C\u0442\u0440",onClick:e[7]||(e[7]=t=>m.value[1].show=!0)},yt,2),m.value[1].value!==""?(a(),r("div",{key:0,class:"orders-list-elem-filter active",title:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u0444\u0438\u043B\u044C\u0442\u0440",onClick:e[8]||(e[8]=t=>{m.value[1].value="",p.value=-1})},bt)):o("",!0),u("div",{class:"orders-list-elem-resize",onMousedown:e[9]||(e[9]=t=>I(t,"name"))},null,32)],6)):o("",!0),s.value.date.visible?(a(),r("div",{key:2,class:c(["orders-list-elem",{date:!0,active:B.search!==""&&B.id===3||O.period!=="\u0412\u0441\u0435"||m.value[2].value!==""}]),style:y(`width: ${s.value.date.width}${s.value.date.unit}`)},[b(Je,{modelValue:m.value[2].value,"onUpdate:modelValue":e[10]||(e[10]=t=>m.value[2].value=t),show:m.value[2].show,"onUpdate:show":e[11]||(e[11]=t=>m.value[2].show=t)},null,8,["modelValue","show"]),u("div",null,g(s.value.date.name),1),u("div",{class:c("orders-list-elem-filter"+(m.value[2].show||m.value[2].value!==""?" active":"")),title:"\u0424\u0438\u043B\u044C\u0442\u0440",onClick:e[12]||(e[12]=t=>m.value[2].show=!0)},$t,2),m.value[2].value!==""?(a(),r("div",{key:0,class:"orders-list-elem-filter active",title:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u0444\u0438\u043B\u044C\u0442\u0440",onClick:e[13]||(e[13]=t=>{m.value[2].value="",p.value=-1})},kt)):o("",!0),u("div",{class:"orders-list-elem-resize",onMousedown:e[14]||(e[14]=t=>I(t,"date"))},null,32)],6)):o("",!0),s.value.partner_name.visible?(a(),r("div",{key:3,class:c(["orders-list-elem",{partner_name:!0,active:O.contrAgent!==""}]),style:y(`width: ${s.value.partner_name.width}${s.value.partner_name.unit}`)},[k(g(s.value.partner_name.name)+" ",1),u("div",{class:"orders-list-elem-resize",onMousedown:e[15]||(e[15]=t=>I(t,"partner_name"))},null,32)],6)):o("",!0),s.value.status.visible?(a(),r("div",{key:4,class:c(["orders-list-elem",{status:!0,active:O.status!=="\u0412\u0441\u0435"}]),style:y(`width: ${s.value.status.width}${s.value.status.unit}`)},[k(g(s.value.status.name)+" ",1),u("div",{class:"orders-list-elem-resize",onMousedown:e[16]||(e[16]=t=>I(t,"status"))},null,32)],6)):o("",!0),s.value.delivery_tersm.visible?(a(),r("div",{key:5,class:c(["orders-list-elem",{delivery_tersm:!0,active:O.status!=="\u0412\u0441\u0435"}]),style:y(`width: ${s.value.delivery_tersm.width}${s.value.delivery_tersm.unit}`)},[k(g(s.value.delivery_tersm.name)+" ",1),u("div",{class:"orders-list-elem-resize",onMousedown:e[17]||(e[17]=t=>I(t,"delivery_tersm"))},null,32)],6)):o("",!0),s.value.n.visible?(a(),r("div",{key:6,class:c(["orders-list-elem",{n:!0,active:B.search!==""&&B.id===2}]),style:y(`width: ${s.value.n.width}${s.value.n.unit}`)},[u("div",Ot,g(s.value.n.name),1),u("div",{class:"orders-list-elem-resize",onMousedown:e[18]||(e[18]=t=>I(t,"n"))},null,32)],6)):o("",!0),s.value.comment.visible?(a(),r("div",{key:7,class:c(["orders-list-elem",{comment:!0,active:O.status!=="\u0412\u0441\u0435"}]),style:y(`width: ${s.value.comment.width}${s.value.comment.unit}`)},[k(g(s.value.comment.name)+" ",1),u("div",{class:"orders-list-elem-resize",onMousedown:e[19]||(e[19]=t=>I(t,"comment"))},null,32)],6)):o("",!0),s.value.info.visible?(a(),r("div",{key:8,class:c(["orders-list-elem",{info:!0}]),style:y(`width: ${s.value.info.width}${s.value.info.unit}`)},g(s.value.info.name),5)):o("",!0)],512),(a(!0),r(le,null,ae(n($),(t,h)=>{var L;return a(),r("div",{class:c(["orders-list-item",{active:h===p.value,reserved:t.reserved}]),key:h},[ve(h)?(a(),r("div",{key:0,class:"orders-list-row orders-list-main-row",onClick:i=>h===p.value?p.value=-1:p.value=h},[s.value.id.visible?(a(),r("div",{key:0,class:c(["orders-list-elem",{id:!0}]),style:y(`width: ${s.value.id.width}${s.value.id.unit}`)},[u("div",null,g(h+1),1),St],4)):o("",!0),s.value.name.visible?(a(),r("div",{key:1,class:c(["orders-list-elem",{name:!0}]),style:y(`width: ${s.value.name.width}${s.value.name.unit}`)},g(t.n),5)):o("",!0),s.value.date.visible?(a(),r("div",{key:2,class:c(["orders-list-elem",{date:!0}]),style:y(`width: ${s.value.date.width}${s.value.date.unit}`)},g(t.date),5)):o("",!0),s.value.partner_name.visible?(a(),r("div",{key:3,class:c(["orders-list-elem",{partner_name:!0}]),style:y(`width: ${s.value.partner_name.width}${s.value.partner_name.unit}`)},g(n(We)(t.partner_name)),5)):o("",!0),s.value.status.visible?(a(),r("div",{key:4,class:c(["orders-list-elem",{status:!0}]),style:y(`width: ${s.value.status.width}${s.value.status.unit}`)},[(a(!0),r(le,null,ae(t.checks,(i,V)=>(a(),r("div",{class:c("orders-list-elem-status "+(i.status>=0&&i.status<n(x).length?n(x)[i.status].class:"")),tooltip:i.status>=0&&i.status<n(x).length?n(x)[i.status].name:"",flow:"up",key:V},null,10,xt))),128))],4)):o("",!0),s.value.delivery_tersm.visible?(a(),r("div",{key:5,class:c(["orders-list-elem",{status:!0}]),style:y(`width: ${s.value.delivery_tersm.width}${s.value.delivery_tersm.unit}`)},g(t.delivery_terms?t.delivery_terms:t.shipment_name),5)):o("",!0),s.value.n.visible?(a(),r("div",{key:6,class:c(["orders-list-elem",{n:!0}]),style:y(`width: ${s.value.n.width}${s.value.n.unit}`)},g(t.upd),5)):o("",!0),s.value.comment.visible?(a(),r("div",{key:7,class:c(["orders-list-elem",{comment:!0}]),style:y(`width: ${s.value.comment.width}${s.value.comment.unit}`)},g(t.comment==""?"":t.comment.replace(new RegExp("PKM [0-9]+.[0-9]+, "),"")),5)):o("",!0),s.value.info.visible?(a(),r("div",{key:8,class:c(["orders-list-elem",{info:!0}]),style:y(`width: ${s.value.info.width}${s.value.info.unit}`)},[u("button",{class:"orders-list-more",onClick:R(i=>U.value=h,["stop"])},"\u041F\u043E\u0434\u0440\u043E\u0431\u043D\u043E",8,Pt),u("div",{class:c("orders-list-more-dropdown"+(h===U.value?" active":"")),ref_for:!0,ref_key:"target",ref:D},[u("a",{class:"orders-list-more-dropdown-link",onClick:R(i=>{A.value=t.n,P.value=!0},["stop"])},"\u0414\u0435\u0442\u0430\u043B\u0438 \u0437\u0430\u043A\u0430\u0437\u0430",8,It),u("a",{class:"orders-list-more-dropdown-link",onClick:R(i=>{A.value=t.n,P.value=!0,C.value=!1,q.value=!0},["stop"])},"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437",8,Lt),t.reserved?(a(),r("a",{key:0,class:"orders-list-more-dropdown-link",onClick:R(i=>{A.value=t.n,P.value=!0,C.value=!0,q.value=!1},["stop"])},"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437",8,Tt)):o("",!0),u("a",{class:"orders-list-more-dropdown-link",onClick:R(i=>Me(t),["stop"])},"\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u044B \u043F\u043E \u0437\u0430\u043A\u0430\u0437\u0443",8,Bt),t.checks.filter(i=>i.status===5||i.status===9)&&((L=t.checks)==null?void 0:L.filter(i=>i.status===5||i.status===9).length)>0?(a(),r("a",{key:1,class:"orders-list-more-dropdown-link",onClick:R(i=>Be(t.n),["stop"])}," \u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044E ",8,Rt)):o("",!0),b(d,{class:"orders-list-more-dropdown-link",to:"/shipments/request",onClick:i=>Le(t.n)},{default:Ce(()=>[Ut]),_:2},1032,["onClick"]),u("a",{class:"orders-list-more-dropdown-link",onClick:R(i=>Te(t.n),["stop"])},"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u041A\u041F",8,Mt)],2)],4)):o("",!0)],8,Dt)):o("",!0),ve(h)?(a(),r("div",{key:1,class:c(["orders-list-info",{active:h===p.value}]),onClick:e[20]||(e[20]=i=>U.value=-1)},[Array.isArray(t.checks)&&t.checks.length>0&&t.status_code!==7&&t.status_code!==9?(a(),r("div",Vt,[(a(!0),r(le,null,ae(t.checks,(i,V)=>{var j,K,G,J,W,Z,Y,H;return a(),r("div",{class:"orders-list-info-row",key:V,style:{"padding-right":"0px"}},[u("div",Ft,g(Ie(t.partner_guid,i.organization_id)),1),u("div",Nt,[(j=i.doc_status)!=null&&j.StatusSchet?(a(),r("div",qt,[u("div",{class:"orders-list-info-download",onClick:ge=>Pe(i.guid)},[u("span",null," \u0421\u0447\u0451\u0442 "+g(i.n)+" \u043E\u0442 "+g(t.date.substring(0,10)),1),S.value.includes(i.guid)?(a(),Q(X,{key:0,small:""})):o("",!0)],8,zt),jt])):o("",!0)]),i.doc_status?(a(),r("div",Gt,[(K=i.doc_status)!=null&&K.StatusSchet?(a(),r("a",{key:0,class:"orders-list-info-doc sc",href:`${n(T)}/api/order/print?id=${i.guid}&name=\u0421\u0447\u0435\u0442`,target:"_blank",title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0441\u0447\u0435\u0442"},null,8,Jt)):o("",!0),(G=i.doc_status)!=null&&G.StatusUPD?(a(),r("a",{key:1,class:"orders-list-info-doc upd",href:`${n(T)}/api/order/print?id=${i.guid}&name=\u0423\u041F\u0414`,target:"_blank",title:"\u0423\u043D\u0438\u0432\u0435\u0440\u0441\u0430\u043B\u044C\u043D\u044B\u0439 \u043F\u0435\u0440\u0435\u0434\u0430\u0442\u043E\u0447\u043D\u044B\u0439 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442"},null,8,Wt)):o("",!0),(J=i.doc_status)!=null&&J.StatusSF?(a(),r("a",{key:2,class:"orders-list-info-doc sf",href:`${n(T)}/api/order/print?id=${i.guid}&name=\u0421\u0424`,target:"_blank",title:"\u0421\u0447\u0451\u0442-\u0444\u0430\u043A\u0442\u0443\u0440\u0430"},null,8,Zt)):o("",!0),(W=i.doc_status)!=null&&W.StatusUPK?(a(),r("a",{key:3,class:"orders-list-info-doc kor",href:`${n(T)}/api/order/print?id=${i.guid}&name=\u0423\u041A\u0414`,target:"_blank",title:"\u0423\u043D\u0438\u0432\u0435\u0440\u0441\u0430\u043B\u044C\u043D\u044B\u0439 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043E\u0447\u043D\u044B\u0439 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442"},null,8,Yt)):o("",!0)])):(a(),r("div",Kt,[b(X,{small:""})])),u("div",Ht,g((H=(Y=(Z=i.doc_status)==null?void 0:Z.NumberUPD)==null?void 0:Y.replace(";",""))!=null?H:""),1),Qt,Xt,es,ts,u("div",ss,[k(g(n(x)[i.status]?n(x)[i.status].name:"")+" ",1),n(x)[i.status]?(a(),r("div",{key:0,class:c("orders-list-elem-status small "+(i.status>=0&&i.status<n(x).length?n(x)[i.status].class:"")),flow:"up"},null,2)):o("",!0)]),u("div",us,[i.status!==10?(a(),r("div",ls,[z.value===i.id?(a(),Q(X,{key:0,small:""})):(a(),r("span",{key:1,onClick:ge=>Re(t.n,i)},"\u0417\u0430\u043F\u0440\u043E\u0441\u0438\u0442\u044C \u0441\u0447\u0435\u0442",8,as))])):o("",!0),u("div",is,[u("span",{onClick:ge=>Ue(i)},"\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u044B",8,rs)])])])}),128))])):(a(),r("div",os,ds))],2)):o("",!0)],2)}),128)),n(se).length===0&&!O.loading?(a(),r("div",vs,[u("div",cs,[ms,b(d,{class:"order-info-link",to:"/order"},{default:Ce(()=>[fs]),_:1}),hs])])):o("",!0)]),O.loading?(a(),Q(X,{key:0,style:{width:"100%"}})):o("",!0),E.value?(a(),Q(tt,{key:1})):o("",!0),b(it,{modelValue:P.value,"onUpdate:modelValue":e[21]||(e[21]=t=>P.value=t),orderId:A.value,repeatOrder:q.value,"onUpdate:repeatOrder":e[22]||(e[22]=t=>q.value=t),editOrder:C.value,"onUpdate:editOrder":e[23]||(e[23]=t=>C.value=t)},null,8,["modelValue","orderId","repeatOrder","editOrder"])],32)}}}),ps={class:"top-line product-page"},gs={class:"orders-heading"},ws={class:"orders-heading-elem"},ys={class:"orders-heading-item"},Cs=u("div",{class:"orders-heading-text"},"\u041A\u043E\u043D\u0442\u0440\u0430\u0433\u0435\u043D\u0442:",-1),bs={class:"orders-heading-item"},Es=u("div",{class:"orders-heading-text"},"\u0421\u0442\u0430\u0442\u0443\u0441:",-1),$s={class:"orders-heading-item"},As=u("div",{class:"orders-heading-text"},"\u041F\u0435\u0440\u0438\u043E\u0434:",-1),ks={key:0,class:"orders-heading-elem"},Os={key:1},Vs=$e({__name:"OrdersPage",setup(O){const _=Ae(),w=f(!0),te=f({id:1,search:""}),E=ee(()=>_.getters.getCompanysList),p=f(0),U=ee(()=>_.getters.getCompanyFromOrders()),D=f(""),P=ee(()=>_.getters.getOrdersDataPeriodArray),S=f(0),A=f(!1),m=()=>{A.value==!1&&(A.value=!0,_.dispatch(N.GET_ORDERS).finally(()=>{A.value=!1,w.value=!0,w.value=!1}))};return ke(()=>{_.dispatch(N.GET_ORDERS).finally(()=>{w.value=!1}),_.getters.isCompanysLoad||_.dispatch(ut.GET_COMPANYS).then(()=>{})}),(q,C)=>{var T;return a(),r("div",null,[u("div",ps,[b(n(nt),{data:n(E),modelValue:D.value,"onUpdate:modelValue":C[0]||(C[0]=v=>D.value=v)},null,8,["data","modelValue"]),b(n(lt)),b(n(at))]),b(n(ot),{newOrder:""}),u("div",gs,[u("div",ws,[u("div",ys,[Cs,b(n(oe),{data:n(U),modelValue:D.value,"onUpdate:modelValue":C[1]||(C[1]=v=>D.value=v)},null,8,["data","modelValue"])]),u("div",bs,[Es,b(n(oe),{data:n(ne),modelValue:p.value,"onUpdate:modelValue":C[2]||(C[2]=v=>p.value=v)},null,8,["data","modelValue"])]),u("div",$s,[As,b(n(oe),{data:n(P),modelValue:S.value,"onUpdate:modelValue":C[3]||(C[3]=v=>S.value=v)},null,8,["data","modelValue"])]),u("div",{class:"orders-heading-clean",title:"\u0423\u0431\u0440\u0430\u0442\u044C \u0444\u0438\u043B\u044C\u0442\u0440\u044B",onClick:C[4]||(C[4]=v=>{D.value="",S.value=0,p.value=0})})]),w.value?o("",!0):(a(),r("div",ks,[u("button",{class:"product-search-btn gradient-btn",onClick:C[5]||(C[5]=v=>m())},[A.value?(a(),Q(n(X),{key:0,small:""})):(a(),r("div",Os,"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C"))])]))]),b(n(_s),{loading:w.value,contrAgent:D.value,period:n(P)[S.value].name,status:(T=n(ne).find(v=>v.id===p.value))==null?void 0:T.name,search:te.value,refresh:A.value},null,8,["loading","contrAgent","period","status","search","refresh"])])}}});export{Vs as default};
