import{f as R,u as $,B as L,g as p,h as n,D as f,i as U,p as r,M as v,O as P,o as x,c as B,b as i,m as l,x as C,q as O,P as b,j as I,Q as k}from"./index.09a56ea9.js";import{N as Y}from"./Notification.b98f3bf7.js";import{_ as w,C as j,a as q,b as K}from"./CompanyCalendar.ddcfc559.js";import{_ as Q}from"./CompanyBarTop.a3a46566.js";import"./vee-validate.esm.80362e72.js";import"./object.43a30ddf.js";import"./doc.66697d7d.js";const z={key:0},F={class:"top-line product-page"},H={class:"company-head"},J={class:"company-head-elem"},W={class:"company-head-elem"},X={id:"CompanyCalendar"},Z={class:"company-calendar-wrap"},ue=R({__name:"company",props:["id"],setup(A){const o=A,e=$(),E=L(),g=p(!1),a=p(o.id),t=p(0),M=p(""),y=n(()=>e.getters.getCompanyCurrentDiscount(a.value)),D=n(()=>e.getters.getCompanyData(a.value)),d=n(()=>e.getters.getCompanyStoragesData(a.value)),N=n(()=>e.getters.getCompanysList),S=n(()=>e.getters.getCompanySpent(a.value)),c=n(()=>e.getters.getManagerUid(a.value));n(()=>e.getters.getManager);const T=n(()=>e.getters.getManagers),_=n({get:()=>e.getters.getLoader,set:m=>e.commit(k.SET_LOADER,m)}),V=n(()=>d.value.length===0?null:d.value[t.value?t.value:0].documents);f(()=>o.id,()=>{o.id!==""?a.value=o.id:a.value=e.getters.getCompanys===[]?"":e.getters.getCompanys[0].uid}),f(a,()=>{d.value.length===0?t.value=null:t.value=0,E.push(`/company/${a.value}`),e.commit(v.CLEAR_MANAGER),setTimeout(()=>e.dispatch(r.GET_MANAGER,c.value),1e3),setTimeout(()=>e.dispatch(r.GET_MANAGERS,c.value),1e3)}),U(()=>{e.getters.isCompanysLoad?(o.id!==""?(a.value=o.id,console.log(o.id),e.commit(v.SET_ACTIVE_COMPANY_ID,o.id),e.commit(v.CLEAR_MANAGER),e.dispatch(r.GET_MANAGER,c.value),e.dispatch(r.GET_MANAGERS,c.value)):a.value=e.getters.getCompanys===[]?"":e.getters.getCompanys[0].uid,g.value=!0):(_.value=!0,Promise.all([e.dispatch(r.GET_COMPANYS)]).finally(()=>{setTimeout(()=>{if(e.getters.isCompanysLoad){const m=e.getters.getCompanys.find(s=>s.uid===o.id);a.value=m?m.uid:e.getters.getCompanys[0].uid,e.commit(v.SET_ACTIVE_COMPANY_ID,o.id),g.value=!0,_.value=!1}else _.value=!1},500)}))}),P("docDate",M);const h=()=>{t.value!=null&&t.value<d.value.length-1&&(t.value=t.value+1)},G=()=>{t.value&&t.value>0&&(t.value=t.value-1)};return(m,s)=>g.value?(x(),B("div",z,[i("div",F,[l(Q,{data:N.value,modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=u=>a.value=u)},null,8,["data","modelValue"]),l(C(Y)),l(C(O))]),i("div",H,[i("div",J,[l(w,{data:d.value,modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=u=>t.value=u),onNext:s[2]||(s[2]=u=>h()),onPrev:s[3]||(s[3]=u=>G())},null,8,["data","modelValue"])]),i("div",W,[l(j,{data:D.value},null,8,["data"])])]),l(q,{spent:S.value,modelValue:y.value,"onUpdate:modelValue":s[4]||(s[4]=u=>y.value=u)},null,8,["spent","modelValue"]),i("div",X,[i("div",Z,[l(K,{data:V.value},null,8,["data"]),l(C(b),{managers:T.value},null,8,["managers"])])])])):I("",!0)}});export{ue as default};
