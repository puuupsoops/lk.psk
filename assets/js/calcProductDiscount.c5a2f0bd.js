import{f as B,d as X,i as m,h as $,Y as j,an as V,ao as z,o as r,b as d,a as e,z as D,t as g,e as f,w as G,u as v,F as U,g as w,ap as K,aq as J,T as W,l as y,v as Y,x as Q,y as Z,p as q,ar as N,k as H,R as ee,j as te,L as ue,W as oe,as as ne,at as F}from"./index.89ee5dc6.js";import{a as se}from"./ProductSliderCard.e0822f37.js";const ae=n=>(Q("data-v-e8dcecf8"),n=n(),Z(),n),le={class:"product-info product-info-tab content-elem"},ce={class:"content-elem-heading",style:{"flex-wrap":"wrap"}},ie=ae(()=>e("div",{class:"content-elem-heading-text"},"\u041F\u043E\u0434\u0440\u043E\u0431\u043D\u043E",-1)),re={class:"product-info-tab-nav"},de={key:0,class:"content-hide"},pe=["innerHTML"],ve={class:"table product-info-table scroll-elem"},_e={class:"table-wrap"},me={class:"table-elem"},Ie=["innerHTML"],Ee={class:"table-elem"},he=["innerHTML"],Ce={key:0,style:"text-align: center; display: table; margin: 0 auto 0 auto;"},De=q(" \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430... "),Ae={key:1},be={style:"margin: 0 auto 0 auto; display: table;"},Re={class:"product-slider-wrap"},fe={class:"product-slider-main"},Te=["src"],ke=X({__name:"ProductInfoCard",props:{data:{type:Object},protect:{type:Array}},setup(n){const A=n,p=m("detail"),a=m(!0),l=m([]),E=m(!1),h=m([]),b=m(!1),S=m($().getters.getProduct.ID);j(()=>{S.value!=$().getters.getProduct.ID&&(S.value=$().getters.getProduct.ID,p.value="detail",b.value=!1)});const P=()=>{const R=l.value.shift();l.value=l.value.concat(R)},O=()=>{const R=l.value.pop();l.value=[R].concat(l.value)},k=m("\u0421\u043A\u0430\u0447\u0430\u0442\u044C \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u044B \u0430\u0440\u0445\u0438\u0432\u043E\u043C "),T=m(V.Active),u=z.Download,t=m(!1),o=R=>{var c,_;if(R)return;l.value=[],h.value=[];let i=(_=(c=A.data)==null?void 0:c.UID)!=null?_:"";console.log(i),N.get("/product/"+i+"/certificates").then(C=>{var L;(L=C.data)==null||L.forEach((M,x)=>{l.value.push({id:x,src:M}),h.value.push(M)})}).catch(C=>{console.log("error"),console.log(C)}).finally(function(){b.value=!0})};let s=()=>{var i;T.value=V.InProgress,k.value="\u0410\u0440\u0445\u0438\u0432 \u0441\u043A\u0430\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044F, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435";let R=(i=A.data)==null?void 0:i.UID;N.get("/product/"+R+"/certificates/download",{responseType:"blob",transformRequest:(c,_)=>{_==null||delete _.common}}).then(c=>{const _=window.URL.createObjectURL(new Blob([c.data])),C=document.createElement("a");C.href=_,C.setAttribute("download","cert.zip"),document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(_),t.value=!t.value}).catch(c=>{console.log("error"),console.log(c)}).finally(function(){T.value=V.Active,k.value="\u0421\u043A\u0430\u0447\u0430\u0442\u044C \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u044B \u0430\u0440\u0445\u0438\u0432\u043E\u043C "})};return(R,i)=>(r(),d(U,null,[e("div",le,[e("div",ce,[ie,e("ul",re,[e("li",{class:D(p.value==="detail"?"product-info-tab-link active":"product-info-tab-link"),onClick:i[0]||(i[0]=c=>p.value="detail")},"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",2),e("li",{class:D(p.value==="characteristics"?"product-info-tab-link active":"product-info-tab-link"),onClick:i[1]||(i[1]=c=>p.value="characteristics")},"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430",2),e("li",{class:D(p.value==="certificate"?"product-info-tab-link active":"product-info-tab-link"),onClick:i[2]||(i[2]=c=>{o(b.value),p.value="certificate"})},"\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043A\u0430\u0442",2)]),e("div",{class:"content-elem-heading-btn content-hide-btn product-info-hide-btn",onClick:i[3]||(i[3]=c=>a.value=!a.value)},g(a.value?"\u0421\u043A\u0440\u044B\u0442\u044C \u2014":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C +"),1)]),f(Y,{name:"fade",mode:"out-in"},{default:G(()=>[a.value?(r(),d("div",de,[e("div",{class:D(p.value==="detail"?"product-info-desc product-info-tab-elem active":"product-info-desc product-info-tab-elem")},[f(v(lt),{protect:n.protect},null,8,["protect"]),e("p",null,[e("span",{innerHTML:n.data.DETAIL_TEXT},null,8,pe)])],2),e("div",{class:D(p.value==="characteristics"?"product-info-table-wrap product-info-tab-elem active":"product-info-table-wrap product-info-tab-elem")},[e("div",ve,[e("div",_e,[(r(!0),d(U,null,w(n.data.CHARACTERISTICS,(c,_)=>(r(),d("div",{class:"table-row",key:_},[e("div",me,[e("span",{innerHTML:c.NAME},null,8,Ie)]),e("div",Ee,[e("span",{innerHTML:c.VALUE},null,8,he)])]))),128))])])],2),e("div",{class:D(p.value==="certificate"?"product-info-desc product-info-tab-elem active":"product-info-desc product-info-tab-elem")},[b.value?(r(),d("div",Ae,[e("div",be,[f(v(J),{text:k.value,icon:v(u),state:T.value,onClick:i[4]||(i[4]=c=>v(s)())},null,8,["text","icon","state"])]),e("div",Re,[e("div",fe,[e("button",{class:"product-slider-arrow prev",onClick:O}),f(W,{name:"product-slider-trans",class:"product-slider",tag:"div"},{default:G(()=>[(r(!0),d(U,null,w(l.value,c=>(r(),d("div",{class:"product-slider-slide",key:c.id},[c.src?(r(),d("img",{key:0,src:c.src,alt:"",onClick:i[5]||(i[5]=_=>E.value=!0)},null,8,Te)):y("",!0)]))),128))]),_:1}),e("div",{class:"product-slider-arrow next",onClick:P})])])])):(r(),d("p",Ce,[De,f(v(K))]))],2)])):y("",!0)]),_:1})]),f(v(se),{modelValue:E.value,"onUpdate:modelValue":i[6]||(i[6]=c=>E.value=c),data:h.value},null,8,["modelValue","data"])],64))}});var rt=B(ke,[["__scopeId","data-v-e8dcecf8"]]);const ge={class:"content-elem"},Ue={class:"order-amount-table-wrap scroll-elem"},ye={class:"table order-amount-table"},Se={class:"table-row table-heading",style:{"max-height":"51px"}},$e=e("div",{class:"table-elem"},"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430",-1),we=e("div",{class:"table-elem"},"\u041E\u0441\u0442\u0430\u0442\u043E\u043A",-1),Pe={class:"table-elem"},Oe=q("\u0426\u0435\u043D\u0430"),Ve={key:0,style:{"font-size":"10px"}},Le=e("div",{class:"table-elem"},"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E",-1),Me=e("div",{class:"table-elem"},"\u041F\u043F / \u0414\u0430\u0442\u0430",-1),Ge={class:"table-wrap"},Ne={class:"table-elem"},He=["innerHTML"],Fe={class:"table-elem"},Be=["innerHTML"],Xe={key:0,class:"table-elem"},qe=["innerHTML"],xe={key:1,class:"table-elem"},je=["innerHTML"],ze={class:"table-elem"},Ke={class:"table-elem"},Je={class:"order-amount-more"},We=e("span",{class:"order-amount-more-text"},"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u0437\u0430\u043A\u0430\u0437 ",-1),Ye={class:"order-amount-more-value"},Qe={key:0,class:"order-amount-more-text presail"},Ze={key:1,class:"order-amount-more-value"},et=e("span",{class:"order-amount-more-text"},"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u041A\u041F",-1),tt=[et],dt=X({__name:"ProductOffersOrderCard",props:{data:{type:Array,required:!0},discount:{type:Number},modelValue:{type:Array}},emits:["update:modelValue","onClick"],setup(n,{emit:A}){const p=n,a=m([]),l=H(()=>a.value.filter(u=>u.count>0).length),E=H(()=>a.value.filter(u=>u.count>u.RESIDUE&&u.count!=0).length),h=$(),b=ee(),S=u=>{if(u.check){let t=a.value.find(o=>o.ID==u.ID);t&&(t.count=1)}else{let t=a.value.find(o=>o.ID==u.ID);t&&(t.count=0)}},P=u=>{if(u.count>0){let t=a.value.find(o=>o.ID==u.ID);t&&(t.check=!0)}else{let t=a.value.find(o=>o.ID==u.ID);t&&(t.check=!1)}},O=()=>{if(l.value>0){let u=[];a.value.forEach(s=>{s.count>0&&u.push({ID:s.ID,CHARACTERISTIC:s.CHARACTERISTIC,MAX_DISCOUNT:s.MAX_DISCOUNT,count:s.count,PRICE:s.PRICE,RESIDUE:s.RESIDUE,RESERVED:s.RESERVED,GUID:s.GUID,guid:s.GUID,ORGGUID:s.ORGGUID,price_discount:s.PRICE})}),a.value.forEach(s=>{s.count=0,s.check=!1});let t=h.getters.getProduct,o={product:JSON.parse(JSON.stringify(t)),guid:t.UID,article:t.ARTICLE,characteristics:u,total:u.length*t.PRICE,total_discount:0,count:u.length};h.commit(F.SET_KP_OFFER_POSITION,[o]),h.commit(F.SET_KP_STEP,2),b.push("/kp")}},k=()=>{if(l.value>0){let u=[];a.value.forEach(t=>{t.count>0&&u.push({ID:t.ID,CHARACTERISTIC:t.CHARACTERISTIC,MAX_DISCOUNT:t.MAX_DISCOUNT,count:t.count,PRICE:t.PRICE,RESIDUE:t.RESIDUE,RESERVED:t.RESERVED,GUID:t.GUID,guid:t.GUID,ORGGUID:t.ORGGUID})}),A("update:modelValue",u),A("onClick"),a.value.forEach(t=>{t.count=0,t.check=!1})}},T=()=>{a.value=p.data.map(u=>({ID:u.ID,CHARACTERISTIC:u.CHARACTERISTIC,MAX_DISCOUNT:u.MAX_DISCOUNT,RESIDUE:u.RESIDUE,RESERVED:u.RESERVED,PRICE:u.PRICE,PPDATA:u.PPDATA,GUID:u.GUID,guid:u.GUID,ORGGUID:u.ORGGUID,count:0,check:!1}))};return te(()=>{T()}),ue(()=>p.data,()=>{T()}),(u,t)=>(r(),d("div",ge,[e("div",Ue,[e("div",ye,[e("div",Se,[$e,we,e("div",Pe,[Oe,n.discount?(r(),d("span",Ve," - "+g(n.discount)+"%",1)):y("",!0)]),Le,Me]),e("div",Ge,[(r(!0),d(U,null,w(a.value,o=>(r(),d("div",{class:D("table-row"+(o.count>0?" active":"")+(o.count>o.RESIDUE&&o.count!==0?" presail":"")),key:o.ID},[e("div",Ne,[e("span",{innerHTML:o.CHARACTERISTIC},null,8,He)]),e("div",Fe,[e("span",{innerHTML:o.RESIDUE},null,8,Be)]),n.discount?(r(),d("div",Xe,[e("span",{innerHTML:Number(o.PRICE-o.PRICE/100*n.discount).toLocaleString("RU",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(",",".")+" \u20BD"},null,8,qe)])):(r(),d("div",xe,[e("span",{innerHTML:Number(o.PRICE).toLocaleString("ru")+" \u20BD"},null,8,je)])),e("div",ze,[f(oe,{modelValue:o.count,"onUpdate:modelValue":s=>o.count=s,onOnInput:s=>P(o)},null,8,["modelValue","onUpdate:modelValue","onOnInput"]),f(ne,{modelValue:o.check,"onUpdate:modelValue":s=>o.check=s,onOnClick:s=>S(o)},null,8,["modelValue","onUpdate:modelValue","onOnClick"])]),e("div",Ke,[e("span",null,g(o.PPDATA?o.PPDATA.replaceAll("/","\xA0/\xA0"):""),1)])],2))),128))])])]),e("div",Je,[e("div",{class:D(v(l)!==0||v(E)!==0?"order-amount-more-btn":"order-amount-more-btn disable"),onClick:t[0]||(t[0]=o=>k())},[We,e("span",Ye,"("+g(v(l))+")",1),v(E)>0?(r(),d("span",Qe," + \u043F\u0440\u0435\u0434\u0437\u0430\u043A\u0430\u0437 ")):y("",!0),v(E)>0?(r(),d("span",Ze,"("+g(v(E))+")",1)):y("",!0)],2),e("div",{class:D(v(l)!==0||v(E)!==0?"order-amount-more-btn":"order-amount-more-btn disable"),onClick:t[1]||(t[1]=o=>O())},tt,2)])]))}}),ut={props:{protect:{type:Array,require:!0}},setup(){}},ot={class:"content-properties"},nt=e("div",{class:"content-properties-text"},"\u0421\u0432\u043E\u0439\u0441\u0442\u0432\u0430:",-1),st=["src","title"];function at(n,A,p,a,l,E){return r(),d("div",ot,[nt,(r(!0),d(U,null,w(p.protect,(h,b)=>(r(),d("div",{class:"content-properties-elem",key:b},[e("img",{class:"content-properties-img",src:h.IMAGE,alt:"",title:h.NAME},null,8,st)]))),128))])}var lt=B(ut,[["render",at]]),I=(n=>(n.Activity="Activity",n.Discount="Discount",n.New="New collection",n.Outlet="Outlet",n.Soon="Soon",n.Upgrade="Upgrade",n.Request="\u041F\u043E\u0434 \u0437\u0430\u043A\u0430\u0437",n.Expansion="\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u0438\u0435 \u0430\u0441\u0441\u043E\u0440\u0442\u0438\u043C\u0435\u043D\u0442\u0430",n.Empty="-",n.None="",n))(I||{});function pt(n,A,p){const a=A,l=p;switch(n){case I.Outlet:case I.Discount:case I.Activity:return 0;case I.Empty:case I.New:return a==0?l!=null?l:0:l>=a?a:l;case I.Soon:case I.Upgrade:case I.Request:case I.Expansion:case I.None:default:return 0}}export{rt as P,dt as _,pt as c};
