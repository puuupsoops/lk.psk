import{_ as _u}from"./PersonalBar.435b861c.js";import{N as wu}from"./Notification.cc6a6a52.js";import{_ as Cu}from"./CompanyBarTop.5c181ee1.js";import{_ as xu}from"./TopNav.741bd3d6.js";import{d as oe,o as n,b as g,a as u,t as j,k as w,F as le,f as ve,h as i,p as r,u as y,av as H,au as N,z as C,m as V,g as Be,j as Q,at as z,aH as Ue,aI as Du,J as pe,aJ as bu,c as T,az as Vu,ag as Au,aK as Ge,aq as $u,aL as W,e as $e,i as Bu,aM as Ou,al as Ye,aa as ye,aN as Me,an as he,aO as ze,R as ke,aG as Ne,ao as He,w as I,T as Lu,aP as P,l as qe,aj as Fu,as as ae,ai as Xe,s as Iu,ay as Ru}from"./index.8da950ad.js";import{D as Su}from"./DatePicker.ddc6d90e.js";import{_ as Pu}from"./ModalInputFull.edd3cc47.js";import{S as Ze}from"./SelectInput.7668cdf1.js";/* empty css                                                     */import{_ as re}from"./BaseInput.c370d3c6.js";const Tu={class:"base-select-wrap"},Qu=["value"],Uu=["value"],Mu=["value"],Ke=oe({__name:"SimpleSelect",props:{modelValue:{type:[String,Number]},selectInputData:{type:Array,require:!0},firstElement:{type:Object}},setup(E){return(f,$)=>(n(),g("div",Tu,[u("select",{class:"base-select",value:E.modelValue,onChange:$[0]||($[0]=p=>f.$emit("update:modelValue",p.target.value))},[E.firstElement?(n(),g("option",{key:0,value:E.firstElement.id},j(E.firstElement.name),9,Uu)):w("",!0),(n(!0),g(le,null,ve(E.selectInputData,p=>(n(),g("option",{key:p.id,value:p.id},j(p.name),9,Mu))),128))],40,Qu)]))}}),zu=u("div",{class:"kp-step-title"},"\u0421\u043E\u0431\u0440\u0430\u0442\u044C \u041A\u041F \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0438",-1),Nu={class:"kp-step-body step1"},Hu={class:"kp-step-body-elem"},Ku=u("div",{class:"kp-step-body-elem-text"},[V(" \u0417\u0430\u043A\u0430\u0437\u0430 "),u("div",{class:"kp-step-body-elem-text-sub"}," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0435 \u0443\u0436\u0435 \u0438\u043C\u0435\u044E\u0449\u0435\u0433\u043E\u0441\u044F \u0437\u0430\u043A\u0430\u0437\u0430. ")],-1),Gu=["flow"],Yu=V(" \u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0430 "),qu=u("div",{class:"kp-step-body-elem-text-sub"}," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043D\u043E\u0433\u043E \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0430. ",-1),Xu=[Yu,qu],Zu={class:"kp-step-body-elem"},ju=u("div",{class:"kp-step-body-elem-text"},[V(" \u041F\u043E\u0437\u0438\u0446\u0438\u0439 \u0438\u0437 \u043A\u0430\u0442\u043E\u043B\u043E\u0433\u0430 "),u("div",{class:"kp-step-body-elem-text-sub"}," \u041A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0438\u0437 \u043F\u043E\u0437\u0438\u0446\u0438\u0439 \u043A\u0430\u0442\u0430\u043B\u043E\u0433\u0430 ")],-1),Wu={class:"kp-step-actions"},Ju=oe({__name:"KpStep1",props:{modelValue:{type:String,required:!0},active:{type:Boolean,default:!1},isDraft:{type:Boolean,default:!1}},emits:["update:modelValue","next"],setup(E,{emit:f}){const $=E,p=i(!0),d=i(!1),v=i(!1),O=R=>{R==H.ORDER?(p.value=!0,d.value=!1,v.value=!1):R==H.DRAFT&&$.isDraft?(p.value=!1,d.value=!0,v.value=!1):(p.value=!1,d.value=!1,v.value=!0),f("update:modelValue",R)};return(R,s)=>(n(),g("div",{class:C(["kp-step",{active:E.active}])},[zu,u("div",Nu,[u("div",Hu,[r(N,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=l=>p.value=l),onOnClick:s[1]||(s[1]=l=>O(y(H).ORDER))},null,8,["modelValue"]),Ku]),u("div",{class:"kp-step-body-elem",tooltip:"\u041E\u0442\u0441\u0443\u0442\u0432\u0443\u044E\u0442 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043D\u044B\u0435 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0438",flow:E.isDraft?"":"left"},[r(N,{modelValue:d.value,"onUpdate:modelValue":s[2]||(s[2]=l=>d.value=l),onOnClick:s[3]||(s[3]=l=>O(y(H).DRAFT)),disabled:!E.isDraft},null,8,["modelValue","disabled"]),u("div",{class:C(["kp-step-body-elem-text",{disablsed:!E.isDraft}])},Xu,2)],8,Gu),u("div",Zu,[r(N,{modelValue:v.value,"onUpdate:modelValue":s[4]||(s[4]=l=>v.value=l),onOnClick:s[5]||(s[5]=l=>O(y(H).CATALOG_POS))},null,8,["modelValue"]),ju])]),u("div",Wu,[u("div",{class:"kp-step-actions-link right",onClick:s[6]||(s[6]=l=>R.$emit("next"))},"\u0414\u0430\u043B\u0435\u0435")])],2))}}),et={key:0,class:"kp-step-title"},ut={key:1,class:"kp-step-title"},tt={class:"kp-step-body"},lt={key:2,class:"kp-step-body-input"},at={class:"kp-step-body-row"},ot={class:"kp-step-body-row"},st={class:"kp-step-body-row"},nt=["flow"],it=u("svg",{width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("rect",{width:"2.17029",height:"21.7029",rx:"1.08514",transform:"matrix(0.999975 -0.00708126 -0.00708126 0.999975 11.097 1.26186)",fill:"#A5A7A9"}),u("rect",{width:"2.17029",height:"21.7029",rx:"1.08514",transform:"matrix(0.00708126 -0.999975 -0.999975 0.00708126 22.7798 12.9446)",fill:"#A5A7A9"})],-1),dt={key:3},vt={class:"kp-step-actions"},rt=oe({__name:"KpStep2",props:{active:{type:Boolean,default:!1},type:{type:String,required:!0},kp:{type:Object,required:!0}},emits:["next","prev","update:kp"],setup(E,{emit:f}){const $=E,p=Be(),d=i($.kp),v=i(-1),O=Q(()=>p.getters.getOrdersInputData),R={id:-1,name:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u0430\u043A\u0430\u0437"},s=i(-1),l=Q(()=>p.getters.getOrderDraftsInputData),U={id:-1,name:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A"},S=Q(()=>H),B=i(!1),D=i(!1),m=i(!1),c=i(""),K=i(!1),Y=i(new Date().toLocaleString("ru").substring(0,10)),k=i(z.cloneDeep(Ue));k.value.position=z.cloneDeep($.kp.offer.position),k.value=Du(k.value);const b=Q(()=>p.getters.getCompanysListInput().filter(ee=>ee.id!==""));pe(v,()=>{v.value!=-1&&(B.value=!0,p.dispatch(Au.GET_ORDER_DETAIL,v.value).finally(()=>{k.value=z.cloneDeep(p.getters.getOrderDetail),B.value=!1}))}),pe(s,()=>{s.value!=-1&&(k.value=z.cloneDeep(p.getters.getOrderDrafts.find(ee=>ee.id==s.value)))}),bu(()=>{$.active&&(d.value.offer.position=z.cloneDeep(k.value.position),f("update:kp",d.value))});const J=()=>{v.value=-1,s.value=-1,d.value=z.cloneDeep(Ge),k.value=z.cloneDeep(Ue),f("update:kp",d.value),f("prev")},Ee=()=>{d.value.offer.date=new Date($u(Y.value)).getTime(),d.value.offer.position=z.cloneDeep(k.value.position),f("next"),f("update:kp",d.value)},L=()=>{c.value.length>=2&&(d.value.offer.customer="",m.value=!0,D.value=!1,K.value=!1,p.dispatch(W.GET_ORG_BY_INN,c.value).then(()=>{m.value=!1,d.value.offer.customer=p.getters.getKPOrgName,c.value=""}).catch(()=>{D.value=!0,setTimeout(()=>{D.value=!1},1e4),m.value=!1,c.value=""}))};return(ee,h)=>(n(),g("div",{class:C(["kp-step",{active:E.active}])},[E.type===y(S).ORDER?(n(),g("div",et,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u0430\u043A\u0430\u0437")):w("",!0),E.type===y(S).DRAFT?(n(),g("div",ut,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A")):w("",!0),u("div",tt,[E.type===y(S).ORDER?(n(),T(Ke,{key:0,modelValue:v.value,"onUpdate:modelValue":h[0]||(h[0]=x=>v.value=x),"select-input-data":y(O),"first-element":v.value===-1?y(R):null},null,8,["modelValue","select-input-data","first-element"])):w("",!0),E.type===y(S).DRAFT?(n(),T(Ke,{key:1,modelValue:s.value,"onUpdate:modelValue":h[1]||(h[1]=x=>s.value=x),"select-input-data":y(l),"first-element":s.value===-1?y(U):null},null,8,["modelValue","select-input-data","first-element"])):w("",!0),v.value!==-1||s.value!==-1||E.type===y(H).CATALOG_POS?(n(),g("div",lt,[u("div",at,[r(re,{modelValue:d.value.offer.n,"onUpdate:modelValue":h[2]||(h[2]=x=>d.value.offer.n=x),label:"\u041D\u043E\u043C\u0435\u0440 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430",style:{width:"100%"}},null,8,["modelValue"]),r(Su,{modelValue:Y.value,"onUpdate:modelValue":h[3]||(h[3]=x=>Y.value=x)},null,8,["modelValue"])]),u("div",ot,[r(re,{modelValue:d.value.offer.executor,"onUpdate:modelValue":h[4]||(h[4]=x=>d.value.offer.executor=x),label:"\u041F\u043E\u0441\u0442\u0430\u0432\u0449\u0438\u043A",onInput:h[5]||(h[5]=x=>d.value.offer.executorUID=""),style:{width:"100%"}},null,8,["modelValue"]),r(Ze,{data:y(b),modelValue:d.value.offer.executorUID,"onUpdate:modelValue":h[6]||(h[6]=x=>d.value.offer.executorUID=x),onOnInput:h[7]||(h[7]=x=>{var ce;return d.value.offer.executor=((ce=y(b).find(me=>me.id===d.value.offer.executorUID))==null?void 0:ce.name)||""})},null,8,["data","modelValue"])]),u("div",st,[r(re,{modelValue:d.value.offer.customer,"onUpdate:modelValue":h[8]||(h[8]=x=>d.value.offer.customer=x),label:"\u041F\u043E\u043A\u0443\u043F\u0430\u0442\u0435\u043B\u044C",error:D.value,loading:m.value,style:{width:"100%"}},null,8,["modelValue","error","loading"]),u("div",{class:"kp-step-body-button",tooltip:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u0418\u041D\u041D",flow:K.value?"":"up",onClickCapture:h[12]||(h[12]=x=>K.value=!0)},[r(Pu,{modelValue:c.value,"onUpdate:modelValue":h[9]||(h[9]=x=>c.value=x),show:K.value,"onUpdate:show":h[10]||(h[10]=x=>K.value=x),"show-ok":"",onOnOk:h[11]||(h[11]=x=>L()),label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u041D\u041D",style:{left:"-125px"}},null,8,["modelValue","show"]),it],40,nt)])])):w("",!0),v.value!==-1||s.value!==-1||E.type===y(H).CATALOG_POS?(n(),g("div",dt,[B.value?(n(),T($e,{key:0,center:""})):E.active?(n(),T(Vu,{key:1,order:k.value,"onUpdate:order":h[13]||(h[13]=x=>k.value=x),"is-kp":""},null,8,["order"])):w("",!0)])):w("",!0)]),u("div",vt,[u("div",{class:"kp-step-actions-link",onClick:h[14]||(h[14]=x=>J())},"\u041D\u0430\u0437\u0430\u0434"),u("div",{class:"kp-step-actions-link right",onClick:h[15]||(h[15]=x=>Ee())},"\u0414\u0430\u043B\u0435\u0435")])],2))}}),pt={xmlns:"http://www.w3.org/2000/svg",width:"34",height:"42",fill:"none"},ct=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M28.007.81 5.98.8C3.137.799.8 3.137.8 5.98v30.541c0 2.843 2.337 5.18 5.18 5.18h22.035c2.843 0 5.18-2.337 5.18-5.18l.01-30.572c0-2.817-2.3-5.139-5.198-5.14Zm3.114 35.667c0 1.744-1.368 3.15-3.105 3.15H5.98a3.1 3.1 0 0 1-3.105-3.106V5.936A3.102 3.102 0 0 1 5.98 2.83L28 2.808c1.786-.001 3.103 1.377 3.104 3.128z"},null,-1),mt=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M6.94 11.337h2.71c.544 0 1.037-.436 1.037-1.038A1.01 1.01 0 0 0 9.65 9.262H6.94a1.037 1.037 0 1 0 0 2.075zM6.93 16.878h2.713c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.037-1.037H6.93a1.037 1.037 0 1 0 0 2.075zM23.871 11.36h2.71c.545 0 1.038-.436 1.038-1.038a1.01 1.01 0 0 0-1.037-1.037h-2.71a1.037 1.037 0 1 0 0 2.074zM23.894 16.899h2.71c.544 0 1.038-.436 1.038-1.038a1.01 1.01 0 0 0-1.038-1.037h-2.71a1.037 1.037 0 1 0 0 2.075zM5.903 20.957c0 .544.435 1.037 1.037 1.037h19.655a1.037 1.037 0 1 0 0-2.075H6.94c-.544 0-1.037.436-1.037 1.038zM5.884 25.873c0 .544.435 1.038 1.037 1.038h19.656a1.037 1.037 0 1 0 0-2.075H6.92c-.544 0-1.037.435-1.037 1.037zM5.875 30.978c0 .544.435 1.037 1.037 1.037h19.656a1.037 1.037 0 1 0 0-2.075H6.912c-.544 0-1.037.436-1.037 1.038z"},null,-1),gt=u("path",{fill:"#a5a7a9",d:"M12.646 17.067q-.48 0-.814-.343-.336-.343-.336-.806v-8.43q0-.462.336-.806.335-.343.814-.343h8.429q.479 0 .814.343.335.344.335.807v8.429q0 .463-.335.806t-.814.343zm0-1.15h8.429V7.49h-8.43zm.766-1.149h6.897l-2.3-3.065-1.724 2.3-1.149-1.533zm-.766 1.15v-8.43Z"},null,-1),ft=[ct,mt,gt];function yt(E,f){return n(),g("svg",pt,ft)}var ht={render:yt};const kt={xmlns:"http://www.w3.org/2000/svg",width:"34",height:"42",fill:"none"},Et=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M28.007.81 5.98.8C3.137.799.8 3.137.8 5.98v30.541c0 2.843 2.337 5.18 5.18 5.18h22.035c2.843 0 5.18-2.337 5.18-5.18l.01-30.572c0-2.817-2.3-5.139-5.198-5.14Zm3.114 35.667c0 1.744-1.368 3.15-3.105 3.15H5.98a3.1 3.1 0 0 1-3.105-3.106V5.936A3.102 3.102 0 0 1 5.98 2.83L28 2.808c1.786-.001 3.103 1.377 3.104 3.128z"},null,-1),_t=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M19.232 11.337h7.36c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.037-1.037h-7.36a1.037 1.037 0 1 0 0 2.075zM19.223 16.878h7.36c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.037-1.037h-7.36a1.037 1.037 0 1 0 0 2.075zM5.903 20.957c0 .544.435 1.037 1.037 1.037h19.655a1.037 1.037 0 1 0 0-2.075H6.94c-.544 0-1.037.436-1.037 1.038zM5.884 25.873c0 .544.435 1.038 1.037 1.038h19.656a1.037 1.037 0 1 0 0-2.075H6.92c-.544 0-1.037.435-1.037 1.037zM5.875 30.978c0 .544.435 1.037 1.037 1.037h19.656a1.037 1.037 0 1 0 0-2.075H6.912c-.544 0-1.037.436-1.037 1.038z"},null,-1),wt=u("path",{fill:"#a5a7a9",d:"M6.86 17.067q-.48 0-.814-.343-.336-.343-.336-.806v-8.43q0-.462.336-.806.334-.343.813-.343h8.43q.479 0 .813.343.336.344.336.807v8.429q0 .463-.336.806-.334.343-.813.343zm0-1.15h8.429V7.49h-8.43Zm.766-1.149h6.896l-2.299-3.065-1.724 2.3-1.15-1.533zm-.767 1.15v-8.43Z"},null,-1),Ct=[Et,_t,wt];function xt(E,f){return n(),g("svg",kt,Ct)}var Dt={render:xt};const bt={xmlns:"http://www.w3.org/2000/svg",width:"34",height:"42",fill:"none"},Vt=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M28.007.81 5.98.8C3.137.799.8 3.137.8 5.98v30.541c0 2.843 2.337 5.18 5.18 5.18h22.035c2.843 0 5.18-2.337 5.18-5.18l.01-30.572c0-2.817-2.3-5.139-5.198-5.14Zm3.114 35.667c0 1.744-1.368 3.15-3.105 3.15H5.98a3.1 3.1 0 0 1-3.105-3.106V5.936A3.102 3.102 0 0 1 5.98 2.83L28 2.808c1.786-.001 3.103 1.377 3.104 3.128z"},null,-1),At=u("path",{fill:"#a5a7a9",stroke:"#a5a7a9","stroke-width":".4",d:"M6.94 11.337h7.36c.544 0 1.037-.436 1.037-1.038a1.01 1.01 0 0 0-1.038-1.037H6.94a1.037 1.037 0 1 0 0 2.075zM6.93 16.878h7.36c.545 0 1.038-.436 1.038-1.038a1.01 1.01 0 0 0-1.037-1.037H6.93a1.037 1.037 0 1 0 0 2.075zM5.903 20.957c0 .544.435 1.037 1.037 1.037h19.655a1.037 1.037 0 1 0 0-2.075H6.94c-.544 0-1.037.436-1.037 1.038zM5.884 25.873c0 .544.435 1.038 1.037 1.038h19.656a1.037 1.037 0 1 0 0-2.075H6.92c-.544 0-1.037.435-1.037 1.037zM5.875 30.978c0 .544.435 1.037 1.037 1.037h19.656a1.037 1.037 0 1 0 0-2.075H6.912c-.544 0-1.037.436-1.037 1.038z"},null,-1),$t=u("path",{fill:"#a5a7a9",d:"M18.27 17.067q-.48 0-.814-.343-.336-.343-.336-.806v-8.43q0-.462.336-.806.335-.343.813-.343h8.43q.479 0 .814.343.335.344.335.807v8.429q0 .463-.335.806t-.814.343zm0-1.15h8.429V7.49h-8.43zm.766-1.149h6.896l-2.298-3.065-1.725 2.3-1.149-1.533zm-.767 1.15v-8.43Z"},null,-1),Bt=[Vt,At,$t];function Ot(E,f){return n(),g("svg",bt,Bt)}var Lt={render:Ot};const Ft=u("div",{class:"kp-step-title"},"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u044F",-1),It={class:"kp-step-body"},Rt={class:"kp-step-body-input"},St=u("div",{class:"orders-list-elem"},[u("div",{class:"table-arrow"})],-1),Pt=u("div",{class:"orders-list-elem"}," \u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u0443\u0441\u043B\u043E\u0432\u0438\u044F",-1),Tt=[St,Pt],Qt={class:"kp-step-body-row"},Ut=u("span",{class:"kp-step-body-row-elem"},"\u0423\u0441\u043B\u043E\u0432\u0438\u044F \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438",-1),Mt=u("div",null,"\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437",-1),zt=u("div",null,"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430",-1),Nt={key:1},Ht=V("\u20BD "),Kt=u("span",{class:"kp-step-body-elem-text-sub"},"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",-1),Gt=[Ht,Kt],Yt={class:"kp-step-body-row"},qt=u("span",{class:"kp-step-body-row-elem"},"\u041F\u0440\u0435\u0434\u043E\u043F\u043B\u0430\u0442\u0430",-1),Xt={key:1,style:"margin-left: 10px"},Zt={key:2,class:"kp-step-body-elem-text-sub",style:"margin-left: 10px"},jt={class:"kp-step-body-row"},Wt=u("span",{class:"kp-step-body-row-elem"},"\u041E\u0442\u0441\u0440\u043E\u0447\u043A\u0430",-1),Jt=V("\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E "),e0=u("br",null,null,-1),u0=V("\u043A\u0430\u043B\u0435\u043D\u0434\u0430\u0440\u043D\u044B\u0445 \u0434\u043D\u0435\u0439"),t0=[Jt,e0,u0],l0={style:"margin-left: 30px"},a0=V("\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E"),o0=u("br",null,null,-1),s0=V("\u0440\u0430\u0431\u043E\u0447\u0438\u0445 \u0434\u043D\u0435\u0439"),n0=[a0,o0,s0],i0=u("div",{class:"orders-list-elem"},[u("div",{class:"table-arrow"})],-1),d0=u("div",{class:"orders-list-elem"},"\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A",-1),v0=[i0,d0],r0={class:"kp-step-body-row"},p0=u("span",{class:"kp-step-body-row-elem"},"\u0422\u0435\u043A\u0441\u0442",-1),c0={class:"kp-step-body-row"},m0=u("span",{class:"kp-step-body-row-elem"},"\u041B\u043E\u0433\u043E",-1),g0={key:0,class:"kp-step-body-add-file-label",for:"file-upload"},f0={key:1,class:"kp-step-body-elem-header-align-wrap"},y0=u("div",{class:"kp-step-body-elem-text-sub"},"\u0412\u044B\u0440\u0430\u0432\u043D\u0438\u0432\u0430\u043D\u0438\u0435:",-1),h0={style:"text-align: center;"},k0={key:1,class:"kp-step-body-column",style:"justify-content: center"},E0={class:"product-slider-wrap"},_0=["src"],w0={style:"text-align: center; margin-top: -50px;"},C0=V("\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),x0=u("span",null,"\u041B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u0432 \u043D\u0435\u0442. \u0414\u043E\u0431\u0430\u0432\u044C\u0442\u0435 \u043B\u043E\u0433\u043E\u0442\u0438\u043F.",-1),D0=[x0],b0={class:"order-comment-form show"},V0=u("div",{class:"order-comment-title"},[u("span",null,"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439")],-1),A0={class:"kp-step-body-row",style:"justify-content: flex-end"},$0=V(" \u0421\u043A\u0430\u0447\u0430\u0442\u044C \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435: "),B0=u("div",{style:"margin-left: 10px"},"PDF",-1),O0=u("div",{class:"orders-list-elem"},[u("div",{class:"table-arrow"})],-1),L0=u("div",{class:"orders-list-elem"},"\u0412\u043B\u043E\u0436\u0435\u043D\u0438\u044F",-1),F0=[O0,L0],I0={class:"kp-step-body-row"},R0=["data-id"],S0=u("span",{style:{margin:"0 0 0 auto","font-weight":"bold",color:"red",cursor:"pointer"}},"X",-1),P0=["src"],T0={class:"content-heading-wrap kp",style:{display:"block"}},Q0={key:0,style:"display: flex; align-items: center; max-width: 580px; padding: 10px 5px;"},U0={class:"select-input-container"},M0=["onClick"],z0={class:C("kp-canvas-controller")},N0=V("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043B\u043E\u0433\u043E\u0442\u0438\u043F"),H0={style:"display: grid;"},K0=V("\u{1F815}"),G0=V("\u{1F814}"),Y0=V("\u{1F817}"),q0=V("\u279D"),X0=u("span",{style:"margin-bottom: 10px;"},"\u041C\u0430\u0441\u0448\u0442\u0430\u0431 \u043D\u0430\u043D\u0435\u0441\u0435\u043D\u0438\u044F",-1),Z0={style:"display: flex;"},j0=V("-"),W0=V("+"),J0={style:{display:"flex","align-items":"center"}},el=V("?"),ul=u("span",{style:"margin-bottom: 10px;"},"\u0423\u0433\u043E\u043B \u043F\u043E\u0432\u043E\u0440\u043E\u0442\u0430",-1),tl={style:"display: flex;"},ll=V("L"),al=V("R"),ol=V("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"),sl=V("\u0421\u043A\u0430\u0447\u0430\u0442\u044C"),nl={key:1,class:"kp-product-image-container"},il=["onClick","src"],dl=qe('<div style="display:table;margin:auto;"><span><div style="position:relative;" width="720" height="1080"><canvas width="720" height="1080" style="z-index:-1;"></canvas><canvas id="canvas-back" width="720" height="1080" style="position:absolute;left:0;top:0;z-index:0;"></canvas><canvas id="canvas-front" width="720" height="1080" style="position:absolute;left:0;top:0;z-index:1;"></canvas></div></span><span style="display:none;"><canvas id="c1" width="720" height="1080"></canvas></span></div>',1),vl={class:"kp-step-actions"},rl=oe({__name:"KpStep3",props:{active:{type:Boolean,default:!1},kp:{type:Object,require:!0}},emits:["next","prev","update:kp"],setup(E,{emit:f}){const $=E,p=Be(),d=i(!1),v=i(!1),O=i(!1),R=i(),s=i(),l=i(),U=i(),S=i(),B=i(),D=i(),m=i(),c=i(),K=100,Y=100,k=i(K),b=i(Y),J=i(!1),Ee=a=>a.replace(/&quot;/gi,'"'),L=i("10%"),ee=a=>{console.log("click")},h=a=>{console.log("out",a.target.value);let e=a.target.value;(e>=360||e<=-360)&&(e=0),F.value=e,ge.value=F.value.toString();let t=m.value+k.value/2,_=c.value+b.value/2;l.value.getContext("2d").translate(t,_),l.value.getContext("2d").rotate(F.value*Math.PI/180),l.value.getContext("2d").translate(-t,-_),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),l.value.getContext("2d").resetTransform()},x=a=>{console.log(a),L.value=L.value.replace("%","")},ce=a=>{console.log("scaleFocusOutHandler");let e=Number(L.value.replace("%",""))*10;if(console.log(e),L.value+="%",console.log(e),e==0){l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value=K,b.value=Y);return}k.value=K,b.value=Y,e>0?(L.value="0",we(e)):(L.value="0",Ce(e*-1))},me=a=>{console.log("scaleInputChange");let e=L.value.replace("%",""),t=Number(e)*10;console.log(t),t+=a,console.log(t),L.value=(t/10).toString()+"%"};pe(L,()=>{console.log(L.value)});const _e=i(null),se=i([]),je=a=>{a!="null"&&(d.value=!0,se.value=[],console.log(a),Fu.get("/product/search?QUERY="+a+"&OPTION=8").then(e=>{console.log(e.data.IMAGES),e.data.IMAGES.forEach(t=>{se.value.push(t)})}).finally(()=>{d.value=!1,console.log(se.value)}))},We=a=>{console.log(a),Je(a)},Je=a=>{let e=new Image(B.value.width,B.value.height);e.onload=function(){B.value.getContext("2d").drawImage(e,0,0,B.value.width,B.value.height),B.value.getContext("2d").save()},e.crossOrigin="Anonymous",e.src=a+"?no-cache-please"},Oe=a=>new Promise((e,t)=>{const _=new FileReader;_.readAsDataURL(a),_.onload=()=>e(_.result),_.onerror=M=>t(M)}),eu=()=>{console.log("Image download"),D.value.getContext("2d").clearRect(0,0,D.value.width,D.value.height),D.value.getContext("2d").drawImage(B.value,0,0),D.value.getContext("2d").drawImage(l.value,0,0),D.value.toBlob(a=>{console.log(a);const e=window.URL.createObjectURL(a),t=document.createElement("a");t.href=e,t.setAttribute("download","image.png"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e)})},uu=a=>{let e=a.getAttribute("data-id");e<0||(o.value.attachments.splice(e,1),console.log(o.value.attachments))},tu=async()=>{let a=await Oe(_e.value.files[0]);s.value=new Image,s.value.src=a,s.value.onload=()=>{console.log("Logo load",s.value),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),l.value.getContext("2d").save(),Re()}},lu=()=>{_e.value.click()},q=()=>{let a=m.value+k.value/2,e=c.value+b.value/2;l.value.getContext("2d").translate(a,e),l.value.getContext("2d").rotate(F.value*Math.PI/180),l.value.getContext("2d").translate(-a,-e),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),l.value.getContext("2d").resetTransform()},F=i(0),ge=i(F.value.toString());pe(F,()=>{console.log("watch",F.value),(F.value>359||F.value<-359)&&(F.value=0),ge.value=F.value.toString()});const Le=a=>{a>0&&(a*=-1),Ie(a)},Fe=a=>{Ie(a)},Ie=a=>{if(a==0)return;F.value=Number(F.value)+Number(a);let e=m.value+k.value/2,t=c.value+b.value/2;l.value.getContext("2d").translate(e,t),l.value.getContext("2d").rotate(F.value*Math.PI/180),l.value.getContext("2d").translate(-e,-t),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),l.value.getContext("2d").resetTransform()},we=a=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value+=a,b.value+=a),q(),me(a)},Ce=a=>{console.log("zoomDown"),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value-=a,b.value-=a),q(),me(a*-1)},Re=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),m.value++,l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),q()},au=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),m.value--,l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),q()},ou=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),c.value--,l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),q()},su=()=>{l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),c.value++,l.value.getContext("2d").drawImage(s.value,m.value,c.value,k.value,b.value),q()},nu=()=>{let a=l.value.getBoundingClientRect();U.value=a.x,S.value=a.y,console.log("getFrontCanvasOffset X: ",U.value," Y: ",S.value)},xe=a=>{a.preventDefault()};Bu(async()=>{$.active&&f("update:kp",o.value),l.value=window.document.getElementById("canvas-front"),B.value=window.document.getElementById("canvas-back"),D.value=window.document.getElementById("c1");let a=window.document.getElementById("canvas-back"),e=window.document.getElementById("canvas-front");R.value=a.getContext("2d");const t=new Image(720,1080);t.onload=function(){a.getContext("2d").drawImage(t,0,0,720,1080),a.getContext("2d").save()},t.crossOrigin="Anonymous",t.src="https://psk.expert/upload/iblock/77d/w8huebomv7df5plmaq7ok88rcpemw03m/kos610_aaa.jpg";let _=!1,M=e.width/2,Ae=e.height/2,Te=k.value,Qe=b.value;m.value=M-Te/2,c.value=Ae-Qe/2,s.value=new Image,s.value.src="https://psk.expert/upload/lk-kp-logo-NOT-REMOVE.png",s.value.crossOrigin="Anonymous",s.value.onload=()=>{e.getContext("2d").drawImage(s.value,m.value,c.value,Te,Qe),e.getContext("2d").save()},e.onmousedown=A=>{nu(),console.log("layerX",A.layerX,"layerY",A.layerY),console.log("layerX",A.layerX/2,"layerY",A.layerY),console.log("startLogoPosX",m.value,"startLogoPosY",c.value),console.log("mouseDownCanvas",A);let ie=A.clientX-U.value,de=A.clientY-S.value,yu=m.value,hu=m.value+k.value,ku=c.value,Eu=c.value+b.value;ie>yu&&ie<hu&&de>ku&&de<Eu?(_=!0,console.log("click Image"),window.addEventListener("wheel",xe,{passive:!1})):console.log("didnt click Image"),console.log("isDraggable",_)},e.onmouseup=A=>{_=!1,window.removeEventListener("wheel",xe,!1)},e.onmouseout=A=>{!_||(_=!1,window.removeEventListener("wheel",xe,!1))},e.onmousemove=A=>{if(!_)return;let ie=A.clientX-U.value-m.value-k.value/2,de=A.clientY-S.value-c.value-b.value/2;console.log("move x:",ie," y: ",de),l.value.getContext("2d").clearRect(0,0,l.value.width,l.value.height),l.value.getContext("2d").drawImage(s.value,m.value+=ie,c.value+=de,k.value,b.value),q()},e.onwheel=A=>{if(!!_)if(A.deltaY>0){if(console.log("wheel down",A.deltaY),J.value){Le(-5);return}if(k.value<=10||b.value<=10)return;Ce(10)}else{if(console.log("wheel up",A.deltaY),J.value){Fe(5);return}if(k.value>=700||b.value>=800)return;we(10)}}});const iu=()=>{console.log(123),console.log("Image add to attachments"),D.value.getContext("2d").clearRect(0,0,D.value.width,D.value.height),D.value.getContext("2d").drawImage(B.value,0,0),D.value.getContext("2d").drawImage(l.value,0,0),D.value.toBlob(a=>{Oe(a).then(e=>{o.value.attachments.push(e)})})},o=i($.kp);o.value.attachments=[];const De=Q(()=>{let a=0;return o.value.offer.position.forEach(e=>{a=a+e.total}),a}),fe=i(!1),X=i(!1),be=i(!0),ue=i(!1),Se=i(""),ne=i(!1),G=Q(()=>p.getters.getKPLogoList),Pe=Q(()=>p.getters.getKPLogoListOrigin),Ve=i(!0),du=i(!1),vu=a=>{if(!ne.value){let e=a.target.files[0],t=e.name,_=new FileReader;_.onloadend=()=>{Se.value=_.result,ne.value=!0,p.dispatch(W.ADD_KP_LOGO,{name:t,file:Se.value}).then(()=>{o.value.headerLogo=p.getters.getKPLogoId,ne.value=!1})},_.readAsDataURL(e)}},ru=()=>{p.commit(ae.SET_KP_LOGO_LIST_NEXT),++Z.value,Z.value>=G.value.length&&(Z.value=0)},pu=()=>{p.commit(ae.SET_KP_LOGO_LIST_PREV),--Z.value,Z.value<0&&(Z.value=G.value.length-1)},te=Q(()=>Ou),cu=Q(()=>p.getters.getShipmentsAddressInputData),Z=i(0);p.dispatch(W.GET_KP_LOGO),p.dispatch(Ye.GET_SHIPMENTS_ADDRESS);const mu=Q(()=>p.getters.getCompanysListInput().filter(a=>a.id!=="")),gu=()=>{const a=mu.value.find(e=>e.id==o.value.offer.executor);if(a&&(o.value.offer.executor=a.name),o.value.additionally.pickup){const e=p.getters.getShipmentsAddress.find(t=>t.index==parseInt(o.value.additionally.pickupValue)).address;e&&(o.value.additionally.pickupValue=e)}G.value.length>0&&(o.value.headerLogo=Number(G.value[0].id)),f("next"),f("update:kp",o.value)},fu=a=>{a=a-1,G.value.length==1&&(a=0),d.value=!0;let e=0,t=G.value[a].id;Pe.value.forEach((M,Ae)=>{M.id==t&&(e=Ae)});let _={index:a,id:Number(Pe.value[e].id)};p.dispatch(W.DELETE_KP_LOGO,_).then(()=>{d.value=!1})};return(a,e)=>(n(),g(le,null,[u("div",{class:C(["kp-step",{active:E.active}])},[Ft,u("div",It,[u("div",Rt,[u("div",{class:C(["orders-list-item",{active:fe.value}])},[u("div",{class:"orders-list-row",onClick:e[0]||(e[0]=t=>fe.value=!fe.value)},Tt),u("div",{class:C(["kp-step-body-row-group",{active:fe.value}])},[u("div",Qt,[Ut,r(N,{modelValue:o.value.additionally.pickup,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.additionally.pickup=t),onOnClick:e[2]||(e[2]=t=>{o.value.additionally.delivery=!1,o.value.additionally.deliveryValue=0}),style:{"margin-left":"30px"}},null,8,["modelValue"]),Mt,r(N,{modelValue:o.value.additionally.delivery,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.additionally.delivery=t),onOnClick:e[4]||(e[4]=t=>o.value.additionally.pickup=!1),style:{"margin-left":"30px"}},null,8,["modelValue"]),zt,o.value.additionally.delivery?(n(),T(ye,{key:0,min:0,step:10,modelValue:o.value.additionally.deliveryValue,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.additionally.deliveryValue=t),style:{"margin-left":"30px"}},null,8,["modelValue"])):w("",!0),o.value.additionally.delivery?(n(),g("div",Nt,Gt)):w("",!0),o.value.additionally.pickup?(n(),T(Ze,{key:2,data:y(cu),modelValue:o.value.additionally.pickupValue,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.additionally.pickupValue=t),style:"max-width: 300px"},null,8,["data","modelValue"])):w("",!0)]),u("div",Yt,[qt,r(N,{modelValue:o.value.additionally.prepayment,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.additionally.prepayment=t),onOnClick:e[8]||(e[8]=t=>o.value.additionally.prepaymentValue=0),style:"margin-left: 30px"},null,8,["modelValue"]),o.value.additionally.prepayment?(n(),T(ye,{key:0,min:0,max:100,step:.1,modelValue:o.value.additionally.prepaymentValue,"onUpdate:modelValue":e[9]||(e[9]=t=>o.value.additionally.prepaymentValue=t),style:"margin-left: 30px"},null,8,["step","modelValue"])):w("",!0),o.value.additionally.prepayment?(n(),g("div",Xt,"%")):w("",!0),o.value.additionally.prepayment&&y(De)?(n(),g("div",Zt,j(y(Me)(Number(y(De)/100*o.value.additionally.prepaymentValue),!0))+" \u043E\u0442 "+j(y(Me)(y(De),!0)),1)):w("",!0)]),he(u("div",jt,[Wt,r(N,{modelValue:o.value.additionally.delay,"onUpdate:modelValue":e[10]||(e[10]=t=>o.value.additionally.delay=t),onOnClick:e[11]||(e[11]=t=>{o.value.additionally.delayWorkValue=0,o.value.additionally.delayCalendarValue=0}),style:"margin-left: 30px"},null,8,["modelValue"]),o.value.additionally.delay?(n(),g("div",{key:0,style:ke([ue.value?"color: #292C32":"color: #FFFFFF","margin-left: 30px"])},t0,4)):w("",!0),o.value.additionally.delay?(n(),T(ye,{key:1,min:0,modelValue:o.value.additionally.delayCalendarValue,"onUpdate:modelValue":e[12]||(e[12]=t=>o.value.additionally.delayCalendarValue=t),disabled:ue.value},null,8,["modelValue","disabled"])):w("",!0),he(u("div",l0,[r(Ne,{modelValue:ue.value,"onUpdate:modelValue":e[13]||(e[13]=t=>ue.value=t)},null,8,["modelValue"])],512),[[ze,o.value.additionally.delay]]),o.value.additionally.delay?(n(),g("div",{key:2,style:ke([ue.value?"color: #FFFFFF":"color: #292C32","margin-left: 30px"])},n0,4)):w("",!0),o.value.additionally.delay?(n(),T(ye,{key:3,min:0,modelValue:o.value.additionally.delayWorkValue,"onUpdate:modelValue":e[14]||(e[14]=t=>o.value.additionally.delayWorkValue=t),disabled:!ue.value},null,8,["modelValue","disabled"])):w("",!0)],512),[[ze,o.value.additionally.prepaymentValue!==100]])],2)],2),u("div",{class:C(["orders-list-item",{active:o.value.header}])},[u("div",{class:"orders-list-row",onClick:e[15]||(e[15]=t=>o.value.header=!o.value.header)},v0),u("div",{class:C(["kp-step-body-row-group",{active:o.value.header}])},[u("div",r0,[p0,r(N,{modelValue:be.value,"onUpdate:modelValue":e[16]||(e[16]=t=>be.value=t),style:"margin-left: 30px"},null,8,["modelValue"]),u("div",{class:C(["kp-step-body-row-group",{active:be.value}])},[he(u("textarea",{class:"order-comment-textarea",style:{"min-width":"500px"},"onUpdate:modelValue":e[17]||(e[17]=t=>o.value.headerText=t),placeholder:"\u0422\u0435\u043A\u0441\u0442 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0430 \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u044F..."},null,512),[[He,o.value.headerText]])],2)]),u("div",c0,[m0,r(N,{modelValue:X.value,"onUpdate:modelValue":e[18]||(e[18]=t=>X.value=t),style:{"margin-left":"30px"}},null,8,["modelValue"]),X.value?(n(),g("label",g0,[u("input",{onChange:e[19]||(e[19]=t=>vu(t)),class:"kp-step-body-add-file-input",id:"file-upload",type:"file",accept:"image/*"},null,32)])):w("",!0),X.value?(n(),g("div",f0,[y0,u("div",{class:C(["header-button left",{active:o.value.headerLogoAlign===y(te).LEFT}]),onClick:e[20]||(e[20]=t=>o.value.headerLogoAlign=y(te).LEFT),tooltip:"\u0421\u043B\u0435\u0432\u0430",flow:"up"},[r(y(Dt),{class:"sidebar-btn"})],2),u("div",{class:C(["header-button center",{active:o.value.headerLogoAlign===y(te).CENTER}]),onClick:e[21]||(e[21]=t=>o.value.headerLogoAlign=y(te).CENTER),tooltip:"\u041F\u043E \u0446\u0435\u043D\u0442\u0440\u0443",flow:"up"},[r(y(ht),{class:"sidebar-btn"})],2),u("div",{class:C(["header-button right",{active:o.value.headerLogoAlign===y(te).RIGHT}]),tooltip:"\u0421\u043F\u0440\u0430\u0432\u0430",flow:"up",onClick:e[22]||(e[22]=t=>o.value.headerLogoAlign=y(te).RIGHT)},[r(y(Lt),{class:"sidebar-btn"})],2)])):w("",!0)]),y(G).length>0?(n(),g("div",{key:0,class:C(["kp-step-body-row-group",{active:X.value}])},[u("div",h0," \u041B\u043E\u0433\u043E #"+j(y(G)[0].id),1),ne.value?(n(),T($e,{key:0,style:{margin:"auto"}})):w("",!0),X.value&&!ne.value?(n(),g("div",k0,[u("div",E0,[u("button",{class:"product-slider-arrow prev",onClick:pu}),r(Lu,{name:"product-slider-trans",class:"product-slider",style:"align-items: center; height: 500px;",tag:"div"},{default:I(()=>[(n(!0),g(le,null,ve(y(G),t=>(n(),g("div",{class:"product-slider-slide",key:t.id},[t.image?(n(),g("img",{key:0,src:t.image},null,8,_0)):w("",!0)]))),128))]),_:1}),u("div",{class:"product-slider-arrow next",onClick:ru})])])):w("",!0),u("div",w0,[r(P,{onClick:e[23]||(e[23]=t=>fu(Z.value))},{default:I(()=>[C0]),_:1})])],2)):(n(),g("div",{key:1,class:C(["kp-step-title kp-step-body-row-group",{active:X.value}])},D0,2))],2)],2),u("div",b0,[V0,he(u("textarea",{class:"order-comment-textarea","onUpdate:modelValue":e[24]||(e[24]=t=>o.value.offer.comment=t)},null,512),[[He,o.value.offer.comment]])]),u("div",A0,[$0,r(N,{modelValue:Ve.value,"onUpdate:modelValue":e[25]||(e[25]=t=>Ve.value=t),onOnClick:e[26]||(e[26]=t=>{Ve.value=!0,du.value=!1,o.value.as="PDF"}),style:"margin-left: 30px"},null,8,["modelValue"]),B0]),u("div",{class:C(["orders-list-item",{active:v.value}])},[u("div",{class:"orders-list-row",onClick:e[27]||(e[27]=t=>v.value=!v.value)},F0),u("div",{class:C(["kp-step-body-row-group",{active:v.value}])},[u("div",null,[u("div",I0,[(n(!0),g(le,null,ve(o.value.attachments,(t,_)=>(n(),g("div",{style:{display:"grid",width:"150px",height:"210px"},key:_,onClick:e[28]||(e[28]=M=>uu(M.target.parentElement)),"data-id":_},[S0,u("img",{src:t,height:"200"},null,8,P0)],8,R0))),128))])])],2)],2)])]),u("div",{class:"order-list content-elem",style:ke([v.value?"display: flex;":"display: none;"])},[u("div",T0,[o.value.offer.position?(n(),g("div",Q0,[u("div",U0,[u("button",{onClick:e[29]||(e[29]=t=>O.value=!O.value),class:C(["select-input-btn",O.value?"active":""])},"\u0412\u042B\u0411\u0415\u0420\u0418\u0422\u0415 \u0422\u041E\u0412\u0410\u0420 \u0418\u0417 \u0412\u042B\u041F\u0410\u0414\u0410\u042E\u0429\u0415\u0413\u041E \u0421\u041F\u0418\u0421\u041A\u0410. ",2),u("div",{class:C(["select-input-options",O.value?"active":""])},[(n(!0),g(le,null,ve(o.value.offer.position,(t,_)=>(n(),g("p",{key:_,class:C("select-input-item"),onClick:M=>{je(t.guid),O.value=!1}}," ["+j(t.article)+"] "+j(Ee(t.product.NAME)),9,M0))),128))],2)]),d.value?(n(),T($e,{key:0,center:""})):w("",!0)])):w("",!0),u("div",z0,[u("div",null,[u("input",{ref_key:"file",ref:_e,id:"myfile",type:"file",onChange:e[30]||(e[30]=t=>tu()),style:{display:"none"}},null,544),r(P,{tooltip:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u0430\u0439\u043B \u0441 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C \u043D\u0430 \u0445\u043E\u043B\u0441\u0442",tooltipFlow:"up",onOnClick:e[31]||(e[31]=t=>lu())},{default:I(()=>[N0]),_:1})]),u("div",H0,[u("span",null,[r(P,{onMousedown:e[32]||(e[32]=t=>ou())},{default:I(()=>[K0]),_:1})]),u("div",null,[r(P,{onOnClick:e[33]||(e[33]=t=>au())},{default:I(()=>[G0]),_:1}),r(P,{onOnClick:e[34]||(e[34]=t=>su())},{default:I(()=>[Y0]),_:1}),r(P,{onOnClick:e[35]||(e[35]=t=>Re())},{default:I(()=>[q0]),_:1})])]),u("div",null,[X0,u("div",Z0,[u("div",null,[r(P,{onOnClick:e[36]||(e[36]=t=>Ce(1))},{default:I(()=>[j0]),_:1})]),u("div",null,[r(re,{onClick:e[37]||(e[37]=t=>x(t)),onFocusout:e[38]||(e[38]=t=>ce()),modelValue:L.value,"onUpdate:modelValue":e[39]||(e[39]=t=>L.value=t),class:C("input-text-field-modify")},null,8,["modelValue"])]),u("div",null,[r(P,{onOnClick:e[40]||(e[40]=t=>we(1))},{default:I(()=>[W0]),_:1})])])]),u("div",J0,[r(P,{style:{margin:"0","border-radius":"100px",width:"30px","min-width":"30px","min-height":"30px",height:"30px",cursor:"help"},active:!1,tooltip:"\u041F\u0435\u0440\u0435\u043A\u043B\u044E\u0447\u0430\u0442\u0435\u043B\u044C \u0434\u043B\u044F \u0432\u044B\u0431\u043E\u0440\u0430 \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u043A\u043E\u043B\u0435\u0441\u043E\u043C \u043C\u044B\u0448\u0438",tooltipFlow:"up"},{default:I(()=>[el]),_:1}),r(Ne,{modelValue:J.value,"onUpdate:modelValue":e[41]||(e[41]=t=>J.value=t)},null,8,["modelValue"])]),u("div",null,[ul,u("div",tl,[u("div",null,[r(P,{onOnClick:e[42]||(e[42]=t=>Le(-1))},{default:I(()=>[ll]),_:1})]),u("div",null,[r(re,{onClick:e[43]||(e[43]=t=>ee()),onFocusout:e[44]||(e[44]=t=>h(t)),modelValue:ge.value,"onUpdate:modelValue":e[45]||(e[45]=t=>ge.value=t),class:C("input-text-field-modify")},null,8,["modelValue"])]),u("div",null,[r(P,{onOnClick:e[46]||(e[46]=t=>Fe(1))},{default:I(()=>[al]),_:1})])])]),u("div",null,[r(P,{onOnClick:e[47]||(e[47]=t=>iu()),tooltip:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u043E\u043E\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0432 \u0444\u0430\u0439\u043B \u041A\u041F","tooltip-flow":"up"},{default:I(()=>[ol]),_:1}),r(P,{onOnClick:e[48]||(e[48]=t=>eu()),tooltip:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u043D\u0430 \u0443\u0441\u0442\u0440\u043E\u0439\u0441\u0442\u0432\u043E","tooltip-flow":"up",style:"background-color: oldlace;"},{default:I(()=>[sl]),_:1})])]),se.value.length>0?(n(),g("div",nl,[(n(!0),g(le,null,ve(se.value,(t,_)=>(n(),g("img",{style:{cursor:"pointer"},onClick:M=>We(M.target.src),key:_,src:t,height:"200"},null,8,il))),128))])):w("",!0),dl])],4),u("div",vl,[u("div",{class:"kp-step-actions-link",onClick:e[49]||(e[49]=t=>a.$emit("prev"))},"\u041D\u0430\u0437\u0430\u0434"),u("div",{class:"kp-step-actions-link right",onClick:e[50]||(e[50]=t=>gu())},"\u0414\u0430\u043B\u0435\u0435")])],2),d.value?(n(),T(Xe,{key:0})):w("",!0)],64))}}),pl=u("div",{class:"kp-step-title"},"\u0424\u0430\u0439\u043B \u0441\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u043E\u0432\u0430\u043D",-1),cl={class:"kp-step-body"},ml={class:"kp-step-actions"},gl=oe({__name:"KpStep4",props:{active:{type:Boolean,default:!1}},emits:["save","prev"],setup(E,{emit:f}){const $=()=>{f("save")};return(p,d)=>(n(),g("div",{class:C(["kp-step",{active:E.active}])},[pl,u("div",cl,[u("div",{onClick:d[0]||(d[0]=v=>$()),class:"kp-step-actions-link",style:"text-align: center"},"\u0421\u043A\u0430\u0447\u0430\u0442\u044C")]),u("div",ml,[u("div",{class:"kp-step-actions-link",onClick:d[1]||(d[1]=v=>p.$emit("prev"))},"\u041D\u0430\u0437\u0430\u0434")])],2))}}),fl={class:"kp"},yl={class:"top-line product-page"},hl=qe('<div class="kp-head-card"><div class="kp-head-card-title">\u041A\u043E\u043D\u0441\u0442\u0440\u0443\u043A\u0442\u043E\u0440 \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u0438\u0445 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0439</div><div class="kp-head-card-subtitle"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24"><path fill="#A5A7A9" d="M11.875 18Q12.5 18 12.95 17.55Q13.4 17.1 13.4 16.475Q13.4 15.85 12.95 15.412Q12.5 14.975 11.875 14.975Q11.25 14.975 10.8 15.412Q10.35 15.85 10.35 16.475Q10.35 17.1 10.8 17.55Q11.25 18 11.875 18ZM10.7 14.15H13.05Q13.05 13.425 13.25 12.925Q13.45 12.425 14.2 11.7Q14.775 11.15 15.137 10.525Q15.5 9.9 15.5 9.025Q15.5 7.525 14.525 6.737Q13.55 5.95 12.15 5.95Q10.625 5.95 9.613 6.825Q8.6 7.7 8.2 8.9L10.4 9.725Q10.575 9.225 10.95 8.725Q11.325 8.225 12.025 8.225Q12.525 8.225 12.8 8.537Q13.075 8.85 13.075 9.225Q13.075 9.6 12.812 10Q12.55 10.4 12.275 10.625Q11.275 11.55 10.988 12.137Q10.7 12.725 10.7 14.15ZM12 22.85Q9.75 22.85 7.763 22Q5.775 21.15 4.312 19.688Q2.85 18.225 2 16.25Q1.15 14.275 1.15 12Q1.15 9.725 2 7.75Q2.85 5.775 4.312 4.312Q5.775 2.85 7.763 2Q9.75 1.15 12 1.15Q14.275 1.15 16.25 2Q18.225 2.85 19.688 4.312Q21.15 5.775 22 7.75Q22.85 9.725 22.85 12Q22.85 14.275 22 16.25Q21.15 18.225 19.688 19.688Q18.225 21.15 16.25 22Q14.275 22.85 12 22.85ZM12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12Q12 12 12 12ZM12 19.7Q15.2 19.7 17.45 17.462Q19.7 15.225 19.7 12Q19.7 8.775 17.45 6.537Q15.2 4.3 12 4.3Q8.8 4.3 6.55 6.537Q4.3 8.775 4.3 12Q4.3 15.225 6.55 17.462Q8.8 19.7 12 19.7Z"></path></svg><div>\u041D\u0430 \u044D\u0442\u043E\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0435 \u0412\u044B \u0441\u043C\u043E\u0436\u0435\u0442\u0435 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0438 \u0441\u043E\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u043E\u0433\u043E \u0437\u0430\u043A\u0430\u0437\u0430, \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0430 \u0438\u043B\u0438 \u0442\u043E\u0432\u0430\u0440\u0430 \u0441\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u0440\u0447\u0435\u0441\u043A\u043E\u0435 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0441\u043E \u0441\u0432\u043E\u0438\u043C \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u043E\u043C \u0438 \u0446\u0435\u043D\u0430\u043C\u0438.</div></div></div>',1),kl={class:"kp-form"},El={class:"kp-form-stepper-wrap"},_l={class:"kp-form-stepper"},wl={class:"kp-form-stepper-list"},Cl={class:"kp-form-stepper-content"},xl={class:"kp-form-stepper-content-tabs-box"},Rl=oe({__name:"KpPage",setup(E){const f=Be(),$=Q(()=>f.getters.getCompanysList),p=i(""),d=i(z.cloneDeep(Ge)),v=i(1),O=i(!1),R=i(!1),s=i(H.ORDER);f.getters.isCompanysLoad||f.dispatch(Iu.GET_COMPANYS),f.getters.isOrders||(O.value=!0,f.dispatch(Ru.GET_ORDERS).then(()=>{O.value=!1})),f.dispatch(W.GET_KP_LOGO),f.dispatch(Ye.GET_SHIPMENTS_ADDRESS),d.value=f.getters.getKP,v.value=f.getters.getKPStep,v.value!=1&&(s.value=H.CATALOG_POS);const l=Q(()=>f.getters.getOrderDraftCount>0),U=()=>{if(v.value<4&&(v.value=v.value+1),v.value==4){let D=z.cloneDeep(d.value);D.additionally.prepayment&&(D.additionally.prepaymentValue=D.additionally.prepaymentValue/100),R.value=!0,f.dispatch(W.SEND_KP,D).finally(()=>{R.value=!1}),f.commit(ae.SET_KP_STEP,1)}f.commit(ae.SET_KP_STEP,v.value)},S=()=>{v.value>1&&(v.value=v.value-1),f.commit(ae.SET_KP_STEP,v.value)},B=()=>{f.dispatch(W.SAVE_KP)};return pe(d,()=>{f.commit(ae.SET_KP,d.value)}),(D,m)=>(n(),g("div",fl,[u("div",yl,[r(Cu,{data:y($),modelValue:p.value,"onUpdate:modelValue":m[0]||(m[0]=c=>p.value=c)},null,8,["data","modelValue"]),r(wu),r(_u)]),r(xu),hl,u("div",kl,[u("div",El,[u("div",_l,[u("div",{class:"kp-form-stepper-bar",style:ke("width:"+33.33*(v.value-1)+"%")},null,4),u("ul",wl,[u("li",{class:C(["kp-form-stepper-item",{active:v.value>=1}]),tooltip:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0435",flow:"up"},"1",2),u("li",{class:C(["kp-form-stepper-item",{active:v.value>=2}]),tooltip:"\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 \u043F\u043E\u043B\u044F",flow:"up"},"2",2),u("li",{class:C(["kp-form-stepper-item",{active:v.value>=3}]),tooltip:"\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",flow:"up"},"3",2),u("li",{class:C(["kp-form-stepper-item with-image",{active:v.value>=4}]),tooltip:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u0435 \u0444\u0430\u0439\u043B",flow:"up"},null,2)])])]),u("div",Cl,[u("div",xl,[u("div",{class:C(`kp-form-stepper-content-tabs step${v.value}`)},[r(Ju,{onNext:U,modelValue:s.value,"onUpdate:modelValue":m[1]||(m[1]=c=>s.value=c),active:v.value===1,isDraft:y(l)},null,8,["modelValue","active","isDraft"]),r(rt,{type:s.value,onNext:U,onPrev:S,kp:d.value,"onUpdate:kp":m[2]||(m[2]=c=>d.value=c),active:v.value===2},null,8,["type","kp","active"]),r(rl,{onNext:U,onPrev:S,kp:d.value,"onUpdate:kp":m[3]||(m[3]=c=>d.value=c),active:v.value===3},null,8,["kp","active"]),r(gl,{onPrev:S,onSave:B,active:v.value===4},null,8,["active"])],2)])])]),R.value?(n(),T(Xe,{key:0})):w("",!0)]))}});export{Rl as default};
