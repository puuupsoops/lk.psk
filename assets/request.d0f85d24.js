import{T as N}from"./TopNav.88f8581a.js";import{d as k,g as $,i as f,_ as O,r as h,o as u,b as i,a as s,t as p,j as D,F as b,e as I,y as C,m as V,J as M,f as w,ae as U,c as E,a8 as S,am as R,a9 as B,k as F,ah as T,h as P,q as j,ai as q,ag as y,af as A,O as G}from"./index.876e7482.js";import{P as L}from"./PreloaderLocal.8566d143.js";import{S as H}from"./SelectInput.8f01a358.js";import{A as W}from"./AmountInput.5e963433.js";const J=k({props:{data:{type:Object},modelValue:{type:Array,required:!0}},emits:["update:modelValue"],components:{AmountInput:W},setup(e,{emit:a}){const r=$([]),o=$({}),_=f(()=>{let c=Object.assign({},e.data);if(c.position)c.position.forEach(d=>{d.characteristics.forEach(n=>n.select=0)});else return null;return c});return{open:r,open_presail:o,val:_,upd:()=>{let c=[];_.value&&_.value.position.forEach(d=>{d.characteristics.forEach(n=>{n.select>0&&c.push({productUID:d.product.UID,characteristicGUID:n.CHARACTERISTIC,count:n.select})})}),a("update:modelValue",c)}}}}),z={class:"order-list content-elem"},Y={key:0,class:"order-list-bottom scroll-elem"},K={class:"order-list-bottom-wrap"},Q={key:0,class:"order-list-row order-list-heading"},X=s("div",{class:"order-list-elem"},"\u2116",-1),Z=s("div",{class:"order-list-elem"},"\u0410\u0440\u0442\u0438\u043A\u0443\u043B",-1),x=s("div",{class:"order-list-elem"},"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",-1),ee={class:"order-list-elem"},se=s("div",{class:"order-list-elem"},"\u041A\u043E\u043B-\u0432\u043E",-1),te=s("div",{class:"order-list-elem"},"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",-1),ae=s("div",{class:"order-list-elem"},"\u0412\u044B\u0431\u0440\u0430\u043D\u043E",-1),le=["onClick"],oe={class:"order-list-elem"},ue={class:"order-list-elem"},de={class:"order-list-elem"},ne=["innerHTML"],ie=s("div",{class:"order-list-elem"},null,-1),re={class:"order-list-elem"},ce={key:0,class:"order-list-elem"},me={key:1,class:"order-list-elem"},pe={class:"order-list-elem"},_e=s("div",{class:"order-list-elem"},null,-1),ve=s("div",{class:"order-list-elem"},null,-1),he={class:"order-list-elem"},ge={key:0,class:"order-list-elem"},fe={key:1,class:"order-list-elem"},Ce={class:"order-list-elem"},$e={key:2,class:"order-list-elem"},Ee={key:3,class:"order-list-elem"},De={class:"order-list-elem"};function be(e,a,r,o,_,v){const c=h("amount-input");return u(),i("div",z,[e.val?(u(),i("div",Y,[s("div",K,[e.val.position.length>0?(u(),i("div",Q,[X,Z,x,s("div",ee,p(e.open.length!=0?"\u0426\u0435\u043D\u0430":""),1),se,te,ae])):D("",!0),(u(!0),i(b,null,I(e.val.position,(d,n)=>(u(),i("div",{class:C(e.open.indexOf(n)!==-1?"order-list-item active":"order-list-item"),key:n},[s("div",{class:"order-list-row order-list-main-row",onClick:t=>e.open.indexOf(n)===-1?e.open.push(n):e.open.splice(e.open.indexOf(n),1)},[s("div",oe,p(n+1),1),s("div",ue,p(d.article),1),s("div",de,[s("span",{innerHTML:d.product.NAME},null,8,ne)]),ie,s("div",re,p(d.count),1),d.total?(u(),i("div",ce,p(Number(d.total).toLocaleString("ru"))+" \u20BD",1)):(u(),i("div",me," -- ")),s("div",pe,p(d.characteristics.filter(t=>t.select>0).length),1)],8,le),s("div",{class:C(e.open.indexOf(n)!==-1?"order-list-sublist active":"order-list-sublist")},[(u(!0),i(b,null,I(d.characteristics,(t,m)=>(u(),i("div",{key:m,class:"order-list-row"},[_e,ve,s("div",he,p(t.CHARACTERISTIC),1),t.PRICE?(u(),i("div",ge,p(Number(t.PRICE).toLocaleString("ru"))+" \u20BD",1)):(u(),i("div",fe," -- ")),s("div",Ce,[s("span",null,p(t.count),1)]),t.PRICE?(u(),i("div",$e,p(Number(t.PRICE*t.count).toLocaleString("ru"))+" \u20BD",1)):(u(),i("div",Ee," -- ")),s("div",De,[V(c,{max:t.count,modelValue:t.select,"onUpdate:modelValue":l=>t.select=l,onOnInput:e.upd},null,8,["max","modelValue","onUpdate:modelValue","onOnInput"])])]))),128))],2)],2))),128))])])):D("",!0)])}var Ie=O(J,[["render",be]]);const Ve=k({components:{SelectInput:H,ClaimOrder:Ie,PreloaderLocal:L},props:{modelValue:{type:Object,required:!0},cardId:{type:Number,required:!0}},emits:["update:modelValue","update:files","close"],setup(e,{emit:a}){const r=w(F),o=$({date_create:"",status:0,title:"\u041F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044F \u043F\u043E \u0417\u0430\u043A\u0430\u0437\u0443 \u2116",partner_name:"",partner_guid:"",id:e.modelValue.id,case:1,products:[],message:"",files:[]}),_=$(!1),v=f({get:()=>o.value.partner_guid==""&&c.value!==null?r.getters.getOrders.find(t=>t.n==c.value).partner_guid:o.value.partner_guid,set:t=>{o.value.partner_guid=t;const m=r.getters.getOrders.filter(l=>l.partner_guid==t);m.length&&(o.value.id=Math.max(...m.map(l=>l.n))),a("update:modelValue",o.value)}}),c=f({get:()=>e.modelValue.id?e.modelValue.id:o.value.id,set:t=>{o.value.id=t,a("update:modelValue",o.value),o.value.partner_guid=r.getters.getOrders.find(m=>m.n==t).partner_guid,_.value=!0,r.dispatch(U.GET_ORDER_DETAIL,t).finally(()=>{o.value.order_detail=r.getters.getOrderDetail,_.value=!1})}});M(o.value,()=>{var t;o.value.partner_guid=v.value,o.value.partner_name=r.getters.getCompanyData(o.value.partner_guid).name,o.value.title="\u041F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044F \u043F\u043E \u0417\u0430\u043A\u0430\u0437\u0443 \u2116"+c.value+" \u043E\u0442 "+((t=r.getters.getOrders.find(m=>m.n==c.value))==null?void 0:t.date.substring(0,10)),o.value.order_detail=e.modelValue.order_detail,a("update:modelValue",o.value)});const d=t=>{o.value.files.push(t.target.files[0]),a("update:modelValue",o.value)},n=t=>{o.value.files.splice(t,1),a("update:modelValue",o.value)};return{data:o,loading:_,order:c,companyUID:v,orders:f(()=>r.getters.getOrders.filter(t=>t.partner_guid==v.value)),companys:f(()=>r.getters.getCompanysList),handleFileUpload:d,delFile:n}}}),ye={key:0,class:"claim-header"},Ae={class:"shipment-heading claim-heading"},ke={class:"shipment-heading-elem"},Oe={class:"shipment-heading-info"},Se={key:0,class:"shipment-title"},we={key:1,class:"shipment-title"},Fe=s("span",null,"\u041E\u0442\u0441\u0443\u0442\u0432\u0443\u044E\u0442 \u0437\u0430\u043A\u0430\u0437\u044B",-1),Le=[Fe],Ne={class:"shipment-heading-select"},Me=s("span",null,"\u041E\u0441\u043D\u043E\u0432\u0430\u043D\u0438\u0435: \xA0",-1),Ue={class:"base-select-wrap"},Re=["value"],Be={class:"shipment-heading-elem"},Te={class:"orders-heading-item"},Pe=s("div",{class:"orders-heading-text"},"\u041A\u043E\u043D\u0442\u0440\u0430\u0433\u0435\u043D\u0442:",-1),je={class:"nav-tab claim-tab"},qe=s("span",null,"\u041F\u0440\u0438\u0447\u0438\u043D\u0430 \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u0438:",-1),Ge={class:"nav-tab-wrap"},He=s("div",{class:"gradient-btn-text"},"\u041D\u0435\u0434\u043E\u0441\u0434\u0430\u0447\u0430",-1),We=[He],Je=s("div",{class:"gradient-btn-text"},"\u041F\u0435\u0440\u0435\u0441\u043E\u0440\u0442",-1),ze=[Je],Ye=s("div",{class:"gradient-btn-text"},"\u041A\u0430\u0447\u0435\u0441\u0442\u0432\u043E",-1),Ke=[Ye],Qe=s("div",{class:"gradient-btn-text"},"\u0414\u0440\u0443\u0433\u043E\u0435",-1),Xe=[Qe],Ze={class:"claim-info"},xe={class:"claim-info-elem"},es={class:"content-elem"},ss={class:"order-list-bottom scroll-elem"},ts={key:0,style:{display:"flex","justify-content":"center"}},as={class:"claim-info-elem"},ls=s("div",{class:"claim-info-title"},"\u0421\u043E\u043F\u0440\u043E\u0432\u043E\u0434\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u0442\u0435\u043A\u0441\u0442 \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u0438",-1),os={class:"claim-info-textarea-wrap"},us={class:"claim-info-add-file"},ds=["id"],ns=["for"],is={class:"claim-info-add-file-val"},rs={class:"claim-doc"},cs=["onClick"],ms={class:"claim-doc-elem-name"};function ps(e,a,r,o,_,v){var m;const c=h("router-link"),d=h("SelectInput"),n=h("PreloaderLocal"),t=h("ClaimOrder");return u(),i("div",null,[e.cardId!=0?(u(),i("div",ye,[s("div",{class:"claim-header-close",onClick:a[0]||(a[0]=l=>e.$emit("close"))})])):D("",!0),s("div",Ae,[s("div",ke,[e.cardId==0?(u(),E(c,{key:0,tag:"a",to:"/claims",class:"shipment-heading-back-btn"})):D("",!0),s("div",Oe,[e.order?(u(),i("div",Se,[s("span",null,"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044E \u043F\u043E \u0417\u0430\u043A\u0430\u0437\u0443 \u2116 "+p(e.modelValue.id)+" \u043E\u0442 "+p((m=e.orders.find(l=>l.n==e.order))==null?void 0:m.date.substring(0,10)),1)])):(u(),i("div",we,Le)),s("div",Ne,[Me,s("div",Ue,[S(s("select",{class:"base-select",style:{width:"100%"},"onUpdate:modelValue":a[1]||(a[1]=l=>e.order=l)},[(u(!0),i(b,null,I(e.orders,(l,g)=>(u(),i("option",{key:g,value:l.n},p(l.name),9,Re))),128))],512),[[R,e.order]])])])])]),s("div",Be,[s("div",Te,[Pe,V(d,{data:e.companys,modelValue:e.companyUID,"onUpdate:modelValue":a[2]||(a[2]=l=>e.companyUID=l)},null,8,["data","modelValue"])])])]),s("div",je,[qe,s("div",Ge,[s("a",{class:C("nav-tab-elem gradient-btn"+(e.data.case==1?" active":"")),onClick:a[3]||(a[3]=l=>e.data.case=1)},We,2),s("a",{class:C("nav-tab-elem gradient-btn"+(e.data.case==2?" active":"")),onClick:a[4]||(a[4]=l=>e.data.case=2)},ze,2),s("a",{class:C("nav-tab-elem gradient-btn"+(e.data.case==3?" active":"")),onClick:a[5]||(a[5]=l=>e.data.case=3)},Ke,2),s("a",{class:C("nav-tab-elem gradient-btn"+(e.data.case==0?" active":"")),onClick:a[6]||(a[6]=l=>e.data.case=0)},Xe,2)])]),s("div",Ze,[s("div",xe,[s("div",es,[s("div",ss,[e.loading?(u(),i("div",ts,[V(n)])):(u(),E(t,{key:1,data:e.modelValue.order_detail,modelValue:e.data.products,"onUpdate:modelValue":a[7]||(a[7]=l=>e.data.products=l)},null,8,["data","modelValue"]))])])]),s("div",as,[ls,s("div",os,[S(s("textarea",{class:"claim-info-textarea",name:"","onUpdate:modelValue":a[8]||(a[8]=l=>e.data.message=l)},null,512),[[B,e.data.message]]),s("div",us,[s("input",{class:"claim-info-add-file-input",onChange:a[9]||(a[9]=l=>e.handleFileUpload(l)),type:"file",id:"claim-add-file"+e.cardId},null,40,ds),s("label",{class:"claim-info-add-file-label",for:"claim-add-file"+e.cardId},[s("span",is,p(e.data.files.length),1)],8,ns)])])]),s("div",rs,[(u(!0),i(b,null,I(e.data.files,(l,g)=>(u(),i("div",{class:"claim-doc-elem",key:g},[s("div",{class:"claim-doc-elem-file",onClick:$s=>e.delFile(g)},null,8,cs),s("div",ms,p(l.name),1)]))),128))])])])}var _s=O(Ve,[["render",ps]]);const vs=k({components:{TopNav:N,Preloader:T,PreloaderLocal:L,ClaimCard:_s},setup(){const e=w(F),a=G(),r=$(!1),o=$(!1);P(()=>{e.getters.isCompanysLoad||e.dispatch(j.GET_COMPANYS),e.getters.isOrders?e.getters.getClaimNew.length==0&&(r.value=!0,e.dispatch(y.ADD_CLAIMS_NEW,e.getters.getOrdersMaxId).then(()=>{r.value=!1})):(r.value=!0,e.dispatch(q.GET_ORDERS).then(()=>{e.getters.getClaimNew.length==0?e.dispatch(y.ADD_CLAIMS_NEW,e.getters.getOrdersMaxId).then(()=>{r.value=!1}):r.value=!1})),e.commit(A.CLEAR_CLAIMS_SUCCESS)});const _=()=>{o.value=!0,e.dispatch(A.ADD_CLAIMS_NEW,e.getters.getOrdersMaxId).then(()=>{o.value=!1})},v=d=>{e.commit(A.DEL_CLAIMS_NEW,d)},c=async()=>{r.value=!0,await e.getters.getClaimNew.forEach(d=>{let n=new FormData;d.files.forEach((t,m)=>{n.append("files["+m+"]",t)}),n.append("title",d.title),n.append("partner_name",d.partner_name),n.append("partner_guid",d.partner_guid),n.append("id",d.id.toString()),n.append("case",d.case.toString()),n.append("products",JSON.stringify(d.products)),n.append("message",d.message),e.dispatch(y.ADD_CLAIMS,n),a.push({name:"ClaimsSuccess"})}),r.value=!1};return{loading:r,loading_claim:o,calim_new:f(()=>e.getters.getClaimNew),add:_,del:v,send:c}}}),hs={class:"claim-bottom"},gs=s("div",{class:"gradient-btn-text"},"\u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u043F\u0440\u0435\u0442\u0435\u043D\u0437\u0438\u044E",-1),fs=[gs];function Cs(e,a,r,o,_,v){const c=h("top-nav"),d=h("ClaimCard"),n=h("preloader-local"),t=h("preloader");return u(),i("div",null,[V(c),s("div",null,[(u(!0),i(b,null,I(e.calim_new,(m,l)=>(u(),E(d,{key:l,modelValue:e.calim_new[l],"onUpdate:modelValue":g=>e.calim_new[l]=g,cardId:l,onClose:g=>e.del(l)},null,8,["modelValue","onUpdate:modelValue","cardId","onClose"]))),128))]),s("div",hs,[e.loading_claim?(u(),E(n,{key:0})):(u(),i("div",{key:1,class:"claim-add-basis",onClick:a[0]||(a[0]=(...m)=>e.add&&e.add(...m))},"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C")),s("div",{class:"gradient-btn claim-submit",onClick:a[1]||(a[1]=m=>e.send())},fs)]),e.loading?(u(),E(t,{key:0})):D("",!0)])}var ys=O(vs,[["render",Cs]]);export{ys as default};
